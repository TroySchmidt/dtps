{"version":3,"sources":["scripts/assignments.js"],"names":["dtps","renderAssignment","assignment","scoreHTML","renderAssignmentScore","id","class","classes","color","title","dueAt","formatDate","outcomes","length","category","turnedIn","missing","late","locked","pending","dtpsLMS","useRubricGrades","rubric","rubricHTML","forEach","rubricItem","score","push","join","grade","Number","toFixed","value","letter","replace","Math","round","masterStream","presentClass","showClasses","$","removeClass","ready","course","assignments","doneLoading","dashboardContainerHTML","dashboardItem","window","FullCalendar","selectedClass","jQuery","html","leftDashboard","map","rightDashboard","renderUpdates","renderUpcoming","calendar","renderDueToday","combinedStream","isToday","sort","a","b","keyA","Date","getTime","keyB","combinedHTML","updatesHTML","updates","update","type","body","gradedAt","calEvents","courseIndex","start","allDay","backgroundColor","borderColor","textColor","classNum","assignmentID","calendarEl","document","getElementById","Calendar","locale","initialView","events","eventContent","info","event","extendedProps","contentHeight","handleWindowResize","headerToolbar","center","end","dateClick","eventClick","render","classStream","classID","searchResults","searchText","indexOf","selectedContent","addClass","error","renderClassTools","now","prevAssignment","streamHTML","divider","assignmentIDs","assignmentBodyHTML","computedBackgroundColor","getComputedStyle","getPropertyValue","computedTextColor","hasClass","brightenTextForDarkMode","hasKeywords","toLowerCase","includes","remoteConfig","dtechCleanUpAssignments","fluid","get","dtech","append","children","find","sections","toArray","element","i","text","tmpjQuery","remove","innerHTML","icon","replaceWith","s","outerHTML","blob","Blob","URL","createObjectURL","assignmentRubricHTML","scoreName","assignmentFeedbackHTML","feedback","author","photoURL","name","comment","publishedAt","subject","env","url","shortName","cards","close","modal","search","val","screen","input","Fuse","keys","moduleStream","Promise","resolve","modules","fetchModules","then","data","modulesHTML","module","moduleItemHTML","items","item","action","indent","completed","collapsed","catch","err","moduleCollapse","ele","modID","parents","toggleClass","collapseModule","num","modulesSelector","teacher","debugClassID","homepage","videoMeetingURL","classInfo","syllabus","syllabusURL","description","numStudents","classHome","fetchHomepage","dtechHomepageFluidUITabs","fragments","fragment","attr","frameURL","homepageURL","e","gradebook","zeros","totalPoints","earnedPoints","gradedAssignments","assignmentHTML","gradeCalcSummary","gradebookExpanded","previousLetter","externalScreens","dashboard","stream","courseID"],"mappings":"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","sourceRoot":"/","sourcesContent":["/**\n * @file DTPS assignment functions\n * @author jottocraft\n * \n * @copyright Copyright (c) 2018-2020 jottocraft. All rights reserved.\n * @license GPL-2.0-only\n */\n\n/**\n * Renders HTML for an assignment item in a list\n * \n * @param {Assignment} assignment The assignment object to render\n * @return {string} Assignment HTML for use in a list\n */\ndtps.renderAssignment = function (assignment) {\n    //Render points/letter score\n    var scoreHTML = dtps.renderAssignmentScore(assignment);\n\n    var HTML = /*html*/`\n        <div \n            onclick=\"${`dtps.assignment('` + assignment.id + `', ` + assignment.class + `)`}\" \n            class=\"card ${scoreHTML ? \"graded assignment\" : \"assignment\"}\"\n            style=\"${'--classColor: ' + dtps.classes[assignment.class].color}\"\n        >\n\n            <!-- Color bar for the dashboard -->\n            <div class=\"colorBar\"></div>\n\n            <!-- Assignment title and points -->\n            <h4>\n                <span>${assignment.title}</span>\n\n                <!-- Points display -->\n                ${scoreHTML ? `<div class=\"points\">${scoreHTML}</div>` : ``}\n            </h4>\n\n            <h5 style=\"white-space: nowrap; overflow: hidden;\">\n                <!-- Assignment info -->\n                ${assignment.dueAt ? `<div class=\"infoChip\"><i style=\"margin-top: -2px;\" class=\"material-icons\">alarm</i> Due ` + dtps.formatDate(assignment.dueAt) + `</div>` : \"\"}\n                ${assignment.outcomes ? `<div class=\"infoChip weighted\"><i class=\"material-icons\">adjust</i>` + assignment.outcomes.length + `</div>` : \"\"}\n                ${assignment.category ? `<div class=\"infoChip weighted\"><i class=\"material-icons\">category</i> ` + assignment.category + `</div>` : \"\"}\n\n                <!-- Status icons -->\n                ${assignment.turnedIn ? `<i title=\"Assignment submitted\" class=\"material-icons statusIcon\" style=\"color: #0bb75b;\">assignment_turned_in</i>` : ``}\n                ${assignment.missing ? `<i title=\"Assignment is missing\" class=\"material-icons statusIcon\" style=\"color: #c44848;\">remove_circle_outline</i>` : ``}\n                ${assignment.late ? `<i title=\"Assignment is late\" class=\"material-icons statusIcon\" style=\"color: #c44848;\">assignment_late</i>` : ``}\n                ${assignment.locked ? `<i title=\"Assignment submissions are locked\" class=\"material-icons statusIcon\" style=\"font-family: 'Material Icons Extended'; color: var(--secText, gray);\">lock_outline</i>` : ``}\n                ${assignment.pending ? `<i title=\"Grade is pending review\" class=\"material-icons statusIcon\" style=\"color: #b3b70b;\">rate_review</i>` : ``}\n            </h5>\n        </div>\n    `;\n\n    return HTML;\n}\n\n/**\n* Renders HTML for an assignment score if the assignment is graded\n* \n* @param {Assignment} assignment The assignment object to render a score for\n* @return {string} Assignment score HTML\n*/\ndtps.renderAssignmentScore = function (assignment) {\n    var scoreHTML = \"\";\n\n    //Use rubric score over points score if possible\n    if (dtpsLMS.useRubricGrades && assignment.rubric) {\n        var rubricHTML = [];\n\n        assignment.rubric.forEach(rubricItem => {\n            if (rubricItem.score) {\n                rubricHTML.push(/*html*/`\n                    <div title=\"${rubricItem.title}\" style=\"color: ${rubricItem.color || \"var(--text)\"};\">\n                        ${rubricItem.score}\n                    </div>\n                `);\n            }\n        });\n\n        if (rubricHTML.length) scoreHTML = `<div class=\"dtpsRubricScore\">${rubricHTML.join(\"\")}</div>`;\n\n    } else if (!dtpsLMS.useRubricGrades && (assignment.grade || (assignment.grade == 0))) {\n        scoreHTML = /*html*/`\n            <div class=\"assignmentGrade\">\n                <div class=\"grade\">${Number(assignment.grade.toFixed(2))}</div>\n                <div class=\"value\">/${Number(assignment.value.toFixed(2))}</div>\n                ${assignment.letter ? `<div class=\"letter\">${assignment.letter.replace(\"incomplete\", `<i class=\"material-icons\">cancel</i>`).replace(\"complete\", `<i class=\"material-icons\">done</i>`)}</div>` : \"\"}\n                <div class=\"percentage\">${Math.round((assignment.grade / assignment.value) * 100)}%</div>\n            </div>\n        `;\n    }\n\n    return scoreHTML;\n}\n\n/**\n * Renders the DTPS dashboard and calls dtps.renderCalendar, dtps.renderUpdates, and dtps.renderUpcoming\n */\ndtps.masterStream = function () {\n    //Ensure classes are rendered in the sidebar\n    dtps.presentClass(\"dash\");\n    dtps.showClasses();\n\n    //Clear active state from all tabs\n    $(\"#dtpsTabBar .btn\").removeClass(\"active\");\n\n    //Count amount of classes that are loaded\n    var ready = 0;\n    dtps.classes.forEach(course => {\n        if (course.assignments) ready++;\n    });\n\n    //Check if all classes are loaded\n    var doneLoading = ready == dtps.classes.length;\n\n    //Returns dashboard item container HTML for an item\n    function dashboardContainerHTML(dashboardItem) {\n        if (dashboardItem.id == \"dtps.calendar\") {\n            return window.FullCalendar ? `<div id=\"calendar\" class=\"card\" style=\"padding: 20px;\"></div>` : \"\";\n        } else if (dashboardItem.id == \"dtps.updates\") {\n            return `<div class=\"updatesStream recentlyGraded announcements\"></div>`;\n        } else if (dashboardItem.id == \"dtps.dueToday\") {\n            return `<div style=\"padding: 20px 0px;\" class=\"dueToday\"></div>`;\n        } else if (dashboardItem.id == \"dtps.upcoming\") {\n            return `<div style=\"padding: 20px 0px;\" class=\"assignmentStream\"></div>`;\n        }\n    }\n\n    //Render HTML with loading placeholder\n    if (dtps.selectedClass == \"dash\") {\n        jQuery(\".classContent\").html(/*html*/`\n            <div class=\"dash cal\" style=\"width: 40%;display: inline-block; vertical-align: top;\">\n                ${dtps.leftDashboard.map(dashboardItem => {\n            return dashboardContainerHTML(dashboardItem);\n        }).join(\"\")}\n            </div>\n\n            <div style=\"width: 59%; display: inline-block;\" class=\"dash stream\">\n                ${!doneLoading ? `<div style=\"margin: 75px 25px 10px 75px;\"><div class=\"spinner\"></div></div>` : \"\"}\n                ${dtps.rightDashboard.map(dashboardItem => {\n            return dashboardContainerHTML(dashboardItem);\n        }).join(\"\")}\n            </div>\n        `);\n    }\n\n    //Render updates stream\n    dtps.renderUpdates();\n\n    //Render upcoming assignments stream\n    dtps.renderUpcoming(doneLoading);\n\n    //Render calendar\n    dtps.calendar();\n\n    //Render due today\n    dtps.renderDueToday(doneLoading);\n}\n\n/**\n * Compiles and displays due today / to-do stream\n * \n * @param {boolean} doneLoading True if all classes have finished loading their assignment lists\n */\ndtps.renderDueToday = function (doneLoading) {\n    //Combine class stream arrays\n    var combinedStream = [];\n    if (dtps.classes) {\n        dtps.classes.forEach(course => {\n            if (course.assignments) {\n                //If course has assignments, add them to the combined stream array\n                course.assignments.forEach(assignment => {\n                    //Only assignments that are due today\n                    if (dtps.isToday(assignment.dueAt)) {\n                        combinedStream.push(assignment);\n                    }\n                })\n            }\n        })\n    }\n\n    //Sort combined stream by date\n    combinedStream.sort(function (a, b) {\n        var keyA = new Date(a.dueAt).getTime(),\n            keyB = new Date(b.dueAt).getTime();\n\n        // Compare the 2 dates\n        if (keyA > keyB) return 1;\n        if (keyA < keyB) return -1;\n        return 0;\n    });\n\n    //Get due today stream HTML\n    var combinedHTML = combinedStream.map(assignment => {\n        return dtps.renderAssignment(assignment);\n    }).join(\"\");\n\n    if (combinedStream.length == 0) {\n        //Nothing due today\n        if (doneLoading) {\n            combinedHTML = `<p style=\"text-align: center;margin: 10px 25px 10px 75px; font-size: 18px;\"><i class=\"material-icons\">done</i> Nothing due today</p>`;\n        } else {\n            combinedHTML = ``;\n        }\n    } else {\n        //Add header\n        combinedHTML = /*html*/`\n            <h5 style=\"text-align: center; margin: 10px 25px 10px 75px; font-weight: bold;\">Due today</h5>\n        ` + combinedHTML;\n    }\n\n    if (dtps.selectedClass == \"dash\") {\n        jQuery(\".classContent .dash .dueToday\").html(combinedHTML);\n    }\n}\n\n/**\n * Compiles and displays upcoming assignments stream\n */\ndtps.renderUpcoming = function () {\n    //Combine class stream arrays\n    var combinedStream = [];\n    if (dtps.classes) {\n        dtps.classes.forEach(course => {\n            if (course.assignments) {\n                //If course has assignments, add them to the combined stream array\n                course.assignments.forEach(assignment => {\n                    //Only include upcoming assignments that aren't due today\n                    if ((new Date(assignment.dueAt) > new Date()) && !dtps.isToday(assignment.dueAt)) {\n                        combinedStream.push(assignment);\n                    }\n                })\n            }\n        })\n    }\n\n    //Sort combined stream by date\n    combinedStream.sort(function (a, b) {\n        var keyA = new Date(a.dueAt).getTime(),\n            keyB = new Date(b.dueAt).getTime();\n\n        // Compare the 2 dates\n        if (keyA > keyB) return 1;\n        if (keyA < keyB) return -1;\n        return 0;\n    });\n\n    //Render upcoming assignments stream\n    var combinedHTML = combinedStream.map(assignment => {\n        return dtps.renderAssignment(assignment);\n    }).join(\"\");\n\n    //No upcoming assignments\n    if (combinedStream.length == 0) {\n        combinedHTML = \"\";\n    }\n\n    if (dtps.selectedClass == \"dash\") {\n        jQuery(\".classContent .dash .assignmentStream\").html(combinedHTML);\n    }\n}\n\n/**\n * Renders updates stream (recently graded & announcements)\n */\ndtps.renderUpdates = function () {\n    //Get updates HTML\n    var updatesHTML = \"\";\n\n    dtps.updates.forEach(update => {\n        if (update.type == \"announcement\") {\n            updatesHTML += /*html*/`\n                <div onclick=\"$(this).toggleClass('open');\" style=\"cursor: pointer; padding: 20px; --classColor: ${dtps.classes[update.class].color};\" class=\"announcement card\">\n                    <div class=\"className\">${update.title}</div>\n                    ${update.body}\n                </div>\n            `;\n        } else if (update.type == \"assignment\") {\n            var scoreHTML = dtps.renderAssignmentScore(update);\n            updatesHTML += /*html*/`\n                <div onclick=\"dtps.assignment('${update.id}', ${update.class})\" style=\"--classColor: ${dtps.classes[update.class].color};\" class=\"card recentGrade\">\n                    <h5>\n                        <span>${update.title}</span>\n\n                        <!-- Points display -->\n                        ${scoreHTML ? `<div class=\"points\">${scoreHTML}</div>` : ``}\n                    </h5>\n\n                    <p>Graded at ${dtps.formatDate(update.gradedAt)}</p>\n                </div>\n            `;\n        }\n    })\n\n    if (dtps.selectedClass == \"dash\") {\n        jQuery(\".classContent .dash .updatesStream\").html(updatesHTML);\n    }\n}\n\n\n/**\n * Compiles and displays the assignment calendar\n */\ndtps.calendar = function () {\n    if (dtps.selectedClass == \"dash\") {\n        //Calendar events array\n        var calEvents = [];\n\n        //Add assignments from every class to calEvents array\n        dtps.classes.forEach((course, courseIndex) => {\n            if (course.assignments) {\n                //Class has assignments\n                course.assignments.forEach(assignment => {\n                    calEvents.push({\n                        title: assignment.title,\n                        start: assignment.dueAt,\n                        id: assignment.id,\n                        allDay: true,\n                        backgroundColor: course.color,\n                        borderColor: (assignment.missing === true) ? '#c44848' : 'transparent',\n                        textColor: \"white\",\n                        classNum: courseIndex,\n                        assignmentID: assignment.id,\n                        missing: assignment.missing\n                    });\n                });\n            }\n        });\n\n        //Render calendar\n        if (window.FullCalendar) {\n            var calendarEl = document.getElementById('calendar');\n            calendar = new FullCalendar.Calendar(calendarEl, {\n                locale: \"en\",\n                initialView: 'dayGridMonth',\n                events: calEvents,\n                eventContent: info => {\n                    const { missing } = info.event.extendedProps;\n                    const html = /*html*/`\n                        <div class='fc-event-main-frame'>\n                            <div class='fc-event-title-container'>\n                                <div class='fc-event-title fc-sticky'>\n                                    ${missing ? `<i title=\"Assignment is missing\" class=\"material-icons statusIcon\">remove_circle_outline</i>` : ``}\n                                    <span style=\"vertical-align: middle;\">${info.event.title}</span>\n                                </div>\n                            </div>\n                        </div>\n                    `;\n                    return { html };\n                },\n                contentHeight: 0,\n                handleWindowResize: false,\n                headerToolbar: {\n                    start: 'title',\n                    center: '',\n                    end: 'prev,next'\n                },\n                dateClick: function (info) {\n                    // Set the current day and update the upcoming assignments based on that\n                },\n                eventClick: function (info) {\n                    dtps.assignment(info.event.extendedProps.assignmentID, info.event.extendedProps.classNum);\n                }\n            });\n            calendar.render();\n        }\n    }\n}\n\n/**\n * Shows the assignments stream for a class\n * \n * @param {string} classID The class ID to show assignments for\n * @param {Assignment[]} [searchResults] An array of assignemnts to render instead of course.assignments. Used for assignment search.\n * @param {string} [searchText] Text to render in the search box. Used for assignment search.\n */\ndtps.classStream = function (classID, searchResults, searchText) {\n    //Get class index and set as selected class\n    var classNum = dtps.classes.map(course => course.id).indexOf(classID);\n    dtps.selectedClass = classNum;\n\n    //Set stream as the selected content\n    dtps.selectedContent = \"stream\";\n    $(\"#dtpsTabBar .btn\").removeClass(\"active\");\n    $(\"#dtpsTabBar .btn.stream\").addClass(\"active\");\n\n    //Load class color, name, etc.\n    dtps.presentClass(classNum);\n\n    //Ensure classes are shown in the sidebar\n    dtps.showClasses();\n\n    if (classNum == -1) {\n        //Class does not exist\n        dtps.error(\"The selected class doesn't exist\", \"classNum check failed @ dtps.classStream\");\n    }\n\n    //Use search results to render or render all class assignments\n    var assignments = searchResults || dtps.classes[classNum].assignments;\n\n    //Render assignments\n    if (!assignments) {\n        //Assignments are still loading\n        if ((dtps.selectedClass == classNum) && (dtps.selectedContent == \"stream\")) {\n            jQuery(\".classContent\").html(dtps.renderClassTools(classNum, \"stream\", searchText) + `<div class=\"spinner\"></div>`);\n        }\n    } else if (assignments.length == 0) {\n        if (searchText) {\n            //No search results\n            if ((dtps.selectedClass == classNum) && (dtps.selectedContent == \"stream\")) {\n                $(\".classContent\").html(/*html*/ dtps.renderClassTools(classNum, \"stream\", searchText) + `\n                    <div style=\"cursor: auto;\" class=\"card assignment\">\n                        <h4>No results</h4>\n                        <p>There weren't any search results</p>\n                        <button onclick=\"fluid.screen()\" class=\"btn\"><i class=\"material-icons\">arrow_back</i> Back</button>\n                    </div>\n                `);\n            }\n        } else {\n            //This class doesn't have any assignments\n            if ((dtps.selectedClass == classNum) && (dtps.selectedContent == \"stream\")) {\n                $(\".classContent\").html(dtps.renderClassTools(classNum, \"stream\", searchText) + `<div style=\"cursor: auto;\" class=\"card assignment\"><h4>No assignments</h4><p>There aren't any assignments in this class yet</p></div>`);\n            }\n        }\n    } else {\n        //Sort assignments\n        assignments.sort(function (a, b) {\n            var keyA = new Date(a.dueAt).getTime(),\n                keyB = new Date(b.dueAt).getTime();\n\n            var now = new Date().getTime();\n\n            //Put assignments without a due date at the end\n            if (!a.dueAt) { keyA = 0; }\n            if (!b.dueAt) { keyB = 0; }\n\n            //Put upcoming assignments at the top\n            if ((keyA < now) || (keyB < now)) {\n                // Sort upcoming assignments from earliest -> latest\n                if (keyA < keyB) return 1;\n                if (keyA > keyB) return -1;\n                return 0;\n            } else {\n                // Sort old assignments from latest -> earliest\n                if (keyA > keyB) return 1;\n                if (keyA < keyB) return -1;\n                return 0;\n            }\n        });\n\n        //Render assignments\n        var prevAssignment = null;\n        var streamHTML = assignments.map(assignment => {\n            var divider = \"\";\n\n            if (!assignment.dueAt) {\n                if (prevAssignment && (prevAssignment !== \"undated\")) {\n                    divider = `<h5 style=\"margin: 75px 75px 10px 75px;font-weight: bold;\">Undated Assignments</h5>`;\n                }\n\n                prevAssignment = \"undated\";\n            } else if (new Date(assignment.dueAt) < new Date()) {\n                if (prevAssignment && (prevAssignment !== \"old\")) {\n                    divider = `<h5 style=\"margin: 75px 75px 10px 75px;font-weight: bold;\">Old Assignments</h5>`;\n                }\n\n                prevAssignment = \"old\";\n            } else {\n                prevAssignment = \"upcoming\";\n            }\n\n            return divider + dtps.renderAssignment(assignment);\n        }).join(\"\");\n\n        //Add stream header with class info buttons and search box\n        streamHTML = dtps.renderClassTools(classNum, \"stream\", searchText) + streamHTML;\n\n        if ((dtps.selectedClass == classNum) && (dtps.selectedContent == \"stream\")) {\n            $(\".classContent\").html(streamHTML);\n        }\n    }\n}\n\n/**\n * Shows details for an assignment given the assignment ID and class number\n * \n * @param {string} id Assignment ID\n * @param {number} classNum Assignment class number\n */\ndtps.assignment = function (id, classNum) {\n    //Get assignment from the id prop\n    var assignmentIDs = dtps.classes[classNum].assignments.map(assignment => assignment.id);\n    var assignment = dtps.classes[classNum].assignments[assignmentIDs.indexOf(id)];\n\n    //The assignment body is rendered in an iFrame to keep its content and styling isolated from the rest of the page\n    var assignmentBodyHTML = null;\n    if (assignment.body) {\n        //Get computed background and text color to style the iFrame with\n        var computedBackgroundColor = getComputedStyle($(\".card.details\")[0]).getPropertyValue(\"--cards\");\n        var computedTextColor = getComputedStyle($(\".card.details\")[0]).getPropertyValue(\"--text\");\n\n        var body = assignment.body;\n        if ($(\"body\").hasClass(\"dark\")) {\n            body = dtps.brightenTextForDarkMode(assignment.body, computedBackgroundColor);\n        }\n\n        var hasKeywords = false;\n        if (body.toLowerCase().includes(\"deliverable\") && body.toLowerCase().includes(\"instruction\") && body.toLowerCase().includes(\"look for\")) hasKeywords = true;\n        if (dtps.remoteConfig.dtechCleanUpAssignments && (fluid.get('pref-formatAssignmentContent') !== \"false\") && dtpsLMS.dtech && hasKeywords && ($('<div></div>').append(body).children(\"table\").find(\"tbody tr\").length > 1)) {\n            var sections = [];\n            $('<div></div>').append(body).children(\"table\").find(\"tbody tr\").toArray().forEach((element, i) => {\n                var text = $(element).find(\"h4:first-child\").text().toLowerCase();\n                if (!text) return;\n\n                var tmpjQuery = $(element);\n                tmpjQuery.find(\"h4:first-child\").remove();\n                var innerHTML = tmpjQuery.html();\n                if (!innerHTML) return;\n\n                var icon = null;\n                if (text.includes(\"deliverable\")) { icon = \"description\"; text = \"Deliverables\"; }\n                if (text.includes(\"instruction\")) { icon = \"assignment\"; text = \"Instructions\"; }\n                if (text.includes(\"look for\")) { icon = \"find_in_page\"; text = \"Look Fors\"; }\n\n                sections.push({ text, icon, innerHTML });\n            });\n\n            var tmpjQuery = $('<div></div>').append(body);\n            tmpjQuery.children(\"table\").replaceWith(sections.map(s => {\n                return `\n                    <div class=\"dtpsFormattedAssignmentSection\" style=\"margin: 20px 0px;\">\n                        <h2><i style=\"vertical-align: middle; margin-right: 10px; font-size: 24px;\" class=\"material-icons-outlined\">${s.icon}</i><span style=\"vertical-align: middle;text-decoration: underline;\">${s.text}</span></h2>\n                        ${s.innerHTML}\n                    </div>\n                `;\n            }).join(\"\"));\n            var outerHTML = tmpjQuery.html();\n\n            var blob = new Blob([`\n                    <base target=\"_blank\" /> \n                    <link type=\"text/css\" rel=\"stylesheet\" href=\"https://cdn.jottocraft.com/CanvasCSS.css\" media=\"screen,projection\"/>\n                    <link href=\"https://fonts.googleapis.com/icon?family=Material+Icons+Outlined\" rel=\"stylesheet\">\n                    <style>body {background-color: ${computedBackgroundColor}; color: ${computedTextColor};} .dtpsFormattedAssignmentSection *:not(a) { color: ${computedTextColor} !important; } .dtpsFormattedAssignmentSection * { background: none !important; }</style>\n                    ${outerHTML}\n            `], { type: 'text/html' });\n            assignmentBodyHTML = `<iframe id=\"assignmentParts\" onload=\"dtps.iframeLoad('assignmentParts')\" style=\"margin: 10px 0px; width: 100%; border: none; outline: none;\" src=\"${window.URL.createObjectURL(blob)}\" />`;\n        } else {\n            //Generate a blob with the assignment body and get its data URL\n            var blob = new Blob([`\n                <base target=\"_blank\" /> \n                <link type=\"text/css\" rel=\"stylesheet\" href=\"https://cdn.jottocraft.com/CanvasCSS.css\" media=\"screen,projection\"/>\n                <style>body {background-color: ${computedBackgroundColor}; color: ${computedTextColor};}</style>\n                ${body}\n            `], { type: 'text/html' });\n            assignmentBodyHTML = `<iframe id=\"assignmentIframe\" onload=\"dtps.iframeLoad('assignmentIframe')\" style=\"margin: 10px 0px; width: 100%; border: none; outline: none;\" src=\"${window.URL.createObjectURL(blob)}\" />`;\n        }\n    }\n\n    //Get assignment rubric HTML\n    var assignmentRubricHTML = \"\";\n    if (assignment.rubric) {\n        var assignmentRubricHTML = assignment.rubric.map(function (rubricItem) {\n            return /*html*/`\n                    <div class=\"dtpsAssignmentRubricItem\">\n                        <h5>${rubricItem.title}</h5>\n                        <div class=\"score\">\n                            <p style=\"color: ${rubricItem.color ? rubricItem.color : \"var(--secText)\"};\" class=\"scoreName\">\n                                ${rubricItem.score ? rubricItem.scoreName || \"\" : \"Not assessed\"}\n\n                                <div class=\"points\">\n                                    <p class=\"earned\">${rubricItem.score || \"-\"}</p>\n                                    <p class=\"possible\">${\"/\" + rubricItem.value}</p>\n                                </div>\n                            </p>\n                        </div>\n                    </div>\n                `\n        }).join(\"\");\n    }\n\n    //Get assignment feedback HTML\n    var assignmentFeedbackHTML = \"\";\n    if (assignment.feedback) {\n        var assignmentFeedbackHTML = assignment.feedback.map(feedback => {\n            return /*html*/`\n                    <div class=\"dtpsSubmissionComment\">\n                        ${feedback.author ? /*html*/`\n                            <img src=\"${feedback.author.photoURL}\" />\n                            <h5>${feedback.author.name}</h5>\n                        ` : ``}\n\n                        <p>${feedback.comment}</p>\n                    </div>\n                `\n        }).join(\"\");\n    }\n\n    //Get assignment score HTML\n    var scoreHTML = dtps.renderAssignmentScore(assignment);\n\n    //Render assignment details\n    $(\".card.details\").html(/*html*/`\n            <i onclick=\"fluid.cards.close('.card.details'); $('.card.details').html('');\" class=\"material-icons close\">close</i>\n\n            <h4 style=\"font-weight: bold;\">${assignment.title}</h4>\n\n            <div>\n                ${assignment.dueAt ? `<div class=\"assignmentChip\"><i class=\"material-icons\">alarm</i><span>Due ${dtps.formatDate(assignment.dueAt)}</span></div>` : \"\"}\n                ${assignment.turnedIn ? `<div title=\"Assignment submitted\" class=\"assignmentChip\" style=\"color: #0bb75b\"><i class=\"material-icons\">assignment_turned_in</i></div>` : \"\"}\n                ${assignment.missing ? `<div  title=\"Assignment is missing\" class=\"assignmentChip\" style=\"color: #c44848\"><i class=\"material-icons\">remove_circle_outline</i></div>` : \"\"}\n                ${assignment.late ? `<div title=\"Assignment is late\" class=\"assignmentChip\" style=\"color: #c44848\"><i class=\"material-icons\">assignment_late</i></div>` : \"\"}\n                ${assignment.locked ? `<div title=\"Assignment submissions are locked\" class=\"assignmentChip\" style=\"color: var(--secText, gray);\"><i style=\"font-family: 'Material Icons Extended';\" class=\"material-icons\">lock_outline</i></div>` : \"\"}\n                ${scoreHTML}\n            </div>\n\n            <div style=\"margin-top: 20px;\" class=\"assignmentBody\">\n                ${assignment.body ? assignmentBodyHTML : \"\"}\n            </div>\n\n            ${assignment.body ? `<div style=\"margin: 5px 0px; background-color: var(--darker); height: 1px; width: 100%;\" class=\"divider\"></div>` : \"\"}\n\n            <div style=\"width: calc(40% - 2px); margin-top: 20px; display: inline-block; overflow: hidden; vertical-align: top;\">\n                ${assignment.publishedAt ? `<p style=\"color: var(--secText); margin: 5px 0px;\"><i style=\"vertical-align: middle;\" class=\"material-icons\">add_box</i> Published: ${dtps.formatDate(assignment.publishedAt)}</p>` : \"\"}\n                ${assignment.dueAt ? `<p style=\"color: var(--secText); margin: 5px 0px;\"><i style=\"vertical-align: middle;\" class=\"material-icons\">alarm</i> Due: ${dtps.formatDate(assignment.dueAt)}</p>` : \"\"}\n                ${assignment.value ? `<p style=\"color: var(--secText); margin: 5px 0px;\"><i style=\"vertical-align: middle;\" class=\"material-icons\">bar_chart</i> Point value: ${assignment.value}</p>` : \"\"}\n                ${(assignment.grade || (assignment.grade == 0)) ? `<p style=\"color: var(--secText); margin: 5px 0px;\"><i style=\"vertical-align: middle;\" class=\"material-icons\">assessment</i> Points earned: ${assignment.grade}</p>` : \"\"}\n                ${assignment.letter ? `<p style=\"color: var(--secText); margin: 5px 0px;\"><i style=\"vertical-align: middle;\" class=\"material-icons\">font_download</i> Letter grade: ${assignment.letter}</p>` : \"\"}\n                ${assignment.category ? `<p style=\"color: var(--secText); margin: 5px 0px;\"><i style=\"vertical-align: middle;\" class=\"material-icons\">category</i> Category: ${assignment.category}</p>` : \"\"}\n                ${assignment.rubric ? assignment.rubric.map(function (rubricItem) { return `<p style=\"color: var(--secText); margin: 5px 0px;\"><i style=\"vertical-align: middle;\" class=\"material-icons\">adjust</i> ${rubricItem.title}</p>`; }).join(\"\") : \"\"}\n                <p style=\"color: var(--secText); margin: 5px 0px;\"><i style=\"vertical-align: middle;\" class=\"material-icons\">class</i> Class: ${dtps.classes[assignment.class].subject}</p>\n                ${dtps.env == \"dev\" ? `<p style=\"color: var(--secText); margin: 5px 0px;\"><i style=\"vertical-align: middle;\" class=\"material-icons\">code</i> Assignment ID: ${assignment.id}</p>` : \"\"}\n\n                <br />\n                <div class=\"row\">\n                    ${assignment.url ? `<div class=\"btn small outline\" onclick=\"window.open('${assignment.url}')\"><i class=\"material-icons\">open_in_new</i> Open in ${dtpsLMS.shortName || dtpsLMS.name}</div>` : ``}\n                </div>\n            </div>\n\n            <div style=\"width: calc(60% - 7px); margin-top: 20px; margin-left: 5px; display: inline-block; overflow: hidden; vertical-align: middle;\">\n                ${assignmentFeedbackHTML}\n\n                ${assignmentRubricHTML}\n            </div>\n        `);\n\n    //Close other active cards and open the assignment details card\n    fluid.cards.close(\".card.focus\");\n    fluid.modal(\".card.details\");\n}\n\n/**\n * Searches the assignment stream for a keyword using Fuse.js\n */\ndtps.search = function () {\n    if ($(\"input.search\").val() == \"\") {\n        fluid.screen();\n    } else {\n        var input = $(\"input.search\").val();\n        var search = new Fuse(dtps.classes[dtps.selectedClass].assignments, {\n            keys: [\"title\", \"body\"]\n        });\n        dtps.classStream(dtps.classes[dtps.selectedClass].id, search.search(input), input);\n    }\n}\n\n/**\n * Shows the module stream for a class\n * \n * @param {string} classID Class number to fetch modules for\n */\ndtps.moduleStream = function (classID) {\n    //Get class index and set as selected class\n    var classNum = dtps.classes.map(course => course.id).indexOf(classID);\n    dtps.selectedClass = classNum;\n\n    //Set stream as the selected content\n    dtps.selectedContent = \"moduleStream\";\n    $(\"#dtpsTabBar .btn\").removeClass(\"active\");\n    $(\"#dtpsTabBar .btn.stream\").addClass(\"active\");\n\n    //Load class color, name, etc.\n    dtps.presentClass(classNum);\n\n    //Ensure classes are shown in the sidebar\n    dtps.showClasses();\n\n    if (classNum == -1) {\n        //Class does not exist\n        dtps.error(\"The selected class doesn't exist\", \"classNum check failed @ dtps.moduleStream\");\n    }\n\n    //Show loading indicator\n    if ((dtps.selectedClass == classNum) && (dtps.selectedContent == \"moduleStream\")) {\n        jQuery(\".classContent\").html(dtps.renderClassTools(classNum, \"modules\") + `<div class=\"spinner\"></div>`);\n    }\n\n    new Promise(resolve => {\n        if (dtps.classes[classNum].modules && (dtps.classes[classNum].modules !== true)) {\n            resolve(dtps.classes[classNum].modules);\n        } else {\n            dtpsLMS.fetchModules(dtps.classes[classNum].id).then(data => resolve(data));\n        }\n    }).then(data => {\n        //Save modules data in the class object for future use\n        dtps.classes[classNum].modules = data;\n\n        var modulesHTML = dtps.renderClassTools(classNum, \"modules\");\n\n        data.forEach(module => {\n            var moduleItemHTML = \"\";\n\n            //Get HTML for each module item\n            module.items.forEach(item => {\n                //Get module item icon\n                var icon = \"list\";\n                if (item.type == \"assignment\") icon = \"assignment\";\n                if (item.type == \"page\") icon = \"insert_drive_file\";\n                if (item.type == \"discussion\") icon = \"forum\";\n                if (item.type == \"url\") icon = \"open_in_new\";\n                if (item.type == \"header\") icon = \"format_size\";\n                if (item.type == \"embed\") icon = \"web\";\n\n                //Get module action\n                var action = \"\";\n                if (item.type == \"assignment\") action = \"dtps.assignment('\" + item.id + \"', \" + classNum + \")\";\n                if (item.type == \"page\") {\n                    action = \"fluid.screen('pages', '\" + classID + \"|\" + item.id + \"|true')\";\n                }\n                if (item.type == \"discussion\") {\n                    action = \"fluid.screen('discussions', '\" + classID + \"|\" + item.id + \"|true')\";\n                }\n                if (item.type == \"url\") action = \"window.open('\" + item.url + \"')\";\n                if (item.type == \"header\") action = \"\";\n                if (item.type == \"embed\") action = \"dtps.showIFrameCard('\" + item.url + \"')\";\n\n                //Get module HTML\n                if (item.type == \"header\") {\n                    moduleItemHTML += `<h5 style=\"font-size: 22px;padding: 2px 10px;\">${item.title}</h5>`;\n                } else {\n                    moduleItemHTML += `\n                        <div class=\"moduleItem\" onclick=\"${action}\" style=\"margin-left: ${item.indent * 15}px;\">\n                            <i ${item.completed ? `style=\"color: #27ba3c\"` : \"\"} class=\"material-icons\">${item.completed ? \"check\" : icon}</i>\n                            ${item.title}\n                        </div>\n                    `;\n                }\n            });\n\n            //Add HTML for this module to the string\n            modulesHTML += /*html*/`\n                <div class=\"module card ${module.collapsed ? \"collapsed\" : \"\"}\">\n                    <h4>\n                        <i onclick=\"dtps.moduleCollapse(this, '${dtps.classes[classNum].id}', '${module.id}');\" \n                            class=\"material-icons collapseIcon\">${module.collapsed ? \"keyboard_arrow_right\" : \"keyboard_arrow_down\"}</i>\n                        ${module.title}\n                    </h4>\n\n                    <div class=\"moduleContents\" style=\"padding-top: 10px;\">\n                        ${moduleItemHTML}\n                    </div>\n                </div>\n            `;\n        });\n\n        if (data.length == 0) {\n            modulesHTML += `<div style=\"cursor: auto;\" class=\"card assignment\"><h4>No modules</h4><p>There aren't any modules in this class yet</p></div>`;\n        }\n\n        //Render module HTML\n        if ((dtps.selectedClass == classNum) && (dtps.selectedContent == \"moduleStream\")) {\n            jQuery(\".classContent\").html(modulesHTML);\n        }\n    }).catch(err => {\n        dtps.error(\"Could not load modules\", \"Caught promise rejection @ dtps.moduleStream\", err);\n    });\n}\n\n/**\n * Collapses a module\n * \n * @param {Element} ele Element of the module collapse arrow\n * @param {string} classID Class ID\n * @param {string} modID Module ID of the module to collapse\n */\ndtps.moduleCollapse = function (ele, classID, modID) {\n    //Add collapsed class to module card\n    $(ele).parents('.card').toggleClass('collapsed');\n\n    //Update arrow icon and, if the LMS supports it, collapse the module in the LMS as well\n    if ($(ele).parents('.card').hasClass('collapsed')) {\n        if (dtpsLMS.collapseModule) dtpsLMS.collapseModule(classID, modID, true);\n        $(ele).html('keyboard_arrow_right');\n    } else {\n        if (dtpsLMS.collapseModule) dtpsLMS.collapseModule(classID, modID, false);\n        $(ele).html('keyboard_arrow_down');\n    }\n\n}\n\n/**\n * Gets stream tools HTML (search box, class info, and modules/assignment switcher)\n * \n * @param {number} num Class number\n * @param {string} type Class content these tools are for (e.g. \"stream\")\n * @param {string} [searchText] Text to render in the search box for assignment search\n * @return {string} Stream tools HTML\n */\ndtps.renderClassTools = function (num, type, searchText) {\n    var modulesSelector = dtps.classes[num].modules;\n    return /*html*/`\n        <div style=\"position: absolute;display:inline-block;margin: ${modulesSelector ? \"82px\" : \"38px 82px\"};\">\n\n            ${dtps.classes[num].teacher ? /*html*/`\n                <div style=\"background-color: var(--elements); border-radius: 20px; display: inline-block; margin-right: 5px;\">\n                    <img src=\"${dtps.classes[num].teacher.photoURL}\" style=\"width: 40px; height: 40px; border-radius: 50%;vertical-align: middle;\"> \n                    <div style=\"font-size: 16px;display: inline-block;vertical-align: middle;margin: 0px 10px;\">${dtps.classes[num].teacher.name}</div>\n                </div>` : ``\n        }\n\n            <div onclick=\"dtps.classInfo(${num})\" class=\"classToolChip\">\n                <i style=\"line-height: 40px;\" class=\"material-icons\">${dtps.classes[num].id == dtps.remoteConfig.debugClassID ? \"bug_report\" : \"info\"}</i>\n            </div>\n\n            ${dtps.classes[num].homepage ? /*html*/`\n                <div onclick=\"dtps.classHome(${num})\" class=\"classToolChip\">\n                    <i style=\"line-height: 40px;\" class=\"material-icons\">home</i>\n                </div>` : \"\"\n        }\n\n        ${dtps.classes[num].videoMeetingURL ? /*html*/`\n                <div onclick=\"window.open('${dtps.classes[num].videoMeetingURL}')\" class=\"classToolChip\">\n                    <i style=\"line-height: 40px;\" class=\"material-icons\">videocam</i>\n                </div>` : \"\"\n        }\n\n        </div>\n        \n        ${(type == \"modules\") || (type == \"stream\") ? /*html*/`\n            <div style=\"text-align: right;${modulesSelector ? \"\" : \"margin-top: 20px;\"}\">\n\n                ${type == \"stream\" ? `<i class=\"inputIcon material-icons\">search</i><input ${searchText ? `value=\"${searchText}\"` : ``} onchange=\"dtps.search()\" class=\"search inputIcon filled shadow\" placeholder=\"Search assignments\" type=\"search\" />` : \"\"}\n\n                <br />\n                ${modulesSelector ? /*html*/`\n                    <div class=\"btns row small acrylicMaterial assignmentPicker\" style=\"margin: ${type == \"stream\" ? `20px 80px 20px 0px !important` : `63px 80px 20px 0px !important`};\">\n                        <button class=\"btn ${type == \"stream\" ? \"active\" : \"\"}\" onclick=\"fluid.screen('stream', dtps.classes[dtps.selectedClass].id);\"><i class=\"material-icons\">assignment</i>Assignments</button>\n                        <button class=\"btn ${type == \"modules\" ? \"active\" : \"\"}\" onclick=\"fluid.screen('moduleStream', dtps.classes[dtps.selectedClass].id);\"><i class=\"material-icons\">view_module</i>Modules</button>\n                    </div>\n                ` : ``}\n                \n            </div>` : ``\n        }\n    `;\n}\n\n/**\n * Displays class info & syllabus card\n * \n * @param {number} num Class number to show info for\n */\ndtps.classInfo = function (num) {\n    //Get syllabus blob if the class has a syllabus\n    if ((dtps.classes[num].syllabus !== \"\") && dtps.classes[num].syllabus !== null) {\n        //Get computed background and text color to style the iFrame with\n        var computedBackgroundColor = getComputedStyle($(\".card.details\")[0]).getPropertyValue(\"--cards\");\n        var computedTextColor = getComputedStyle($(\".card.details\")[0]).getPropertyValue(\"--text\");\n\n        //Generate a blob with the assignment body and get its data URL\n        var blob = new Blob([`\n            <base target=\"_blank\" /> \n            <link type=\"text/css\" rel=\"stylesheet\" href=\"https://cdn.jottocraft.com/CanvasCSS.css\" media=\"screen,projection\"/>\n            <style>body {background-color: ${computedBackgroundColor}; color: ${computedTextColor};</style>\n            ${dtps.classes[num].syllabus}\n        `], { type: 'text/html' });\n        var syllabusURL = window.URL.createObjectURL(blob);\n    }\n\n    //Show class info HTML\n    $(\".card.details\").html(/*html*/`\n        <i onclick=\"fluid.cards.close('.card.details')\" class=\"material-icons close\">close</i>\n\n        <h4 style=\"font-weight: bold;\">${dtps.classes[num].name}</h4>\n        <p style=\"color: var(--secText)\">${dtps.classes[num].description || \"\"}</p>\n\n        ${dtps.classes[num].numStudents ? `<div class=\"assignmentChip\"><i class=\"material-icons\">group</i><span>${dtps.classes[num].numStudents} students</span></div>` : ``}\n        ${dtps.env == \"dev\" ? `<div class=\"assignmentChip\"><i class=\"material-icons\">code</i><span>Class ID: ${dtps.classes[num].id}</span></div>` : ``}\n        ${dtps.classes[num].id == dtps.remoteConfig.debugClassID ? `<div class=\"assignmentChip\"><i class=\"material-icons\">bug_report</i><span>Debug class</span></div>` : ``}\n    \n        <br />\n\n        <div style=\"margin-top: 20px;\" class=\"syllabusBody\">\n            ${dtps.classes[num].syllabus ? `\n                <iframe id=\"syllabusIframe\" onload=\"dtps.iframeLoad('syllabusIframe')\" style=\"margin: 10px 0px; width: 100%; border: none; outline: none;\" src=\"${syllabusURL}\" />` : \"\"}\n        </div>\n    `)\n\n    //Show the class info card\n    fluid.modal(\".card.details\")\n}\n\n/**\n * Displays the class homepage\n * \n * @param {number} num Class number to show the homepage for\n */\ndtps.classHome = function (num) {\n    //Render loading screen\n    $(\".card.details\").html(/*html*/`\n        <i onclick=\"fluid.cards.close('.card.details')\" class=\"material-icons close\">close</i>\n        <h4 style=\"font-weight: bold;\">${dtps.classes[num].subject} Homepage</h4>\n\n        <br />\n        <p>Loading...</p>\n    `);\n\n    //Fetch homepage from the LMS\n    dtpsLMS.fetchHomepage(dtps.classes[num].id).then(homepage => {\n        if (homepage) {\n            //Get computed background and text color to style the iFrame with\n            var computedBackgroundColor = getComputedStyle($(\".card.details\")[0]).getPropertyValue(\"--cards\");\n            var computedTextColor = getComputedStyle($(\".card.details\")[0]).getPropertyValue(\"--text\");\n\n            if ($(\"body\").hasClass(\"dark\")) {\n                homepage = dtps.brightenTextForDarkMode(homepage, computedBackgroundColor);\n            }\n\n            if (dtps.remoteConfig.dtechHomepageFluidUITabs && ($('<div></div>').append(homepage).find(\".enhanceable_content.tabs>ul>li\").toArray().length > 1)) {\n                //Use special tab optimized homepage\n                var fragments = [];\n                $('<div></div>').append(homepage).find(\".enhanceable_content.tabs>ul>li\").toArray().forEach((fragment) => {\n                    var text = $(fragment).text().toLowerCase();\n                    if (!text) return;\n\n                    var id = $(fragment).find(\"a\").attr(\"href\").replace(\"#\", \"\");\n                    if (!id) return;\n\n                    var html = $(homepage).find(\"#\" + id).html();\n                    if (!html) return;\n\n                    var icon = null;\n                    if (text.includes(\"agenda\")) { icon = \"format_list_numbered\"; text = \"Agenda\"; }\n                    if (text.includes(\"instructor\")) { icon = \"person\"; text = \"Instructor\"; }\n                    if (text.includes(\"course info\")) { icon = \"info\"; text = \"Course Info\"; }\n                    if (text.includes(\"resources\")) { icon = \"article\"; text = \"Course Resources\"; }\n\n                    //Generate a blob with the assignment body and get its data URL\n                    var blob = new Blob([`\n                        <base target=\"_blank\" /> \n                        <link type=\"text/css\" rel=\"stylesheet\" href=\"https://cdn.jottocraft.com/CanvasCSS.css\" media=\"screen,projection\"/>\n                        <style>body {background-color: ${computedBackgroundColor}; color: ${computedTextColor};</style>\n                        ${html}\n                    `], { type: 'text/html' });\n                    var frameURL = window.URL.createObjectURL(blob);\n\n                    fragments.push({ text, id, icon, frameURL });\n                });\n\n                $(\".card.details\").html(/*html*/`\n                    <i onclick=\"fluid.cards.close('.card.details')\" class=\"material-icons close\">close</i>\n\n                    <h4 style=\"font-weight: bold;\">${dtps.classes[num].subject} Homepage</h4>\n\n                    <br />\n                    ${dtps.classes[num].videoMeetingURL ? `<button onclick=\"window.open('${dtps.classes[num].videoMeetingURL}')\" class=\"btn small\"><i class=\"material-icons\">videocam</i> Zoom</button>` : ``}\n                    <div class=\"btns row small\">\n                        ${fragments.map((fragment, i) => {\n                    return `<button onclick=\"$(this).addClass('active');$(this).siblings().removeClass('active');$('#homepageFragment').attr('src', '${fragment.frameURL}'); dtps.iframeLoad('homepageFragment');\" \n                                style=\"text-transform: capitalize;\" class=\"btn ${i == 0 ? \"active\" : \"\"}\">${fragment.icon ? `<i class=\"material-icons\">${fragment.icon}</i> ` : \"\"}${fragment.text}</button>`;\n                }).join(\"\")}\n                    </div>\n\n                    <br />\n                    <div style=\"margin-top: 20px;\" class=\"homepageBody\">\n                        <iframe id=\"homepageFragment\" onload=\"dtps.iframeLoad('homepageFragment')\" style=\"margin: 10px 0px; width: 100%; border: none; outline: none;\" src=\"${fragments[0].frameURL}\" />\n                    </div>\n                `);\n            } else {\n                //Generate a blob with the assignment body and get its data URL\n                var blob = new Blob([`\n                    <base target=\"_blank\" /> \n                    <link type=\"text/css\" rel=\"stylesheet\" href=\"https://cdn.jottocraft.com/CanvasCSS.css\" media=\"screen,projection\"/>\n                    <style>body {background-color: ${computedBackgroundColor}; color: ${computedTextColor};</style>\n                    ${homepage}\n                `], { type: 'text/html' });\n                var homepageURL = window.URL.createObjectURL(blob);\n\n                $(\".card.details\").html(/*html*/`\n                    <i onclick=\"fluid.cards.close('.card.details')\" class=\"material-icons close\">close</i>\n\n                    <h4 style=\"font-weight: bold;\">${dtps.classes[num].subject} Homepage</h4>\n\n                    <br />\n                    <div style=\"margin-top: 20px;\" class=\"homepageBody\">\n                        <iframe id=\"homepageIframe\" onload=\"dtps.iframeLoad('homepageIframe')\" style=\"margin: 10px 0px; width: 100%; border: none; outline: none;\" src=\"${homepageURL}\" />\n                    </div>\n                `);\n            }\n\n            fluid.modal(\".card.details\");\n        } else {\n            fluid.cards.close('.card.details');\n            dtps.error(\"Homepage unavailable\", \"homepage is either empty or undefined @ dtps.classHome\");\n        }\n    }).catch(e => {\n        dtps.error(\"Couldn't load homepage\", \"Caught a promise rejection @ dtps.classHome\", e);\n    })\n}\n\n/**\n * Shows the generic gradebook\n * \n * @param {string} classID Class ID\n */\ndtps.gradebook = function (classID) {\n    //Get class index and set as selected class\n    var classNum = dtps.classes.map(course => course.id).indexOf(classID);\n    dtps.selectedClass = classNum;\n\n    //Set stream as the selected content\n    dtps.selectedContent = \"grades\";\n    $(\"#dtpsTabBar .btn\").removeClass(\"active\");\n    $(\"#dtpsTabBar .btn.grades\").addClass(\"active\");\n\n    //Load class color, name, etc.\n    dtps.presentClass(classNum);\n\n    //Ensure classes are shown in the sidebar\n    dtps.showClasses();\n\n    if (classNum == -1) {\n        //Class does not exist\n        dtps.error(\"The selected class doesn't exist\", \"classNum check failed @ dtps.gradebook\");\n    }\n\n    //Show loading indicator\n    if ((dtps.selectedClass == classNum) && (dtps.selectedContent == \"grades\")) {\n        jQuery(\".classContent\").html(`<div class=\"spinner\"></div>`);\n    }\n\n    //Terminate function if the class doesn't have a letter grade or assignments\n    if (!dtps.classes[classNum].letter || !dtps.classes[classNum].assignments) {\n        return;\n    }\n\n    //Define variables for total points and zeros\n    var zeros = 0;\n    var totalPoints = 0;\n    var earnedPoints = 0;\n    var gradedAssignments = 0;\n\n    //Define variable for assignment HTML string\n    var assignmentHTML = \"\";\n\n    //Calculate total points and zeros\n    dtps.classes[classNum].assignments.forEach(assignment => {\n        if (assignment.grade || (assignment.grade == 0)) {\n            earnedPoints += assignment.grade;\n            gradedAssignments++;\n\n            assignmentHTML += /*html*/`\n                <div onclick=\"dtps.assignment('${assignment.id}', ${classNum})\" class=\"gradebookAssignment card\">\n                    <h5>\n                        ${assignment.title}\n\n                        <div class=\"stats\">\n                            ${assignment.letter ? `<div class=\"gradebookLetter\">${assignment.letter}</div>` : \"\"}\n                            <div class=\"gradebookScore\">${assignment.grade}</div>\n                            <div class=\"gradebookValue\">/${assignment.value}</div>\n                            <div class=\"gradebookPercentage\">${Math.round((assignment.grade / assignment.value) * 100)}%</div>\n                        </div>\n                    </h5>\n                </div>\n            `;\n        }\n\n        if (assignment.value) {\n            totalPoints += assignment.value;\n        }\n\n        if ((assignment.grade == 0) && assignment.value) {\n            zeros++;\n        }\n    })\n\n    //Grade calculation summary\n    var gradeCalcSummary = /*html*/`\n        <div style=\"--classColor: ${dtps.classes[classNum].color}\" class=\"card\">\n            <h3 class=\"gradeTitle\">\n                Grade Summary\n                <div class=\"classGradeCircle\">\n                    ${dtps.classes[classNum].grade ? `<span class=\"percentage\">${dtps.classes[classNum].grade}%</span>` : ``}\n                    <div class=\"letter\">${dtps.classes[classNum].letter || ``}</div>\n                </div>\n            </h3>\n\n            ${zeros ? /*html*/`\n                <h5 style=\"color: #d63d3d;\" class=\"gradeStat\">\n                    Zeros\n                    <div style=\"color: #d63d3d;\" class=\"numFont\">${zeros}</div>\n                </h5>\n            ` : ``}\n\n            <div style=\"${dtps.gradebookExpanded ? \"\" : \"display: none;\"}\" id=\"classGradeMore\">\n                <br />\n\n                ${dtps.classes[classNum].previousLetter ? /*html*/`\n                    <h5 class=\"smallStat\">\n                        Previous Grade\n                        <div class=\"numFont\">${dtps.classes[classNum].previousLetter}</div>\n                    </h5>\n                ` : ``}\n\n                <h5 class=\"smallStat\">\n                    Points\n                    <div class=\"numFont fraction\">\n                        <span class=\"earned\">${earnedPoints}</span>\n                        <span class=\"total\">/${totalPoints}</span>\n                    </div>\n                </h5>\n\n                <h5 class=\"smallStat\">\n                    Graded Assignments\n                    <div class=\"numFont\">${gradedAssignments}</div>\n                </h5>\n            </div>\n\n            <br />\n            <a onclick=\"$('#classGradeMore').toggle(); if ($('#classGradeMore').is(':visible')) {$(this).html('Show less'); dtps.gradebookExpanded = true;} else {$(this).html('Show more'); dtps.gradebookExpanded = false;}\"\n                style=\"color: var(--secText, gray); cursor: pointer; margin-right: 10px;\">${dtps.gradebookExpanded ? \"Show less\" : \"Show more\"}</a>\n        </div>\n\n        <br />\n    `;\n\n\n    //Render HTML\n    if ((dtps.selectedClass == classNum) && (dtps.selectedContent == \"grades\")) {\n        $(\".classContent\").html(gradeCalcSummary + assignmentHTML);\n    }\n}\n\n//Fluid UI screen definitions\nfluid.externalScreens.dashboard = () => {\n    dtps.masterStream();\n}\n\nfluid.externalScreens.stream = (courseID) => {\n    dtps.classStream(courseID);\n}\n\nfluid.externalScreens.moduleStream = (courseID) => {\n    dtps.moduleStream(courseID);\n}\n\nfluid.externalScreens.gradebook = (courseID) => {\n    dtps.gradebook(courseID);\n}\n\n//Type definitions\n\n/**\n* @typedef {Object} Assignment\n* @description Defines assignments objects in DTPS\n* @property {string} title Title of the assignment\n* @property {string} [body] HTML of the assignment's body\n* @property {string} id Assignment ID\n* @property {Date} [dueAt] Assignment due date\n* @property {string} [url] Assignment URL\n* @property {AssignmentFeedback[]} [feedback] Feedback / private comments for this assignment\n* @property {User} [grader] Assignment grader\n* @property {boolean} [turnedIn] True if the assignment is turned in\n* @property {boolean} [late] True if the assignment is late\n* @property {boolean} [missing] True if the assignment is missing\n* @property {boolean} [locked] True if assignment submissions are locked\n* @property {string} [category] Assignment category\n* @property {Date} [publishedAt] Date for when the assignment was published\n* @property {Date} [gradedAt] Date for when the assignment was graded\n* @property {number} [grade] Points earned on this assignment\n* @property {string} [letter] Letter grade on this assignment\n* @property {number} [value] Total amount of points possible for this assignment\n* @property {RubricItem[]} [rubric] Assignment rubric\n*/\n\n/**\n* @typedef {Object} Module\n* @description Defines module objects in DTPS\n* @property {string} title Title of the module\n* @property {string} id Module ID\n* @property {boolean} [collapsed] True if the module is collapsed, false otherwise. undefined or null if this module does not support collapsing.\n* @property {ModuleItem[]} items An array of items for this module.\n*/\n\n/**\n * @typedef {Object} ModuleItem\n * @description Defines module items in DTPS\n * @property {string} type Either \"assignment\", \"page\", \"discussion\", \"url\", \"embed\", or \"header\".\n * @property {string} [title] Required for URL and header items, and can be used to override the title of assignment, page, and discussion items.\n * @property {string} [id] Required for assignment, page, and discussion items.\n * @property {string} [url] Required for URL and embed items. Required for discussion and page items if the class does not support the pages or discussions feature.\n * @property {number} [indent] Indent level\n * @property {boolean} [completed] True if the module item has been completed\n */\n\n/**\n* @typedef {Object} Announcement\n* @description Defines announcement objects in DTPS\n* @property {string} title Title of the announcement\n* @property {Date} postedAt Date when the announcement was posted\n* @property {string} body Announcement content\n*/\n\n/**\n* @typedef {Object} AssignmentFeedback\n* @description Defines assignment feedback objects in DTPS\n* @property {string} comment Feedback comment\n* @property {User} [author] Feedback author\n*/\n\n/**\n* @typedef {Object} RubricItem\n* @description Defines rubric item objects in DTPS\n* @property {string} title Title of the rubric item\n* @property {string} id Rubric item ID (only needs to be unique to this assignment)\n* @property {number} value Total amount of points possible\n* @property {string} [outcome] The ID of the outcome this rubric item is assessing. This is only used for grade calculation.\n* @property {string} [description] Rubric item description\n* @property {number} [score] Rubric assessment score in points\n* @property {string} [scoreName] Rubric assessment score name\n* @property {string} [color] Score color in a CSS color format\n*/\n\n/**\n * @typedef {Object} DashboardItem\n * @description Defines dashboard items in DTPS\n * @property {string} name Dashbord item name\n * @property {string} id Unique dashboard item ID\n * @property {string} icon Dashboard item icon\n * @property {boolean} supportsCompactMode True if this dashboard item supports compact mode\n * @property {number} size The approximate size of this dashboard item relative to other dashboard items. Should be no less than 20.\n * @property {string} defaultSide The default side of this dashboard item. Either \"right\" or \"left\".\n * @property {boolean} compact True if the user has turned on compact mode for this item.\n */"]}