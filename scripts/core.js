/**
 * @file DTPS Core functions and module loader
 * @author jottocraft
 * @version v3.1.0
 * 
 * @copyright Copyright (c) 2018-2021 jottocraft. All rights reserved.
 * @license GPL-2.0-only
 */
if(void 0!==dtps)throw"Error: DTPS is already loading";var dtps={ver:310,readableVer:"v3.1.0",env:"localhost"==new URL(window.dtpsBaseURL||"https://powerplus.app").hostname?"dev":window.jottocraftSatEnv||"prod",classes:[],baseURL:window.dtpsBaseURL||"https://powerplus.app",unstable:"https://powerplus.app"!==window.dtpsBaseURL,gradebookExpanded:!1,updates:[],dashboardItems:[{name:"Calendar",id:"dtps.calendar",icon:"event",size:100,defaultSide:"left"},{name:"Updates",id:"dtps.updates",icon:"calendar_view_day",size:170,defaultSide:"left"},{name:"Due Today",id:"dtps.dueToday",icon:"check_circle_outline",size:20,defaultSide:"right"},{name:"Upcoming Assignments",id:"dtps.upcoming",icon:"view_stream",size:250,defaultSide:"right"}],remoteConfig:{showBugReportButton:!1,gradeCalculationEnabled:!0,allowWhatIfGrades:!0,showVideoMeetingButton:!0,dtechHomepageFluidUITabs:!0,dtechCurrentTerm:"20-21",debugClassID:"1098",topSneaky:!1,topSneakyUI:!1,useV5ThemeSelectionUI:!1,remoteUpdate:{title:null,md:null,active:!1}}};jQuery.getScript("https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"),dtps.class=function(){return dtps.classes[dtps.selectedClass]},dtps.changelog=function(e){jQuery.getScript("https://cdnjs.cloudflare.com/ajax/libs/showdown/1.8.6/showdown.min.js",(function(){markdown=new showdown.Converter,jQuery.getJSON("https://api.github.com/repos/jottocraft/dtps/releases/latest",(function(s){var t=markdown.makeHtml(s.body);jQuery(".card.changelog").html('<i onclick="fluid.cards.close(\'.card.changelog\')" class="fluid-icon close">close</i>'+t),e?Number(s.tag_name.replace(/[^0-9]/g,""))>Number(window.localStorage.dtps)&&(localStorage.setItem("dtps",s.tag_name.replace(/[^0-9]/g,"")),s.tag_name.includes("s")||(fluid.cards.close(".card.focus"),fluid.cards(".card.changelog"))):(fluid.cards.close(".card.focus"),fluid.cards(".card.changelog"))}))}))},dtps.log=function(e){"dev"==dtps.env&&console.log("[DTPS]",e)},dtps.error=function(e,s,t){if(null!==t){var a="";s&&(a='<div style="font-size: 12px; color: var(--secText, gray); margin-top: 10px;">'+s+"</div>"),console.error("[DTPS !!ERROR!!]",s+": ",t),fluid.alert("Error",e+a,"error")}},dtps.firstrun=function(){window.localStorage.setItem("dtps",dtps.ver),jQuery(".card.changelog").html(`\n        <h3 style="margin-bottom: 0px;">Welcome to Power+</h3>\n        <h5 style="color: var(--secText); font-weight: bold; font-size: 22px;">${dtps.readableVer}</h5>\n\n        <div class="welcomeSection">\n            <i class="fluid-icon">dashboard</i>\n            <h5>${dtpsLMS.gradebook?"Manage your coursework and grades":"Manage your coursework"}</h5>\n            <p>Power+ organizes all of your coursework so you can easily see what you need to do next. The dashboard shows upcoming assignments, recent grades, and announcements.\n            ${dtpsLMS.gradebook?`Power+ includes a gradebook designed for ${dtpsLMS.name} to help you understand your grades.`:""}</p>\n        </div>\n\n        ${dtpsLMS.isDemoLMS?'\n            <div class="welcomeSection">\n                <i class="fluid-icon">priority_high</i>\n                <h5>This is a demo</h5>\n                <p>Assignment information, grades, and other content displayed is not real and is for demonstration purposes only. This demo does not retrieve or collect any data.</p>\n            </div>\n        ':`\n            <div class="welcomeSection">\n                <i class="fluid-icon">security</i>\n                <h5>Privacy</h5>\n                <p>Power+ does not collect any information. All of the data used in Power+ is fetched directly from ${dtpsLMS.shortName} and is never sent anywhere else. \n                 User preferences, grade history, and other Power+ data is stored locally on your computer and is not associated with your ${dtpsLMS.shortName} account.</p>\n            </div>\n            <div class="welcomeSection">\n                <i class="fluid-icon">priority_high</i>\n                <h5>Power+ is not official</h5>\n                <p>Assignment information, grades, and other content displayed in Power+ are not official. Power+ is neither created nor endorsed by ${dtpsLMS.legalName}.\n                 Power+ may have bugs that could cause it to display inaccurate information. Use Power+ at your own risk.</p>\n            </div>\n        `}\n        \n        <br />\n        <button onclick="window.localStorage.setItem('dtpsInstalled', 'true'); fluid.cards.close('.card.changelog');" class="btn">\n            <i class="fluid-icon">arrow_forward</i> Continue\n        </button>\n    `),fluid.cards.close(".card.focus"),fluid.cards(".card.changelog","stayOpen")},dtps.renderLoadingScreen=function(){window.dtpsPreLoader&&!dtps.user||jQuery("body").append('\n            <div id="dtpsNativeOverlay" style="background-color: #151515; position: fixed; top: 0px; left: 0px; width: 100%; height: 100vh; z-index: 99;text-align: center;z-index: 999;transition: opacity 0.2s;">\n                <img style="height: 100px; margin-top: 132px;" src="https://i.imgur.com/7dDUVh2.png" />\n\t\t\t    <br />\n                <div class="progress"><div class="indeterminate"></div></div>\n                <style>body {background-color: #151515; overflow: hidden;}*,:after,:before{box-sizing:border-box}.progress{position:relative;width:600px;height:5px;overflow:hidden;border-radius:12px;background:#262626;backdrop-filter:opacity(.4);display:inline-block;margin-top:75px}.progress .indeterminate{position:absolute;background:#e3ba4b;height:5px;animation:indeterminate 1.4s infinite;animation-timing-function:linear}@keyframes indeterminate{0%{width:5%;left:-15%}to{width:100%;left:110%}}</style>\n            </div>\n        ')},dtps.JS=function(e){jQuery.getScript("https://cdn.jsdelivr.net/npm/fullcalendar@5.3.2/main.min.js",(function(){jQuery.getScript("https://cdn.jsdelivr.net/npm/fullcalendar@5.3.2/locales-all.min.js")})),jQuery.getScript("https://unpkg.com/lunr@2.3.9/lunr.min.js"),jQuery.getScript("https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js"),jQuery.getScript("https://cdn.jottocraft.com/tinycolor.js"),jQuery.getScript("https://cdn.jottocraft.com/nearest-color.dtao.js",(()=>{"true"==window.localStorage.getItem("pref-debuggingLocalFluidUI")?jQuery.getScript("http://localhost:1222/dev/fluid.js",e):jQuery.getScript("https://cdn.jottocraft.com/fluid/build/v5/latest/fluid.js",e)}))},dtps.CSS=function(){jQuery("<link/>",{rel:"stylesheet",type:"text/css",href:"true"==window.localStorage.getItem("pref-debuggingLocalFluidUI")?"http://localhost:1222/dev/fluid.css":"https://cdn.jottocraft.com/fluid/build/v5/latest/fluid.css",class:"dtpsHeadItem"}).appendTo("head"),jQuery("<link/>",{rel:"stylesheet",type:"text/css",href:dtps.baseURL+"/dtps.css",class:"dtpsHeadItem"}).appendTo("head"),jQuery("<link/>",{rel:"stylesheet",type:"text/css",href:"https://fonts.googleapis.com/css?family=Material+Icons+Round",class:"dtpsHeadItem"}).appendTo("head"),jQuery("<link/>",{rel:"stylesheet",type:"text/css",href:"https://cdn.jsdelivr.net/npm/fullcalendar@5.3.2/main.min.css",class:"dtpsHeadItem"}).appendTo("head"),jQuery("<link/>",{rel:"stylesheet",type:"text/css",href:"https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css",class:"dtpsHeadItem"}).appendTo("head")},dtps.init=function(){if(dtps.log("Starting DTPS "+dtps.readableVer+"..."),!window.dtpsLMS)throw"Error: No DTPS LMS configuration found";Number(window.localStorage.dtps)<dtps.ver&&(dtps.log("New release"),dtps.popup="changelog"),"true"!==window.localStorage.dtpsInstalled&&(dtps.popup="firstrun"),dtps.renderLoadingScreen();var e=new URLSearchParams(window.location.search);Array.from(e).length&&window.history.replaceState(null,null,window.location.pathname),window.fluidConfig={config:{autoLoad:!1,allowThemeMenu:!1}},window.localStorage.setItem("jottocraftEnv",!0),dtps.selectedContent="stream",dtps.CSS(),dtps.render(),new Promise((e=>{jQuery.getJSON("https://project-dtps.firebaseio.com/config.json",(s=>{s&&Object.keys(s).forEach((e=>{var t=s[e];dtps.remoteConfig[e]=t})),e()})).fail((()=>e()))})).then((()=>("dev"==dtps.env&&Object.keys(dtps.remoteConfig).forEach((e=>{window.localStorage.getItem("dtpsRemoteConfig-"+e)&&(val=window.localStorage.getItem("dtpsRemoteConfig-"+e),"true"==val&&(val=!0),"false"==val&&(val=!1),dtps.remoteConfig[e]=val)})),dtpsLMS.fetchUser()))).then((e=>(dtps.user=e,dtps.user.children&&dtps.user.children.length?(dtps.user.parent=!0,new Promise(((e,s)=>{var t=[],a=[];dtps.user.children.forEach((e=>{a.push(new Promise((function(s,a){dtpsLMS.fetchClasses(e.id).then((a=>{a.forEach((s=>{s.id=e.id+"-"+s.id,s.group=e.name})),t=t.concat(a),s()})).catch(a)})))})),Promise.all(a).then((()=>{e(t)}))}))):dtpsLMS.fetchClasses(dtps.user.id)))).then((e=>new Promise(((s,t)=>{dtpsLMS.institutionSpecific&&dtpsLMS.updateClasses?dtpsLMS.updateClasses(e).then((e=>{s(e)})).catch((e=>{t(e)})):s(e)})))).then((s=>{dtps.classes=s,dtps.classes.forEach(((e,s)=>e.num=s)),dtps.JS((()=>{var s=nearestColor.from({red:"#cc4747",brown:"#9a4429",orange:"#ce734e",pumpkin:"#c58535",yellow:"#b58f38",yellowGreen:"#7c9630",green:"#439a47",oceanGreen:"#339a70",keppel:"#40b5c3",skyBlue:"#40a4d6",blue:"#2d72a0",purple:"#985cab",magenta:"#bd3e69",pink:"#ec7ca5",gray:"#888888",gold:"#94652a",darkRed:"#943f3f",darkBlue:"#485182",darkPurple:"#6f4882",darkGreen:"#3d7358",lightOrange:"#ea7a44",lightRed:"#e07f7f",lightBlue:"#76c1e6",lightPurple:"#978fd6",lightGreen:"#7ebb95",lightBrown:"#928871"});dtps.classes.forEach((e=>{e.color=e.color?s(e.color).value:"gray",dtpsLMS.calculateGrade&&dtps.remoteConfig.gradeCalculationEnabled&&(e.letter="...",e.grade=void 0)})),fluid.defaultScreen="dashboard",fluid.screens.dashboard=dtps.baseURL+"/scripts/assignments.js",fluid.screens.stream=dtps.baseURL+"/scripts/assignments.js",fluid.screens.moduleStream=dtps.baseURL+"/scripts/assignments.js",fluid.screens.people=dtps.baseURL+"/scripts/people.js",fluid.screens.search=dtps.baseURL+"/scripts/search.js",fluid.screens.pages=dtps.baseURL+"/scripts/pages-discussions.js",fluid.screens.discussions=dtps.baseURL+"/scripts/pages-discussions.js",!dtpsLMS.gradebook||"dev"==dtps.env&&"true"==fluid.get("pref-debuggingGenericGradebook")?(dtpsLMS.genericGradebook||"dev"==dtps.env&&"true"==fluid.get("pref-debuggingGenericGradebook"))&&(fluid.screens.gradebook=dtps.baseURL+"/scripts/assignments.js"):fluid.screens.gradebook=dtps.showLMSGradebook;var t=[];dtps.classes.forEach(((e,s)=>{dtpsLMS.fetchAssignments(e.userID,e.lmsID).then((e=>new Promise(((s,t)=>{dtpsLMS.institutionSpecific&&dtpsLMS.updateAssignments?dtpsLMS.updateAssignments(e).then((e=>{s(e)})).catch(t):s(e)})))).then((t=>{if(e.assignments=t,e.assignments.forEach((t=>{t.class=s,t.gradedAt&&t.grade&&dtps.updates.push({class:e.num,type:"assignment",...t})})),dtps.updates.sort((function(e,s){return new Date(s.gradedAt||s.postedAt).getTime()-new Date(e.gradedAt||e.postedAt).getTime()})),dtps.updates.length>15&&(dtps.updates.length=15),dtpsLMS.calculateGrade&&dtps.remoteConfig.gradeCalculationEnabled){let s=dtpsLMS.calculateGrade(e,t);s?(e.letter=s.letter,e.grade=s.grade,e.gradeCalculation=s):(e.letter=null,e.grade=null),"pages"!==dtps.selectedContent&&"discuss"!==dtps.selectedContent&&dtps.showClasses(!0)}e.letter&&"..."!==e.letter?(e.hasGradebook=!0,dtps.logGrades(s),s==dtps.selectedClass&&(dtps.presentClass(s),"grades"==dtps.selectedContent&&fluid.screen("gradebook",dtps.classes[s].id))):s==dtps.selectedClass&&"grades"==dtps.selectedContent&&fluid.screen("stream",dtps.classes[s].id),dtps.remoteConfig.showGradesInSettings&&dtps.renderGradesInSettings(),("dash"==dtps.selectedClass||"stream"==dtps.selectedContent&&dtps.selectedClass==e.num)&&fluid.screen()})),t.includes(e.lmsID)||(t.push(e.lmsID),dtpsLMS.fetchAnnouncements(e.lmsID).then((s=>{s.forEach((s=>{dtps.updates.push({class:e.num,type:"announcement",...s})})),dtps.updates.sort((function(e,s){return new Date(s.gradedAt||s.postedAt).getTime()-new Date(e.gradedAt||e.postedAt).getTime()})),dtps.updates.length>15&&(dtps.updates.length=15),"dash"==dtps.selectedClass&&fluid.screen()})))})),dtps.renderLite(),fluid.screen(),"firstrun"==dtps.popup?dtps.firstrun():"changelog"==dtps.popup&&dtps.changelog(!0),"canary"==e.get("prerelease")&&e.get("repo")&&fluid.alert("Power+ Canary","<p>Do you want to add this release configuration to Power+?</p>","build_circle",[{name:"Add",icon:"add",action:"window.localStorage.githubCanary = '"+e.get("repo")+"'; alert('Please reload the page for changes to take effect');"},{name:"Cancel",icon:"cancel"}])}))})).catch((function(e){console.error("[DTPS] Error fetching user and classes at dtps.init",e),"login"==e.action&&e.redirectURL?window.location.href=e.redirectURL:dtps.error("Failed to get user and/or course data","Exception in promise @ dtps.init")})),dtps.loadDashboardPrefs()},dtps.formatDate=function(e){return e?new Date(e).toLocaleString("en",{weekday:"short",month:"short",day:"numeric",hour:"numeric",minute:"numeric"}):""},dtps.iframeLoad=function(e){var s=document.getElementById(e);s&&(s.height="",s.height=s.contentWindow.document.body.scrollHeight+"px")},dtps.clearData=function(){window.confirm("Clearing Power+ data will clear all local user data stored by Power+. This should be done if it is a new semester / school year or if you are having issues with Power+. Are you sure you want to clear all your Power+ data?")&&(window.localStorage.clear(),window.alert("Power+ data cleared"))},dtps.showClasses=function(e){dtps.classlist=[];for(var s=null,t=0;t<dtps.classes.length;t++){var a="";dtps.classes[t].letter&&(a=dtps.classes[t].letter),null==dtps.classes[t].letter&&(a="--"),"..."==dtps.classes[t].letter&&(a='<div class="shimmer" style="width: 100%;height: 22px;border-radius: 8px;"></div>'),dtps.classes[t].group&&dtps.classes[t].group!==s?(s&&dtps.classlist.push("</div></div>"),dtps.classlist.push(`\n                <div id="dtpsClassListGroup-${dtps.classes[t].group}" class="group open">\n                  <div class="name item">\n                    <i class="fluid-icon"></i> <span class="label">${dtps.classes[t].group}</span>\n                  </div>\n\n                  <div class="items">\n            `)):!dtps.classes[t].group&&s&&dtps.classlist.push("</div></div>"),dtps.classlist.push(`\n            <div \n                onclick="${"dtps.selectedClass = "+t}" \n                class="${"class item "+t+" "+(dtps.selectedClass==t?" active":"")}"\n                style="${"--classColor: "+dtps.classes[t].color}"\n            >\n                <i class="fluid-icon grade">${a}</i>\n                <span class="label">${dtps.classes[t].subject}</span>\n            </div>\n        `),s=dtps.classes[t].group}s&&dtps.classlist.push("</div></div>"),jQuery(".sidebar .class.dash")[0]&&!e||(jQuery(".sidebar").html(`\n            <div class="title">\n                <img src="${dtps.baseURL+"/icon.svg"}" />\n                <h4>Power+</h4>\n            </div>\n            \n            <div class="items">\n                <div onclick="dtps.selectedClass = 'dash';" class="class item main dash ${"dash"==dtps.selectedClass?"active":""}">\n                    <i class="fluid-icon">dashboard</i>    \n                    <span class="label">Dashboard</span>\n                </div>\n\n                <div class="divider"></div>\n\n                ${dtps.classlist.join("")}\n            </div>\n\n            <div class="collapse">\n                <i class="fluid-icon"></i>\n            </div>\n        `),fluid.init(),"pages"!=dtps.selectedContent&&"discuss"!=dtps.selectedContent||dtps.classes[dtps.selectedClass]&&fluid.screen("stream",dtps.classes[dtps.selectedClass].id),$(".class:not(.overrideClass)").click((function(e){"stream"!=dtps.selectedContent&&"moduleStream"!=dtps.selectedContent||!dtps.classes[dtps.selectedClass]||(dtps.classes[dtps.selectedClass].modules&&"moduleStream"==window.localStorage.getItem("courseworkPref-"+dtps.classes[dtps.selectedClass].id)?fluid.screen("moduleStream",dtps.classes[dtps.selectedClass].id):fluid.screen("stream",dtps.classes[dtps.selectedClass].id)),"people"==dtps.selectedContent&&dtps.classes[dtps.selectedClass]&&fluid.screen("people",dtps.classes[dtps.selectedClass].id),"grades"==dtps.selectedContent&&dtps.classes[dtps.selectedClass]&&(dtps.classes[dtps.selectedClass].hasGradebook?fluid.screen("gradebook",dtps.classes[dtps.selectedClass].id):fluid.screen("stream",dtps.classes[dtps.selectedClass].id)),"dash"==dtps.selectedClass&&fluid.screen("dashboard")})))},dtps.presentClass=function(e){dtps.selectedClass=e,dtps.classes[e]?document.title=dtps.classes[e].subject+" | Power+":document.title="Power+","false"!==fluid.get("pref-showClassImages")&&dtps.classes[e]&&dtps.classes[e].image?($(".headerArea").addClass("classImage"),$(".headerArea img").attr("src",dtps.classes[e].image),$(".headerArea img").show()):($(".headerArea").removeClass("classImage"),$(".headerArea img").hide()),$(".sidebar .class").removeClass("active"),$(".class."+e).addClass("active"),$("#headText span").text("dash"==e?"Dashboard":"search"==e?"Search Results":dtps.classes[e]&&dtps.classes[e].subject);var s="dash"==e?"dashboard":"search"==e?"search":dtps.classes[e]&&dtps.classes[e].icon;s?($("#headText i").text(s),$("#headText i").show()):$("#headText i").hide(),$("#headText").css("color","dash"==e||"search"==e?"var(--text)":dtps.classes[e]&&dtps.classes[e].color),dtps.classes[e]?$("#dtpsTabBar").show():($("#dtpsTabBar").hide(),$("#classInfo p").hide()),"search"!==e&&$(".headerArea .contentLabel").hide(),"search"===e||$("#dtpsMainSearchBox").is(":focus")||$("#dtpsMainSearchBox").val(""),dtps.setSearchBox(),dtps.classes[e]&&(dtps.classes[e].pages?$(".btns .btn.pages").show():$(".btns .btn.pages").hide(),dtps.classes[e].people?$(".btns .btn.people").show():$(".btns .btn.people").hide(),dtps.classes[e].discussions?$(".btns .btn.discuss").show():$(".btns .btn.discuss").hide(),(dtpsLMS.genericGradebook||dtpsLMS.gradebook)&&dtps.classes[e].hasGradebook?$(".btns .btn.grades").show():$(".btns .btn.grades").hide(),$("#dtpsTabBar .btn:visible").length<2&&$("#dtpsTabBar").hide(),dtps.classes[e].teacher?($("#classInfo .teacher .teacherName").text(dtps.classes[e].teacher.name),$("#classInfo .teacher .teacherImage").css("background-image","url('"+dtps.classes[e].teacher.photoURL+"')"),$("#classInfo .teacher").show()):$("#classInfo .teacher").hide(),dtps.classes[e].homepage?$("#classInfo .homepage").show():$("#classInfo .homepage").hide(),dtps.classes[e].videoMeetingURL?($("#classInfo .videoMeeting").attr("onclick","window.open('"+dtps.classes[e].videoMeetingURL+"')"),$("#classInfo .videoMeeting").removeClass("shimmerParent"),$("#classInfo .videoMeeting").show()):null!==dtps.classes[e].videoMeetingURL&&dtpsLMS.fetchMeetingURL?($("#classInfo .videoMeeting").attr("onclick",""),$("#classInfo .videoMeeting").addClass("shimmerParent"),$("#classInfo .videoMeeting").show(),dtpsLMS.fetchMeetingURL(dtps.classes[e].lmsID).then((s=>{dtps.classes[e].videoMeetingURL=s,dtps.selectedClass==e&&(s?($("#classInfo .videoMeeting").attr("onclick","window.open('"+dtps.classes[e].videoMeetingURL+"')"),$("#classInfo .videoMeeting").removeClass("shimmerParent"),$("#classInfo .videoMeeting").show()):$("#classInfo .videoMeeting").hide())}))):$("#classInfo .videoMeeting").hide()),console.log(dtps.selectedContent),"grades"!==dtps.selectedContent&&$(".classContent").removeClass("fixedGradeSummary")},dtps.classHome=function(e){$(".card.details").html(`\n        <i onclick="fluid.cards.close('.card.details')" class="fluid-icon close">close</i>\n        <h3 style="font-weight: bold;">${dtps.classes[e].subject} Homepage</h3>\n\n        <br />\n        <p>Loading...</p>\n    `),dtpsLMS.fetchHomepage(dtps.classes[e].lmsID).then((s=>{if(s){var t=getComputedStyle($(".card.details")[0]).getPropertyValue("--cards"),a=getComputedStyle($(".card.details")[0]).getPropertyValue("--text");if($("body").hasClass("dark")&&(s=dtps.brightenTextForDarkMode(s,t)),dtpsLMS.dtech&&dtps.remoteConfig.dtechHomepageFluidUITabs&&$("<div></div>").append(s).find(".enhanceable_content.tabs>ul>li").toArray().length>1){var n=[];$("<div></div>").append(s).find(".enhanceable_content.tabs>ul>li").toArray().forEach((e=>{var d=$(e).text().toLowerCase();if(d){var i=$(e).find("a").attr("href").replace("#","");if(i){var o=$(s).find("#"+i).html();if(o){var l=null;d.includes("agenda")&&(l="format_list_numbered",d="Agenda"),d.includes("instructor")&&(l="person",d="Instructor"),d.includes("course info")&&(l="info",d="Course Info"),d.includes("resources")&&(l="article",d="Course Resources");var r=new Blob([`\n                        <base target="_blank" /> \n                        <link type="text/css" rel="stylesheet" href="https://cdn.jottocraft.com/CanvasCSS.css" media="screen,projection"/>\n                        <style>body {background-color: ${t}; color: ${a};</style>\n                        ${o}\n                    `],{type:"text/html"}),c=window.URL.createObjectURL(r);n.push({text:d,id:i,icon:l,frameURL:c})}}}})),$(".card.details").html(`\n                    <i onclick="fluid.cards.close('.card.details')" class="fluid-icon close">close</i>\n\n                    <h4 style="font-weight: bold;">${dtps.classes[e].subject} Homepage</h4>\n\n                    <br />\n                    ${dtps.classes[e].videoMeetingURL?`<button onclick="window.open('${dtps.classes[e].videoMeetingURL}')" class="btn small"><i class="fluid-icon">videocam</i> Zoom</button>`:""}\n                    <div class="btns row small">\n                        ${n.map(((e,s)=>`<button onclick="$(this).addClass('active');$(this).siblings().removeClass('active');$('#homepageFragment').attr('src', '${e.frameURL}'); dtps.iframeLoad('homepageFragment');" \n                                style="text-transform: capitalize;" class="btn ${0==s?"active":""}">${e.icon?`<i class="fluid-icon">${e.icon}</i> `:""}${e.text}</button>`)).join("")}\n                    </div>\n\n                    <br />\n                    <div style="margin-top: 20px;" class="homepageBody">\n                        <iframe id="homepageFragment" onload="dtps.iframeLoad('homepageFragment')" style="margin: 10px 0px; width: 100%; border: none; outline: none;" src="${n[0].frameURL}" />\n                    </div>\n                `)}else{var d=new Blob([`\n                    <base target="_blank" /> \n                    <link type="text/css" rel="stylesheet" href="https://cdn.jottocraft.com/CanvasCSS.css" media="screen,projection"/>\n                    <style>body {background-color: ${t}; color: ${a};</style>\n                    ${s}\n                `],{type:"text/html"}),i=window.URL.createObjectURL(d);$(".card.details").html(`\n                    <i onclick="fluid.cards.close('.card.details')" class="fluid-icon close">close</i>\n\n                    <h4 style="font-weight: bold;">${dtps.classes[e].subject} Homepage</h4>\n\n                    <br />\n                    <div style="margin-top: 20px;" class="homepageBody">\n                        <iframe id="homepageIframe" onload="dtps.iframeLoad('homepageIframe')" style="margin: 10px 0px; width: 100%; border: none; outline: none;" src="${i}" />\n                    </div>\n                `)}fluid.cards(".card.details")}else fluid.cards.close(".card.details"),dtps.error("Homepage unavailable","homepage is either empty or undefined @ dtps.classHome")})).catch((e=>{dtps.error("Couldn't load homepage","Caught a promise rejection @ dtps.classHome",e)}))},dtps.showLMSGradebook=function(e){var s=dtps.classes.map((e=>e.id)).indexOf(e);function t(){dtpsLMS.gradebook(dtps.classes[s]).then((e=>{e&&dtps.selectedClass==s&&"grades"==dtps.selectedContent&&($(".classContent").html(e),dtpsLMS.gradebookDidRender&&dtpsLMS.gradebookDidRender(dtps.classes[s]))})).catch((function(e){dtps.error("Could not load the gradebook","Caught promise rejection @ dtps.showLMSGradebook",e)}))}dtps.selectedClass=s,dtps.selectedContent="grades",$("#dtpsTabBar .btn").removeClass("active"),$("#dtpsTabBar .btn.grades").addClass("active"),dtps.presentClass(s),dtps.showClasses(),-1==s&&dtps.error("The selected class doesn't exist","classNum check failed @ dtps.showLMSGradebook"),"grades"==dtps.selectedContent&&dtps.selectedClass==s&&jQuery(".classContent").html('<div class="spinner"></div>'),fluid.externalScreens.stream?t():jQuery.getScript(dtps.baseURL+"/scripts/assignments.js",(()=>{t()}))},dtps.showIFrameCard=function(e){$("#CardIFrame").attr("src",""),fluid.cards(".card.iFrameCard"),$("#CardIFrame").attr("src",e)},dtps.brightenTextForDarkMode=function(e,s){s||(s="black");var t=$("<div></div>").append(e);return t.find("span").filter((function(){return $(this).css("color")&&!($(this).css("background-color")||$(this).css("background"))&&!$(this).parents().filter((function(){return $(this).css("background-color")||$(this).css("background")})).length})).toArray().forEach((e=>{var t=tinycolor($(e).css("color")).getBrightness()/255*100,a=100-tinycolor(s).getBrightness()/255*100-t-t;a>0?$(e).css("color","#"+tinycolor($(e).css("color")).brighten(Math.abs(a)).toHex()):$(e).css("color","#"+tinycolor($(e).css("color")).darken(Math.abs(a)).toHex())})),t.html()},dtps.logGrades=function(e){if(window.localStorage.getItem("gradeHistory-"+dtps.classes[e].id)){var s=window.localStorage.getItem("gradeHistory-"+dtps.classes[e].id).split("|")[0],t=window.localStorage.getItem("gradeHistory-"+dtps.classes[e].id).split("|")[1];s!==dtps.classes[e].letter&&(window.localStorage.setItem("gradeHistory-"+dtps.classes[e].id,dtps.classes[e].letter+"|"+s),dtps.classes[e].previousLetter=s),s==dtps.classes[e].letter&&t&&(dtps.classes[e].previousLetter=t)}else window.localStorage.setItem("gradeHistory-"+dtps.classes[e].id,dtps.classes[e].letter)},dtps.settings=function(e){if(e||"true"!==$("#leftDashboardColumn").attr("loaded")){function s(e){return e.map((e=>`\n                <div dashboardItem-id="${e.id}" style="height: ${1.7*e.size+50}px" class="dashboardItem">\n                    <h5>\n                        <i class="fluid-icon">${e.icon}</i>\n                        <span>${e.name}</span>\n                    </h5>\n                </div>\n            `)).join("")}$("#leftDashboardColumn").html(s(dtps.leftDashboard)),$("#rightDashboardColumn").html(s(dtps.rightDashboard)),$(".dashboardColumn").sortable({connectWith:".dashboardColumn",update:function(e,s){dtps.saveDashboardPrefs()}}),$("#leftDashboardColumn").attr("loaded","true")}dtps.remoteConfig.showGradesInSettings&&dtps.renderGradesInSettings(),fluid.cards(".settingsCard")},dtps.settingsReloadWarning=function(){$("#settingsReloadWarning").show()},dtps.renderGradesInSettings=function(){$("#classGradeBars").html(dtps.classes.map((e=>{var s=0;return"A"==e.letter&&(s=100),"A-"==e.letter&&(s=91),"B+"==e.letter&&(s=88),"B"==e.letter&&(s=85),"B-"==e.letter&&(s=81),"C+"==e.letter&&(s=78),"C"==e.letter&&(s=75),e.letter?`<div style="cursor: auto; background-color: var(--elements);" class="progressBar big">\n        <div style="color: white;" class="progressLabel">${e.subject} (${e.letter})</div>\n        <div class="progress" style="background-color: ${e.color}; width: calc(${s}% - 300px);"></div></div>`:""})));var e=0,s=0;dtps.classes.forEach((t=>{if("..."==t.letter)e=null;else if(t.letter&&null!==e){var a=0;"A"==t.letter&&(a=4),"A-"==t.letter&&(a=3.7),"B+"==t.letter&&(a=3.3),"B"==t.letter&&(a=3),"B-"==t.letter&&(a=2.7),"C+"==t.letter&&(a=2.3),"C"==t.letter&&(a=2),"I"==t.letter&&(a=0),e+=a,s++}})),null==e?$("#dtpsGpaText").text("..."):$("#dtpsGpaText").text((e/s).toFixed(1))},dtps.saveDashboardPrefs=function(){for(var e=[],s=0;s<$(".dashboardColumn").children().length;s++){var t=$($(".dashboardColumn").children()[s]);e.push({id:t.attr("dashboardItem-id"),side:t.parent().attr("id").includes("left")?"left":"right"})}window.localStorage.setItem("dtpsDashboardItems",JSON.stringify(e)),dtps.loadDashboardPrefs()},dtps.resetDashboardPrefs=function(){window.localStorage.removeItem("dtpsDashboardItems"),dtps.loadDashboardPrefs(),dtps.settings(!0)},dtps.classicEntry=function(){var e=["P","r","o","j","e","c","t"," ","D","T","P","S"],s=["P","o","w","e","r","+"];null==dtps.classicStep&&(dtps.classicStep=-10),dtps.classicStep++,12==dtps.classicStep&&(window.location.href="/power+?classicEdition=true");for(var t=0;t<dtps.classicStep;t++)s[t]=e[t];$("#dtpsAboutName").html(s.join(""))},dtps.loadDashboardPrefs=function(){if(dtps.leftDashboard=[],dtps.rightDashboard=[],window.localStorage.dtpsDashboardItems){var e=JSON.parse(window.localStorage.dtpsDashboardItems),s=dtps.dashboardItems.map((e=>e.id));e.forEach((e=>{if(s.includes(e.id)){var t=s.indexOf(e.id),a=dtps.dashboardItems[t];"left"==e.side?dtps.leftDashboard.push(a):"right"==e.side&&dtps.rightDashboard.push(a)}}))}else dtps.dashboardItems.forEach((e=>{"left"==e.defaultSide?dtps.leftDashboard.push(e):"right"==e.defaultSide&&dtps.rightDashboard.push(e)}))},dtps.render=function(){$("link:not(.dtpsHeadItem)").remove(),$("head *:not(.dtpsHeadItem)").remove(),$("body").attr("class","dark showThemeWindows hasSidebar hasNavbar dashboard"),document.title="Power+",jQuery("<link/>",{rel:"shortcut icon",type:"image/png",href:dtps.baseURL+"/favicon.png"}).appendTo("head"),jQuery("body *:not(#dtpsNativeOverlay):not(#dtpsNativeOverlay *)").remove(),jQuery("body").append(`\n        <div class="sidebar"></div>        \n\n        <div class="navbar">\n          <div class="logo">\n            <img src="${dtps.baseURL+"/icon.svg"}" />\n            <h4>${"https://dev.dtps.jottocraft.com"==dtps.baseURL?"Power+ (dev)":"Power+"}</h4>\n          </div>\n        \n          ${dtps.unstable?'\n            <div id="dtpsUnstable" class="navitem">\n              <i style="font-size: 16px;" class="fluid-icon">warning</i>\n              <span style="font-weight: bold; font-size: 10px;">THIS IS AN UNSTABLE VERSION OF POWER+. USE AT YOUR OWN RISK.</span>\n            </div>\n          ':""}\n          \n          <div class="items" id="dtpsFixedSearch">\n            <i class="inputIcon fluid-icon">search</i>\n            <input id="dtpsMainSearchBox" style="margin: 0px; width: 500px;" type="search" class="inputIcon filled" placeholder="Search" />\n          </div>\n\n          <div class="profile">\n            <div class="profileImage"></div>\n          </div>\n        </div>\n\n        <div class="card profileMenu">\n          <div class="person">\n            <div class="profileImage"></div>\n            <div class="info">\n              <h5 class="name">Logged out</h5>\n            </div>\n          </div>\n\n          <div class="actions">\n            \x3c!--<div class="item">\n              <i class="fluid-icon">feedback</i>\n              <span class="label">Feedback</span>\n            </div>--\x3e\n            \n            <div onclick="dtps.settings();" class="item">\n              <i class="fluid-icon">settings</i>\n              <span class="label">Settings</span>\n            </div>\n            <div class="divider"></div>\n            <a style="color: var(--text);" href="/">\n                <div class="item">\n                  <i class="fluid-icon">exit_to_app</i>\n                  <span class="label">Go to Canvas</span>\n                </div>\n            </a>\n          </div>\n        </div>\n\n        <div id="dtpsSearchResults" class="card acrylicMaterial" style="display: none;">\n            <h5 id="dtpsSearchStatus"><i class="fluid-icon">search</i> <span>Search</span></h5>\n            <div id="dtpsSearchData" style="display: none;"></div>\n            <div id="dtpsSearchInfo">\n                <p>By defualt, Power+ will search based on the page you're on. You can use the keywords below for more advanced searches:</p>\n                <div class="grid samesize">\n                    <div class="item">\n                        <p><i class="fluid-icon">library_books</i> type:coursework</p>\n                        <p><i class="fluid-icon">view_module</i> type:module</p>\n                        <p><i class="fluid-icon">assignment</i> type:assignment</p>\n                        <p><i class="fluid-icon">assessment</i> type:grade</p>\n                        <p><i class="fluid-icon">announcement</i> type:announcement</p>\n                    </div>\n                    <div class="item">\n                        <p><i class="fluid-icon">home</i> type:homepage</p>\n                        <p><i class="fluid-icon">insert_drive_file</i> type:page</p>\n                        <p><i class="fluid-icon">forum</i> type:discussion</p>\n                        <p><i class="fluid-icon">people</i> type:person</p>\n                        <div class="divider"></div>\n                        <p><i class="fluid-icon">class</i> class:English</p>\n                    </div>\n                </div>\n            </div>\n        </div>\n\n        <div class="headerArea classImage">\n          <img style="display: none;" />\n          <div class="content">\n            <h1 id="headText"><i class="fluid-icon">dashboard</i> <span>Dashboard</span></h1>\n            <div id="classInfo" style="min-height: 18px;">\n              <p class="teacher" style="display: none;">\n                <span class="teacherImage"></span> <span class="teacherName"></span>\n              </p>\n              <p onclick="dtps.classHome(dtps.selectedClass);" class="homepage" style="cursor: pointer; display: none;">\n                <i class="fluid-icon">home</i> <span>Homepage</span>\n              </p>\n              <p class="videoMeeting" style="cursor: pointer; display: none;">\n                <i class="fluid-icon">videocam</i> <span>Meeting</span>\n              </p>\n              <p class="contentLabel" style="display: none;">\n                <i class="fluid-icon"></i> <span></span>\n              </p>\n            </div>\n            <div style="display: none;" id="dtpsTabBar" class="btns">\n                <button init="true" onclick="if (dtps.classes[dtps.selectedClass].modules && (window.localStorage.getItem('courseworkPref-' + dtps.classes[dtps.selectedClass].id) == 'moduleStream')) { fluid.screen('moduleStream', dtps.classes[dtps.selectedClass].id); } else { fluid.screen('stream', dtps.classes[dtps.selectedClass].id); }" class="btn stream">\n                    <i class="fluid-icon">library_books</i>\n                    Coursework\n                </button>\n                <button init="true" onclick="fluid.screen('people', dtps.classes[dtps.selectedClass].id);" class="btn people">\n                    <i class="fluid-icon">people</i>\n                    People\n                </button>\n                <button init="true" onclick="fluid.screen('discussions', dtps.classes[dtps.selectedClass].id);" class="btn discuss">\n                    <i class="fluid-icon">forum</i>\n                    Discussions\n                </button>\n                <button init="true" onclick="fluid.screen('pages', dtps.classes[dtps.selectedClass].id);" class="btn pages">\n                    <i class="fluid-icon">insert_drive_file</i>\n                    Pages\n                </button>\n                <button init="true" onclick="fluid.screen('gradebook', dtps.classes[dtps.selectedClass].id);" class="btn grades">\n                    <i class="fluid-icon">assessment</i>\n                    ${dtpsLMS.gradebook?"Grades":"Gradebook"}\n                </button>\n            </div>\n          </div>\n        </div>\n\n        \x3c!-- Class content area --\x3e\n        <div class="classContent">\n            <div class="spinner"></div>\n        </div>\n\n        \x3c!-- Settings card (its inner HTML is added later) --\x3e\n        <div style="height: 100%; overflow: auto !important;" class="card withnav focus close container settingsCard"></div>\n\n        \x3c!-- Changelog card --\x3e\n        <div style="border-radius: 30px;" class="card focus changelog close container">\n            <i onclick="fluid.cards.close('.card.changelog')" class="fluid-icon close">close</i>\n            <h3>What's new in Power+</h3>\n            <h5>Loading...</h5>\n        </div>\n\n        \x3c!-- General details card for assignments, outcomes, class info, etc. --\x3e\n        <div style="border-radius: 30px;" class="card focus details close container">\n            <i onclick="fluid.cards.close('.card.details')" class="fluid-icon close">close</i>\n            <p>An error occured</p>\n        </div>\n\n        \x3c!-- General iFrame card (with white background) --\x3e\n        <div style="border-radius: 30px; top: 50px; background-color: white; color: black;" class="card focus close iFrameCard container">\n            <i style="color: black !important;" onclick="fluid.cards.close('.card.iFrameCard'); $('#CardIFrame').attr('src', '');" class="fluid-icon close">close</i>\n            <br /><br />\n            <iframe style="width: 100%; height: calc(100vh - 175px); border: none;" id="CardIFrame"></iframe>\n        </div>\n    `),$("#dtpsMainSearchBox").on("focus",(function(){$("#dtpsSearchResults").show()})),$("#dtpsMainSearchBox").on("blur",(function(){$("#dtpsSearchResults").hide()})),$("#dtpsMainSearchBox").on("input",(function(){dtps.setSearchBox()})),$(document).on("keydown","#dtpsMainSearchBox",(function(e){if("Enter"==e.key){var s=$("#dtpsMainSearchBox").val().replace(/(type|class):[a-z]*/gi,"").trim();$("#dtpsMainSearchBox").attr("data-search-type")&&$("#dtpsMainSearchBox").attr("data-dtps-course")&&(fluid.screen("search",{term:s,type:$("#dtpsMainSearchBox").attr("data-search-type"),course:$("#dtpsMainSearchBox").attr("data-dtps-course"),ctxType:$("#dtpsMainSearchBox").attr("data-ctx-type"),ctxCourse:$("#dtpsMainSearchBox").attr("data-ctx-course")}),$("#dtpsMainSearchBox").blur())}}))},dtps.setSearchBox=function(){var e,s=$("#dtpsMainSearchBox").val()||"",t=null,a="dash"==dtps.selectedClass?"dash":dtps.classes[dtps.selectedClass],n=null,d=!1,i="dash"==dtps.selectedClass?"dash":dtps.classes[dtps.selectedClass];if("people"==dtps.selectedContent&&(t="people"),"discuss"==dtps.selectedContent&&(t="discussions"),"pages"==dtps.selectedContent&&(t="pages"),"grades"==dtps.selectedContent&&(t="grades"),"dash"!=dtps.selectedClass&&"stream"!=dtps.selectedContent&&"moduleStream"!=dtps.selectedContent||(t="coursework"),e=t,"search"==dtps.selectedClass&&(t=$("#dtpsMainSearchBox").attr("data-ctx-type"),a=$("#dtpsMainSearchBox").attr("data-ctx-course"),isNaN(Number(a))||(a=dtps.classes[a])),s.split(" ").includes("type:coursework")&&(t="coursework"),s.split(" ").includes("type:homepage")&&(t="homepages"),s.split(" ").includes("type:page")&&(t="pages"),s.split(" ").includes("type:discussion")&&(t="discussions"),s.split(" ").includes("type:grade")&&(t="grades"),s.split(" ").includes("type:person")&&(t="people"),s.split(" ").includes("type:assignment")&&(t="assignments"),s.split(" ").includes("type:module")&&(t="modules"),s.split(" ").includes("type:announcement")&&(t="announcements"),s.split(" ").includes("type:all")&&(t="everything"),"coursework"==t&&(n="library_books"),"people"==t&&(n="people"),"discussions"==t&&(n="forum"),"pages"==t&&(n="insert_drive_file"),"grades"==t&&(n="assessment"),"assignments"==t&&(n="assignment"),"modules"==t&&(n="view_module"),"homepages"==t&&(n="home"),"announcements"==t&&(n="announcement"),"everything"==t&&(n="warning"),s.includes("class:")){var o=s.split("class:")[1].split(" ")[0].toLowerCase();"all"==o?a="all":o&&dtps.classes.forEach((e=>{e.subject.toLowerCase().includes(o)&&(a=e)}))}"dash"!==a&&"all"!==a&&("pages"!=t||a.pages||(d=!0),"discussions"!=t||a.discussions||(d=!0),"modules"!=t||a.modules||(d=!0),"homepages"!=t||a.homepage||(d=!0),"people"!=t||a.people||(d=!0)),"dash"==a||"all"==a?($("#dtpsSearchStatus i").text(n),$("#dtpsSearchStatus span").text("Search "+("everything"==t?t:"all "+t)),$("#dtpsMainSearchBox").attr("placeholder","Search "+("everything"==t?t:"all "+t)),$("#dtpsMainSearchBox").attr("data-dtps-course","all"),$("#dtpsMainSearchBox").attr("data-search-type",t)):d?($("#dtpsSearchStatus i").text("error"),$("#dtpsSearchStatus span").html(`Cannot search for ${t} in <b style="color: ${a.color};">${a.subject}</b>`),$("#dtpsMainSearchBox").attr("placeholder","Cannot search for "+t+" in "+a.subject),$("#dtpsMainSearchBox").attr("data-dtps-course",""),$("#dtpsMainSearchBox").attr("data-search-type","")):($("#dtpsSearchStatus i").text(n),$("#dtpsSearchStatus span").html(`Search ${t} in <b style="color: ${a.color};">${a.subject}</b>`),$("#dtpsMainSearchBox").attr("placeholder","Search "+t+" in "+a.subject),$("#dtpsMainSearchBox").attr("data-dtps-course",a.num),$("#dtpsMainSearchBox").attr("data-search-type",t)),"search"!==dtps.selectedClass&&($("#dtpsMainSearchBox").attr("data-ctx-type",e),$("#dtpsMainSearchBox").attr("data-ctx-course","dash"==i?"dash":i.num))},dtps.renderLite=function(){"true"==fluid.get("pref-hideGrades")&&jQuery("body").addClass("hidegrades"),document.addEventListener("pref-hideGrades",(function(e){"true"==e.detail||1==e.detail?jQuery("body").addClass("hidegrades"):jQuery("body").removeClass("hidegrades")}));var e=new URL(dtps.baseURL).hostname;jQuery(".card.settingsCard").html(`\n        <i onclick="fluid.cards.close('.card.settingsCard')" class="fluid-icon close">close</i>\n\n        <div style="position: fixed; height: calc(100% - 100px);" class="sidenav">\n            <div class="title">\n\t            <img src="${dtps.baseURL+"/icon.svg"}" style="width: 50px;vertical-align: middle;padding: 7px; padding-top: 14px;" />\n\t            <div style="vertical-align: middle; display: inline-block;">\n                    <h5 style="font-weight: bold;display: inline-block;vertical-align: middle;">Power+</h5>\n                    <p>${dtps.readableVer+(dtps.unstable?' <span style="font-size: 12px; color: red;">(unstable)</span>':"")}</p>\n\t            </div>\n            </div>\n\n            <div onclick="$('.abtpage').hide();$('.abtpage.settings').show();" class="item active">\n                <i class="fluid-icon">settings</i> Settings\n            </div>\n            ${dtps.remoteConfig.useV5ThemeSelectionUI?'\n                <div onclick="$(\'.abtpage\').hide();$(\'.abtpage.theme\').show();" class="item">\n                    <i class="fluid-icon">format_paint</i> Theme\n                </div>\n            ':""}\n            ${dtps.remoteConfig.showGradesInSettings?'\n                <div onclick="$(\'.abtpage\').hide();$(\'.abtpage.grades\').show();" class="item">\n                    <i class="fluid-icon">assessment</i> Grades\n                </div>\n            ':""}\n            <div onclick="$('.abtpage').hide();$('.abtpage.dashboard').show();" class="item">\n                <i class="fluid-icon">dashboard</i> Dashboard\n            </div>\n            ${"dev"==dtps.env?'\n                <div onclick="$(\'.abtpage\').hide();$(\'.abtpage.debugging\').show();" class="item">\n                    <i class="fluid-icon">bug_report</i> Debugging\n                </div>\n                <div onclick="$(\'.abtpage\').hide();$(\'.abtpage.experiments\').show();" class="item">\n                    <i class="fluid-icon">science</i> Experiments\n                </div>\n            ':""}\n            <div onclick="$('.abtpage').hide();$('.abtpage.about').show();" class="item abt">\n                <i class="fluid-icon">info</i> About\n            </div>\n        </div>\n\n        <div style="min-height: 100%" class="content">\n            <div class="abtpage settings">\n                <h5><b>Settings</b></h5>\n\n                <p style="display: none;" id="settingsReloadWarning">You must reload for the changes you've made to take effect</p>\n\n                ${dtps.remoteConfig.useV5ThemeSelectionUI?"":'\n                    <br />\n                    <p>Theme</p>\n                    <div class="btns row themeSelector"></div>\n                    <br />\n                '}\n                \n                <br />\n                <p>Sidebar</p>\n\n                <div onclick="fluid.set('pref-hideGrades');" class="switch pref-hideGrades"><span class="head"></span></div>\n                <div class="label"><i class="fluid-icon">visibility_off</i> Hide class grades</div>\n\n                ${dtpsLMS.dtech&&!dtps.user.parent?'\n                        <br /><br />\n                        <div onclick="fluid.set(\'pref-autoGroupClasses\'); dtps.settingsReloadWarning();" class="switch pref-autoGroupClasses active"><span class="head"></span></div>\n                        <div class="label"><i class="fluid-icon">sort</i> Automatically group and sort classes</div>\n                    ':""}\n\n                <br /><br />\n                <p>Classes</p>\n\n                <div onclick="fluid.set('pref-fullNames'); dtps.settingsReloadWarning();" class="switch pref-fullNames"><span class="head"></span></div>\n                <div class="label"><i class="fluid-icon">title</i> Show full class names</div>\n                    \n                <br /><br />\n                <div onclick="fluid.set('pref-hideClassImages')" class="switch pref-hideClassImages"><span class="head"></span></div>\n                <div class="label"><i class="fluid-icon">image</i> Hide class images</div>\n\n                ${dtpsLMS.dtech?'\n                        <br /><br />\n                        <p>Assignments</p>\n\n                        <div onclick="fluid.set(\'pref-formatAssignmentContent\');" class="switch pref-formatAssignmentContent active"><span class="head"></span></div>\n                        <div class="label"><i class="fluid-icon">format_paint</i> Reformat assignment content</div>\n                    ':""}\n\n                <div id="dtpsPrereleaseTesting" style="${window.localStorage.prereleaseEnabled||"dev"==dtps.env||window.localStorage.githubRepo||window.localStorage.externalReleaseURL?"":"display: none;"}">\n                    <br /><br />\n                    <p>Prerelease testing</p>\n\n                    <div>\n                        <div class="btns row small">\n                            <button \n                                onclick="window.localStorage.setItem('dtpsLoaderPref', 'prod')" \n                                class="btn ${["dev","github","external","local"].includes(window.localStorage.dtpsLoaderPref)?"":"active"}">\n                                <i class="fluid-icon">label</i> Production\n                            </button>\n                            <button \n                                onclick="window.localStorage.setItem('dtpsLoaderPref', 'dev')" \n                                class="btn ${"dev"==window.localStorage.dtpsLoaderPref?"active":""}">\n                                <i class="fluid-icon">feedback</i> Dev\n                            </button>\n                            ${window.localStorage.githubRepo?`\n                                <button \n                                    onclick="window.localStorage.setItem('dtpsLoaderPref', 'github')" \n                                    class="btn ${"github"==window.localStorage.dtpsLoaderPref?"active":""}">\n                                    <i class="fluid-icon">account_tree</i> Branch\n                                </button>\n                            `:""}\n                            ${window.localStorage.externalReleaseURL?`\n                                <button \n                                    onclick="window.localStorage.setItem('dtpsLoaderPref', 'external')" \n                                    class="btn ${"external"==window.localStorage.dtpsLoaderPref?"active":""}">\n                                    <i class="fluid-icon">public</i> External\n                                </button>\n                            `:""}\n                            <button\n                                onclick="window.localStorage.setItem('dtpsLoaderPref', 'local')" \n                                class="btn ${"local"==window.localStorage.dtpsLoaderPref?"active":""}">\n                                <i class="fluid-icon">developer_board</i> Local\n                            </button>\n                        </div>\n                    </div>\n                </div>\n\n            </div>\n\n            ${dtps.remoteConfig.useV5ThemeSelectionUI?'\n                <div style="display: none;" class="abtpage theme">\n                    <h5><b>Theme</b></h5>\n                    <br />\n                    <div class="themeSelectionUI flat"></div>\n                </div>\n            ':""}\n\n            <div style="display: none;" class="abtpage grades">\n                <h5><b>Grades</b></h5>\n                \n                <br />\n\n                <div>\n                <h6>Estimated GPA: <b id="dtpsGpaText">...</b></h6>\n                <p style="color: var(--secText);"><i>This GPA calculation is unofficial and does not account for honors credit</i></p>\n                </div>\n                \n                <br />\n\n                <div id="classGradeBars"></div>\n            </div>\n\n            <div style="display: none;" class="abtpage dashboard">\n                <h5><b>Dashboard</b></h5>\n                <p>You can rearrange the items shown on the dashboard by dragging them below. You might have to reload Power+ for changes to take effect.</p>\n\n                <button onclick="dtps.resetDashboardPrefs();" class="btn small"><i class="fluid-icon">refresh</i> Reset dashboard layout</button>\n\n                <br />\n                \n                <div id="leftDashboardColumn" class="dashboardColumn"></div>\n\n                <div id="rightDashboardColumn" class="dashboardColumn"></div>\n            </div>\n\n            ${"dev"==dtps.env?`\n                <div style="display: none;" class="abtpage debugging">\n                   <h5><b>Debugging</b></h5>\n                   <p>These settings are for development only and might break Power+. Use at your own risk.</p>\n\n                   <div>\n                    <button onclick="dtps.firstrun()" class="btn small"><i class="fluid-icon">web_asset</i> Show firstrun screen</button>\n                   </div>\n\n                   <br /><br />\n\n                   <h5>Release configuration</h5>\n\n                   <button onclick="['dtpsLoaderPref', 'prereleaseEnabled', 'githubRepo', 'externalReleaseURL', 'dtpsLMSOverride'].forEach(k => window.localStorage.removeItem(k)); window.location.reload();" class="btn small"><i class="fluid-icon">cancel</i> Clear release configurations</button>\n                   <br /><br />\n\n                   <div>\n                       <input id="dtpsGithubRepo" value="${window.localStorage.githubRepo||""}" placeholder="Branch GitHub repo" />\n                       <button class="btn small" onclick="window.localStorage.setItem('githubRepo', $('#dtpsGithubRepo').val())"><i class="fluid-icon">save</i> Save</button>\n                   </div>\n\n                   <div>\n                       <input id="dtpsExternalReleaseURL" value="${window.localStorage.externalReleaseURL||""}" placeholder="External release URL" />\n                       <button class="btn small" onclick="window.localStorage.setItem('externalReleaseURL', $('#dtpsExternalReleaseURL').val())"><i class="fluid-icon">save</i> Save</button>\n                   </div>\n\n                   <div>\n                       <input id="dtpsLMSOverride" value="${window.localStorage.dtpsLMSOverride||""}" placeholder="LMS override" />\n                       <button class="btn small" onclick="window.localStorage.setItem('dtpsLMSOverride', $('#dtpsLMSOverride').val())"><i class="fluid-icon">save</i> Save</button>\n                   </div>\n\n                   <br />\n\n                   <h5>Behavior Overrides</h5>\n\n                   <br />\n                   <div onclick="fluid.set('pref-debuggingGenericGradebook')" class="switch pref-debuggingGenericGradebook"><span class="head"></span></div>\n                   <div class="label">Always use the generic gradebook</div>\n\n                   <br /><br />\n                   <div onclick="fluid.set('pref-debuggingLocalFluidUI')" class="switch pref-debuggingLocalFluidUI"><span class="head"></span></div>\n                   <div class="label">Use local Fluid UI</div>\n\n                   <br /><br />\n\n                   <br /><br />\n                   <input type="date" />\n                   <br /><br />\n                   <input type="color" />\n                </div>\n                <div style="display: none;" class="abtpage experiments">\n                    <h5><b>Experiments</b></h5>\n                    <p>These settings control how Power+ behaves. Changing these settings may enable unsupported and/or unfinished features that can break Power+. Use at your own risk.</p>\n\n                    <button onclick="Object.keys(dtps.remoteConfig).forEach(k => window.localStorage.removeItem('dtpsRemoteConfig-' + k));" class="btn small"><i class="fluid-icon">cancel</i> Clear Overrides</button>\n                    <br /><br />\n                   ${Object.keys(dtps.remoteConfig).map((e=>`\n                        <div>\n                            <p>${e} ${window.localStorage.getItem("dtpsRemoteConfig-"+e)?" <b>(overridden)</b>":""}</p>\n                            <input value="${dtps.remoteConfig[e]}" placeholder="Value" />\n                            <button class="btn small" onclick="window.localStorage.setItem('dtpsRemoteConfig-${e}', $(this).siblings('input').val())"><i class="fluid-icon">save</i> Save</button>\n                        </div>\n                    `)).join("")}\n                </div>\n            `:""}\n\n            <div style="display: none;" class="abtpage about">\n                <h5><b>About</b></h5>\n\n                <div class="card" style="padding: 10px 20px; box-shadow: none !important; border: 2px solid var(--elements); margin-top: 20px;">\n                    <img src="${dtps.baseURL+"/icon.svg"}" style="height: 50px; margin-right: 10px; vertical-align: middle; margin-top: 20px;" />\n                    \n                    <div style="display: inline-block; vertical-align: middle;">\n                        <h4 id="dtpsAboutName" onclick="dtps.classicEntry()" style="font-weight: bold; font-size: 32px; margin-bottom: 0px; user-select: none;">${"https://dev.dtps.jottocraft.com"==dtps.baseURL?"Power+ (dev)":"Power+"}</h4>\n                        <div style="font-size: 16px; margin-top: 5px;">\n                            ${dtps.readableVer}\n                            <div style="display: inline-block;margin: 0px 5px;font-size: 12px;">${"powerplus.app"!==e?`(from ${e})`:""}</div>\n                        </div>\n                    </div>\n\n                    <div style="margin-top: 15px; margin-bottom: 7px;"><a onclick="dtps.changelog();" style="color: var(--lightText); margin: 0px 5px;" href="#"><i class="fluid-icon" style="vertical-align: middle">update</i> Changelog</a>\n                        <a onclick="if (window.confirm('Are you sure you want to uninstall Power+? The extension will be removed and all of your Power+ data will be erased. If you use the Power+ bookmarklet, you will have to remove that yourself.')) { document.dispatchEvent(new CustomEvent('extensionData', { detail: 'extensionUninstall' })); window.localStorage.clear(); window.alert('Power+ has been uninstalled. Reload the page to go back to ${dtpsLMS.shortName}.') }" style="color: var(--lightText); margin: 0px 5px; cursor: pointer;"><i class="fluid-icon" style="vertical-align: middle">delete_outline</i> Uninstall</a>\n                        <a style="color: var(--lightText); margin: 0px 5px;" href="mailto:hello@jottocraft.com"><i class="fluid-icon" style="vertical-align: middle">email</i> Contact</a>\n                    </div>\n                </div>\n\n                <div class="card" style="padding: 10px 20px; box-shadow: none !important; border: 2px solid var(--elements); margin-top: 20px;">\n                    <div style="margin-top: 12px;">\n                        <img src="${dtps.user.photoURL}" style="height: 50px; margin-right: 10px; vertical-align: middle; border-radius: 50%;" />\n\n                        <div style="display: inline-block; vertical-align: middle;">\n                            <h4 style="font-weight: bold; font-size: 32px; margin: 0px;">${dtps.user.name} <span style="font-size: 12px; line-height: 0px;">${dtps.user.id}</span></h4>\n                        </div>\n                    </div>\n\n                    <div style="margin-top: 15px; margin-bottom: 7px;">\n                        <a style="color: var(--lightText); margin: 0px 5px;" href="/logout"><i class="fluid-icon" style="vertical-align: middle">exit_to_app</i> Logout</a>\n                    </div>\n                </div>\n\n                <div class="card" style="padding: 10px 20px; box-shadow: none !important; border: 2px solid var(--elements); margin-top: 20px;">\n                    <img src="${dtpsLMS.logo}" style="height: 50px; margin-right: 10px; vertical-align: middle; margin-top: 20px; border-radius: 50%; background: #ee5034;" />\n\n                    <div style="display: inline-block; vertical-align: middle;">\n                        <h4 style="font-weight: bold; font-size: 32px; margin-bottom: 0px;">${dtpsLMS.name}</h4>\n                        ${dtpsLMS.description?`\n                            <div style="font-size: 16px; margin-top: 5px;">${dtpsLMS.description}</div>\n                        `:""}\n                    </div>\n\n                    <div style="margin-top: 15px; margin-bottom: 7px;">\n                        <a style="color: var(--lightText); margin: 0px 5px;" href="${dtpsLMS.source}"><i class="fluid-icon" style="vertical-align: middle">code</i> LMS integration source code</a>\n                    </div>\n                </div>\n\n                <div class="card advancedOptions" style="padding: 8px 16px; box-shadow: none !important; border: 2px solid var(--elements); margin-top: 20px; ${"dev"==dtps.env?"":"display: none;"}">\n                    <div style="display: inline-block; vertical-align: middle;">\n                        <h4 style="font-weight: bold; font-size: 28px; margin-bottom: 0px;">Advanced Options</h4>\n                    </div>\n\n                    <div style="margin-top: 15px; margin-bottom: 7px;">\n                        <a style="color: var(--lightText); margin: 0px 5px; cursor: pointer;" onclick="dtps.clearData();"><i class="fluid-icon" style="vertical-align: middle">refresh</i> Reset Power+</a>\n                        <a style="color: var(--lightText); margin: 0px 5px; cursor: pointer;" onclick="if (confirm('Prerelease versions of Power+ are often untested and can break or display incorrect information. Are you sure you want to continue?')) {window.localStorage.prereleaseEnabled = 'true'; $('#dtpsPrereleaseTesting').show(); alert('Prerelease versions can be enabled by going to Settings -> Prerelease testing');}"><i class="fluid-icon" style="vertical-align: middle">feedback</i> Test prerelease versions</a>\n                    </div>\n                </div>\n\n                <br />\n                ${"dev"==dtps.env?"":'<p style="cursor: pointer; color: var(--secText, gray)" onclick="$(\'.advancedOptions\').show(); $(this).hide();" class="advOp">Show advanced options</p>'}\n\n                <div style="text-align: center; padding: 50px 0px;">\n                    <img style="height: 45px; margin-right: 20px; vertical-align: middle;" src="https://cdn.jottocraft.com/images/footerImage.png" />\n                    <h5 style="display: inline-block; vertical-align: middle;">jottocraft</h5>\n                    <p>(c) jottocraft 2018-2021. All rights reserved.&nbsp;&nbsp;<a href="https://github.com/jottocraft/dtps">source code</a>&nbsp;&nbsp;<a href="https://github.com/jottocraft/dtps/blob/main/LICENSE">license</a></p>\n                </div>\n            </div>\n        </div>\n    `),jQuery(".profileImage").css("background-image","url('"+dtps.user.photoURL+"')"),jQuery(".profileMenu .name").text(dtps.user.name),fluid.onLoad(),dtps.showClasses(),jQuery("#dtpsNativeOverlay style").remove(),jQuery("#dtpsNativeOverlay").css("opacity","0"),setTimeout((()=>jQuery("#dtpsNativeOverlay").remove()),200)},dtps.init();
//# sourceMappingURL=/scripts/core.js.map