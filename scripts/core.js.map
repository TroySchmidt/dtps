{"version":3,"sources":["scripts/core.js"],"names":["dtps","ver","readableVer","env","URL","window","dtpsBaseURL","hostname","jottocraftSatEnv","classes","baseURL","unstable","gradebookExpanded","updates","dashboardItems","name","id","icon","size","defaultSide","remoteConfig","showBugReportButton","gradeCalculationEnabled","allowWhatIfGrades","showVideoMeetingButton","dtechHomepageFluidUITabs","dtechCurrentTerm","debugClassID","topSneaky","topSneakyUI","useV5ThemeSelectionUI","remoteUpdate","title","md","active","jQuery","getScript","class","selectedClass","changelog","onlyIfNewVersion","markdown","showdown","Converter","getJSON","data","changelogHTML","makeHtml","body","html","Number","tag_name","replace","localStorage","setItem","includes","fluid","cards","close","log","msg","console","error","devNotes","err","formattedDevNotes","alert","firstrun","dtpsLMS","gradebook","isDemoLMS","shortName","legalName","renderLoadingScreen","dtpsPreLoader","user","append","JS","cb","getItem","CSS","rel","type","href","appendTo","init","popup","dtpsInstalled","urlParams","URLSearchParams","location","search","Array","from","length","history","replaceState","pathname","fluidConfig","config","autoLoad","allowThemeMenu","selectedContent","render","Promise","r","Object","keys","forEach","k","val","fail","then","fetchUser","children","parent","resolve","reject","allClasses","promises","child","push","fetchClasses","course","group","concat","catch","all","rawClasses","institutionSpecific","updateClasses","updatedClasses","e","classData","index","num","nearestCourseColor","nearestColor","red","brown","orange","pumpkin","yellow","yellowGreen","green","oceanGreen","keppel","skyBlue","blue","purple","magenta","pink","gray","gold","darkRed","darkBlue","darkPurple","darkGreen","lightOrange","lightRed","lightBlue","lightPurple","lightGreen","lightBrown","color","value","calculateGrade","letter","grade","undefined","defaultScreen","screens","dashboard","stream","moduleStream","people","pages","discussions","get","genericGradebook","showLMSGradebook","fetchedAnnouncements","courseIndex","fetchAssignments","userID","lmsID","rawAssignments","updateAssignments","updatedAssignments","assignments","assignment","gradedAt","sort","a","b","Date","postedAt","getTime","gradeCalcResults","gradeCalculation","showClasses","hasGradebook","logGrades","presentClass","screen","showGradesInSettings","renderGradesInSettings","fetchAnnouncements","announcements","announcement","renderLite","action","redirectURL","loadDashboardPrefs","formatDate","date","toLocaleString","weekday","month","day","hour","minute","iframeLoad","iframeID","iFrame","document","getElementById","height","contentWindow","scrollHeight","clearData","confirm","clear","override","classlist","previousClassGroup","i","letterGradeHTML","subject","join","$","click","event","modules","classNum","image","addClass","attr","show","removeClass","hide","text","css","is","setSearchBox","teacher","photoURL","homepage","videoMeetingURL","fetchMeetingURL","url","classHome","fetchHomepage","computedBackgroundColor","getComputedStyle","getPropertyValue","computedTextColor","hasClass","brightenTextForDarkMode","dtech","find","toArray","fragments","fragment","toLowerCase","blob","Blob","frameURL","createObjectURL","map","homepageURL","classID","indexOf","renderGradebook","gradebookDidRender","externalScreens","showIFrameCard","bg","fakeRoot","filter","this","parents","element","brightness","tinycolor","getBrightness","brightnessDiff","brighten","Math","abs","toHex","darken","savedCurrent","split","savedPrevious","previousLetter","settings","forceRerenderDashboard","dashboardHTML","dashboardArray","dashboardItem","leftDashboard","rightDashboard","sortable","connectWith","update","ui","saveDashboardPrefs","settingsReloadWarning","percentage","sum","values","points","toFixed","dashboardPrefs","side","JSON","stringify","resetDashboardPrefs","removeItem","classicEntry","classicName","overwrittenHTML","classicStep","dtpsDashboardItems","dashboardPref","parse","dashboardIDs","item","dashboardItemPref","itemIndex","remove","on","key","term","trim","ctxType","ctxCourse","blur","autoType","autoCourse","isNaN","partialSubject","c","addEventListener","detail","baseHost","prereleaseEnabled","githubRepo","externalReleaseURL","dtpsLoaderPref","dtpsLMSOverride","logo","description","source","onLoad","setTimeout"],"mappings":"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","sourceRoot":"/","sourcesContent":["/**\r\n * @file DTPS Core functions and module loader\r\n * @author jottocraft\r\n * @version v3.1.0\r\n * \r\n * @copyright Copyright (c) 2018-2021 jottocraft. All rights reserved.\r\n * @license GPL-2.0-only\r\n */\r\n\r\n//Make sure DTPS isn't already loading\r\nif (typeof dtps !== \"undefined\") throw \"Error: DTPS is already loading\";\r\n\r\n/**\r\n * Global DTPS object\r\n * All global DTPS functions and variables are stored in this object\r\n * \r\n * @global\r\n * @namespace dtps\r\n * @property {number} ver Comparable version number\r\n * @property {string} env DTPS enviornment (\"prod\" or \"dev\")\r\n * @property {string} readableVer Formatted semantic version number\r\n * @property {Class[]} classes Array of classes the current user is in\r\n * @property {string} baseURL The base URL that DTPS is being loaded from\r\n * @property {boolean} unstable This is true if loading an unstable version of DTPS\r\n * @property {boolean} gradebookExpanded True if gradebook details (Show more...) is open. Used in the generic gradebook and may be used in custom gradebook implementations.\r\n * @property {string|undefined} popup Popup to show when loaded. Either undefined (no popup), \"firstrun\", or \"changelog\". \r\n * @property {User} user Current user, fetched with dtps.init\r\n * @property {number|string} selectedClass The selected class number, or \"dash\" if the dashboard is selected. Set when the first screen is loaded in dtps.init.\r\n * @property {string} selectedContent The selected class content/tab. Set when the first class content is loaded. Defaults to \"stream\".\r\n * @property {number|undefined} bgTimeout Background transition timeout when switching between classes\r\n * @property {Array<Assignment|Announcement>} updates Array of up to 10 recently graded assignments or announcements. \r\n * @property {DashboardItem[]} dashboardItems Array of items that can be shown on the dashboard\r\n * @property {DashboardItem[]} leftDashboard Items on the left side of the dashboard based on dtps.dashboardItems and user prefrences. Set in dtps.loadDashboardPrefs.\r\n * @property {DashboardItem[]} rightDashboard Items on the right side of the dashboard based on dtps.dashboardItems and user prefrences. Set in dtps.loadDashboardPrefs.\r\n * @property {object} remoteConfig Configuration variables that can be remotely changed\r\n * @property {boolean} searchScrollListener True if the search scroll listener has been added\r\n */\r\nvar dtps = {\r\n    ver: 310,\r\n    readableVer: \"v3.1.0\",\r\n    env: new URL(window.dtpsBaseURL || \"https://powerplus.app\").hostname == \"localhost\" ? \"dev\" : window.jottocraftSatEnv || \"prod\",\r\n    classes: [],\r\n    baseURL: window.dtpsBaseURL || \"https://powerplus.app\",\r\n    unstable: window.dtpsBaseURL !== \"https://powerplus.app\",\r\n    gradebookExpanded: false,\r\n    updates: [],\r\n    dashboardItems: [\r\n        {\r\n            name: \"Calendar\",\r\n            id: \"dtps.calendar\",\r\n            icon: \"event\",\r\n            size: 100,\r\n            defaultSide: \"left\"\r\n        }, {\r\n            name: \"Updates\",\r\n            id: \"dtps.updates\",\r\n            icon: \"calendar_view_day\",\r\n            size: 170,\r\n            defaultSide: \"left\"\r\n        }, {\r\n            name: \"Due Today\",\r\n            id: \"dtps.dueToday\",\r\n            icon: \"check_circle_outline\",\r\n            size: 20,\r\n            defaultSide: \"right\"\r\n        }, {\r\n            name: \"Upcoming Assignments\",\r\n            id: \"dtps.upcoming\",\r\n            icon: \"view_stream\",\r\n            size: 250,\r\n            defaultSide: \"right\"\r\n        }\r\n    ],\r\n    remoteConfig: {\r\n        showBugReportButton: false,\r\n        gradeCalculationEnabled: true,\r\n        allowWhatIfGrades: true,\r\n        showVideoMeetingButton: true,\r\n        dtechHomepageFluidUITabs: true,\r\n        dtechCurrentTerm: \"20-21\",\r\n        debugClassID: \"1098\",\r\n        topSneaky: false,\r\n        topSneakyUI: false,\r\n        useV5ThemeSelectionUI: false,\r\n        remoteUpdate: {\r\n            title: null,\r\n            md: null,\r\n            active: false\r\n        }\r\n    }\r\n};\r\n\r\n//Load jQuery ASAP\r\njQuery.getScript(\"https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js\");\r\n\r\n/**\r\n * Debugging shortcut for getting the selected class. This should only be used in the web inspector and not in actual code.\r\n * \r\n * @return {object|undefined} The selected class \r\n */\r\ndtps.class = function () {\r\n    return dtps.classes[dtps.selectedClass];\r\n}\r\n\r\n/**\r\n * Fetches and displays the DTPS changelog modal\r\n * \r\n * @param onlyIfNewVersion True if the changelog should only show if this is a new version\r\n */\r\ndtps.changelog = function (onlyIfNewVersion) {\r\n    //Fetch latest changelog from GitHub releases\r\n    jQuery.getScript(\"https://cdnjs.cloudflare.com/ajax/libs/showdown/1.8.6/showdown.min.js\", function () {\r\n        markdown = new showdown.Converter();\r\n        jQuery.getJSON(\"https://api.github.com/repos/jottocraft/dtps/releases/latest\", function (data) {\r\n            //Convert changelog to HTML and render in the changelog card\r\n            var changelogHTML = markdown.makeHtml(data.body);\r\n            jQuery(\".card.changelog\").html(`<i onclick=\"fluid.cards.close('.card.changelog')\" class=\"fluid-icon close\">close</i>` + changelogHTML);\r\n\r\n            if (!onlyIfNewVersion) {\r\n                //Show changelog\r\n                fluid.cards.close(\".card.focus\");\r\n                fluid.cards(\".card.changelog\");\r\n            } else if (Number(data.tag_name.replace(/[^0-9]/g, '')) > Number(window.localStorage.dtps)) {\r\n                //Show changelog if this is a new(er) version\r\n                localStorage.setItem('dtps', data.tag_name.replace(/[^0-9]/g, ''));\r\n\r\n                if (!data.tag_name.includes(\"s\")) {\r\n                    //s in tag_name means a silent release\r\n                    fluid.cards.close(\".card.focus\");\r\n                    fluid.cards(\".card.changelog\");\r\n                }\r\n            }\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * Logs debugging messages\r\n * \r\n * @param {string} msg The debugging message to log\r\n */\r\ndtps.log = function (msg) {\r\n    if (dtps.env == \"dev\") console.log(\"[DTPS]\", msg);\r\n}\r\n\r\n\r\n/**\r\n * Shows an error message alert and logs to console\r\n * \r\n * @param {string} msg The error to display\r\n * @param {string} [devNotes] Technical error details displayed in a smaller font\r\n * @param {Error} [err] An error object to log to the console. If this is null, DTPS will assume the error has been handled elsewhere.\r\n */\r\ndtps.error = function (msg, devNotes, err) {\r\n    if (err !== null) {\r\n        var formattedDevNotes = \"\";\r\n        if (devNotes) {\r\n            formattedDevNotes = '<div style=\"font-size: 12px; color: var(--secText, gray); margin-top: 10px;\">' + devNotes + '</div>';\r\n        }\r\n        console.error(\"[DTPS !!ERROR!!]\", devNotes + \": \", err);\r\n        fluid.alert(\"Error\", msg + formattedDevNotes, \"error\");\r\n    }\r\n}\r\n\r\n/**\r\n * Renders \"Welcome to Project DTPS\" screen on the first run\r\n */\r\ndtps.firstrun = function () {\r\n    //Set latest changelog version to current version\r\n    window.localStorage.setItem('dtps', dtps.ver);\r\n\r\n    //Welcome to DTPS screen HTML\r\n    jQuery(\".card.changelog\").html(/*html*/`\r\n        <h3 style=\"margin-bottom: 0px;\">Welcome to Power+</h3>\r\n        <h5 style=\"color: var(--secText); font-weight: bold; font-size: 22px;\">${dtps.readableVer}</h5>\r\n\r\n        <div class=\"welcomeSection\">\r\n            <i class=\"fluid-icon\">dashboard</i>\r\n            <h5>${dtpsLMS.gradebook ? \"Manage your coursework and grades\" : \"Manage your coursework\"}</h5>\r\n            <p>Power+ organizes all of your coursework so you can easily see what you need to do next. The dashboard shows upcoming assignments, recent grades, and announcements.\r\n            ${dtpsLMS.gradebook ? `Power+ includes a gradebook designed for ${dtpsLMS.name} to help you understand your grades.` : ``}</p>\r\n        </div>\r\n\r\n        ${dtpsLMS.isDemoLMS ? /*html*/`\r\n            <div class=\"welcomeSection\">\r\n                <i class=\"fluid-icon\">priority_high</i>\r\n                <h5>This is a demo</h5>\r\n                <p>Assignment information, grades, and other content displayed is not real and is for demonstration purposes only. This demo does not retrieve or collect any data.</p>\r\n            </div>\r\n        ` : /*html*/`\r\n            <div class=\"welcomeSection\">\r\n                <i class=\"fluid-icon\">security</i>\r\n                <h5>Privacy</h5>\r\n                <p>Power+ does not collect any information. All of the data used in Power+ is fetched directly from ${dtpsLMS.shortName} and is never sent anywhere else. \r\n                 User preferences, grade history, and other Power+ data is stored locally on your computer and is not associated with your ${dtpsLMS.shortName} account.</p>\r\n            </div>\r\n            <div class=\"welcomeSection\">\r\n                <i class=\"fluid-icon\">priority_high</i>\r\n                <h5>Power+ is not official</h5>\r\n                <p>Assignment information, grades, and other content displayed in Power+ are not official. Power+ is neither created nor endorsed by ${dtpsLMS.legalName}.\r\n                 Power+ may have bugs that could cause it to display inaccurate information. Use Power+ at your own risk.</p>\r\n            </div>\r\n        `}\r\n        \r\n        <br />\r\n        <button onclick=\"window.localStorage.setItem('dtpsInstalled', 'true'); fluid.cards.close('.card.changelog');\" class=\"btn\">\r\n            <i class=\"fluid-icon\">arrow_forward</i> Continue\r\n        </button>\r\n    `);\r\n\r\n    //Show Welcome to DTPS card\r\n    fluid.cards.close(\".card.focus\");\r\n    fluid.cards(\".card.changelog\", \"stayOpen\");\r\n};\r\n\r\n/**\r\n * Renders the DTPS loading screen\r\n */\r\ndtps.renderLoadingScreen = function () {\r\n    if (!window.dtpsPreLoader || dtps.user) {\r\n        //Only show the loader if the extension hasn't already shown it\r\n        jQuery(\"body\").append(/*html*/`\r\n            <div id=\"dtpsNativeOverlay\" style=\"background-color: #151515; position: fixed; top: 0px; left: 0px; width: 100%; height: 100vh; z-index: 99;text-align: center;z-index: 999;transition: opacity 0.2s;\">\r\n                <img style=\"height: 100px; margin-top: 132px;\" src=\"https://i.imgur.com/7dDUVh2.png\" />\r\n\t\t\t    <br />\r\n                <div class=\"progress\"><div class=\"indeterminate\"></div></div>\r\n                <style>body {background-color: #151515; overflow: hidden;}*,:after,:before{box-sizing:border-box}.progress{position:relative;width:600px;height:5px;overflow:hidden;border-radius:12px;background:#262626;backdrop-filter:opacity(.4);display:inline-block;margin-top:75px}.progress .indeterminate{position:absolute;background:#e3ba4b;height:5px;animation:indeterminate 1.4s infinite;animation-timing-function:linear}@keyframes indeterminate{0%{width:5%;left:-15%}to{width:100%;left:110%}}</style>\r\n            </div>\r\n        `);\r\n    }\r\n}\r\n\r\n/**\r\n * Load all external JavaScript libraries\r\n * \r\n * @param {function} cb Callback function\r\n */\r\ndtps.JS = function (cb) {\r\n    //Moment & Fullcalendar are used for the calendar on the dashboard\r\n    jQuery.getScript(\"https://cdn.jsdelivr.net/npm/fullcalendar@5.3.2/main.min.js\", function () {\r\n        jQuery.getScript(\"https://cdn.jsdelivr.net/npm/fullcalendar@5.3.2/locales-all.min.js\");\r\n    });\r\n\r\n    //Lunr is used for search\r\n    jQuery.getScript('https://unpkg.com/lunr@2.3.9/lunr.min.js');\r\n\r\n    //jQuery UI for dashboard settings page\r\n    jQuery.getScript('https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js');\r\n\r\n    //Tinycolor used for better dark mode support\r\n    jQuery.getScript(\"https://cdn.jottocraft.com/tinycolor.js\");\r\n\r\n    //dtao/nearest-color is used for finding the nearest class color\r\n    jQuery.getScript(\"https://cdn.jottocraft.com/nearest-color.dtao.js\", () => {\r\n        //Fluid UI for core UI elements\r\n        if (window.localStorage.getItem(\"pref-debuggingLocalFluidUI\") == \"true\") {\r\n            jQuery.getScript('http://localhost:1222/dev/fluid.js', cb);\r\n        } else {\r\n            jQuery.getScript('https://cdn.jottocraft.com/fluid/build/v5/latest/fluid.js', cb);\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Load all DTPS CSS files\r\n */\r\ndtps.CSS = function () {\r\n    jQuery(\"<link/>\", {\r\n        rel: \"stylesheet\",\r\n        type: \"text/css\",\r\n        href: window.localStorage.getItem(\"pref-debuggingLocalFluidUI\") == \"true\" ? \"http://localhost:1222/dev/fluid.css\" : \"https://cdn.jottocraft.com/fluid/build/v5/latest/fluid.css\",\r\n        class: \"dtpsHeadItem\"\r\n    }).appendTo(\"head\");\r\n\r\n    jQuery(\"<link/>\", {\r\n        rel: \"stylesheet\",\r\n        type: \"text/css\",\r\n        href: dtps.baseURL + \"/dtps.css\",\r\n        class: \"dtpsHeadItem\"\r\n    }).appendTo(\"head\");\r\n\r\n    jQuery(\"<link/>\", {\r\n        rel: \"stylesheet\",\r\n        type: \"text/css\",\r\n        href: \"https://fonts.googleapis.com/css?family=Material+Icons+Round\",\r\n        class: \"dtpsHeadItem\"\r\n    }).appendTo(\"head\");\r\n\r\n    jQuery(\"<link/>\", {\r\n        rel: \"stylesheet\",\r\n        type: \"text/css\",\r\n        href: \"https://cdn.jsdelivr.net/npm/fullcalendar@5.3.2/main.min.css\",\r\n        class: \"dtpsHeadItem\"\r\n    }).appendTo(\"head\");\r\n\r\n    jQuery(\"<link/>\", {\r\n        rel: \"stylesheet\",\r\n        type: \"text/css\",\r\n        href: \"https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css\",\r\n        class: \"dtpsHeadItem\"\r\n    }).appendTo(\"head\");\r\n}\r\n\r\n/**\r\n * Starts DTPS (entrypoint function)\r\n */\r\ndtps.init = function () {\r\n    //Initial log\r\n    dtps.log(\"Starting DTPS \" + dtps.readableVer + \"...\");\r\n\r\n    //Check for LMS config\r\n    if (!window.dtpsLMS) {\r\n        throw \"Error: No DTPS LMS configuration found\";\r\n    }\r\n\r\n    //Determine if changelog should be shown\r\n    if (Number(window.localStorage.dtps) < dtps.ver) {\r\n        dtps.log(\"New release\");\r\n        dtps.popup = \"changelog\";\r\n    }\r\n\r\n    //Determine if this is the first time loading DTPS\r\n    if (window.localStorage.dtpsInstalled !== \"true\") {\r\n        dtps.popup = \"firstrun\";\r\n    }\r\n\r\n    //Render loading screen\r\n    dtps.renderLoadingScreen();\r\n\r\n    //Get URL parameters\r\n    var urlParams = new URLSearchParams(window.location.search);\r\n    if (Array.from(urlParams).length) window.history.replaceState(null, null, window.location.pathname);\r\n\r\n    //Fluid UI settings\r\n    window.fluidConfig = {\r\n        config: {\r\n            autoLoad: false,\r\n            allowThemeMenu: false //This is false because Power+ uses its own theme settings UI\r\n        }\r\n    };\r\n\r\n    //Set env discovery\r\n    window.localStorage.setItem(\"jottocraftEnv\", true);\r\n\r\n    //Default selected content\r\n    dtps.selectedContent = \"stream\";\r\n\r\n    //Begin loading CSS\r\n    dtps.CSS();\r\n\r\n    //Begin loading static DTPS HTML\r\n    dtps.render();\r\n\r\n    //Fetch remote config\r\n    new Promise((r) => {\r\n        jQuery.getJSON('https://project-dtps.firebaseio.com/config.json', (remoteConfig) => {\r\n            if (remoteConfig) {\r\n                Object.keys(remoteConfig).forEach(k => {\r\n                    var val = remoteConfig[k];\r\n\r\n                    dtps.remoteConfig[k] = val;\r\n                });\r\n            }\r\n            r();\r\n        }).fail(() => r());\r\n    }).then(() => {\r\n        //dev env remote config overrides\r\n        if (dtps.env == \"dev\") {\r\n            Object.keys(dtps.remoteConfig).forEach(k => {\r\n                if (window.localStorage.getItem(\"dtpsRemoteConfig-\" + k)) {\r\n                    val = window.localStorage.getItem(\"dtpsRemoteConfig-\" + k);\r\n\r\n                    if (val == \"true\") val = true;\r\n                    if (val == \"false\") val = false;\r\n\r\n                    dtps.remoteConfig[k] = val;\r\n                }\r\n            });\r\n        }\r\n\r\n        //Fetch user and class data\r\n        return dtpsLMS.fetchUser();\r\n    }).then(data => {\r\n        //Prevent resetting the user if the user is already set (for parent accounts)\r\n        dtps.user = data;\r\n\r\n        //If this is a parent account, show the parent UI\r\n        if (dtps.user.children && dtps.user.children.length) {\r\n            dtps.user.parent = true;\r\n\r\n            //Fetch classes for all students\r\n            return new Promise((resolve, reject) => {\r\n                var allClasses = [];\r\n                var promises = [];\r\n\r\n                dtps.user.children.forEach(child => {\r\n                    promises.push(new Promise(function (resolve, reject) {\r\n                        dtpsLMS.fetchClasses(child.id).then((data) => {\r\n                            //Prepend child ID to class ID\r\n                            data.forEach(course => {\r\n                                course.id = child.id + \"-\" + course.id;\r\n                                course.group = child.name;\r\n                            });\r\n\r\n                            allClasses = allClasses.concat(data);\r\n                            resolve();\r\n                        }).catch(reject);\r\n                    }));\r\n                });\r\n\r\n                Promise.all(promises).then(() => {\r\n                    resolve(allClasses);\r\n                });\r\n            });\r\n        } else {\r\n            return dtpsLMS.fetchClasses(dtps.user.id);\r\n        }\r\n    }).then((rawClasses) => {\r\n        return new Promise((resolve, reject) => {\r\n            if (dtpsLMS.institutionSpecific && dtpsLMS.updateClasses) {\r\n                //Using an institution-specific script, make any nessasary changes and return updated classes\r\n                dtpsLMS.updateClasses(rawClasses).then((updatedClasses) => {\r\n                    resolve(updatedClasses);\r\n                }).catch((e) => {\r\n                    reject(e);\r\n                });\r\n            } else {\r\n                //No institution-specific script, return classes as-is\r\n                resolve(rawClasses);\r\n            }\r\n        });\r\n    }).then(classData => {\r\n        //Store classData to dtps.classes\r\n        dtps.classes = classData;\r\n\r\n        //Add course num props\r\n        dtps.classes.forEach((course, index) => course.num = index);\r\n\r\n        //Fetch JavaScript modules\r\n        dtps.JS(() => {\r\n            //Define DTPS class color pallete\r\n            var nearestCourseColor = nearestColor.from({\r\n                //Primary color shades\r\n                red: \"#cc4747\",\r\n                brown: \"#9a4429\",\r\n                orange: \"#ce734e\",\r\n                pumpkin: \"#c58535\",\r\n                yellow: \"#b58f38\",\r\n                yellowGreen: \"#7c9630\",\r\n                green: \"#439a47\",\r\n                oceanGreen: \"#339a70\",\r\n                keppel: \"#40b5c3\",\r\n                skyBlue: \"#40a4d6\",\r\n                blue: \"#2d72a0\",\r\n                purple: \"#985cab\",\r\n                magenta: \"#bd3e69\",\r\n                pink: \"#ec7ca5\",\r\n                gray: \"#888888\",\r\n                //Dark color shades\r\n                gold: \"#94652a\",\r\n                darkRed: \"#943f3f\",\r\n                darkBlue: \"#485182\",\r\n                darkPurple: \"#6f4882\",\r\n                darkGreen: \"#3d7358\",\r\n                //Light color shades\r\n                lightOrange: \"#ea7a44\",\r\n                lightRed: \"#e07f7f\",\r\n                lightBlue: \"#76c1e6\",\r\n                lightPurple: \"#978fd6\",\r\n                lightGreen: \"#7ebb95\",\r\n                lightBrown: \"#928871\"\r\n            });\r\n\r\n            //Loop over each class to update the color and check for grade calculation\r\n            dtps.classes.forEach(course => {\r\n                course.color = course.color ? nearestCourseColor(course.color).value : \"gray\";\r\n\r\n                if (dtpsLMS.calculateGrade && dtps.remoteConfig.gradeCalculationEnabled) {\r\n                    //This LMS/Institution supports grade calculation, show loading indicator for grade\r\n                    //Grade will be calculated once assignments are fetched\r\n\r\n                    course.letter = \"...\"; //Setting this to ... shows the loading indicator\r\n                    course.grade = undefined;\r\n                }\r\n            });\r\n\r\n            //Fluid UI screens\r\n            fluid.defaultScreen = \"dashboard\";\r\n            fluid.screens.dashboard = dtps.baseURL + \"/scripts/assignments.js\";\r\n            fluid.screens.stream = dtps.baseURL + \"/scripts/assignments.js\";\r\n            fluid.screens.moduleStream = dtps.baseURL + \"/scripts/assignments.js\";\r\n            fluid.screens.people = dtps.baseURL + \"/scripts/people.js\";\r\n            fluid.screens.search = dtps.baseURL + \"/scripts/search.js\";\r\n            fluid.screens.pages = dtps.baseURL + \"/scripts/pages-discussions.js\";\r\n            fluid.screens.discussions = dtps.baseURL + \"/scripts/pages-discussions.js\";\r\n\r\n            if (dtpsLMS.gradebook && !((dtps.env == \"dev\") && (fluid.get(\"pref-debuggingGenericGradebook\") == \"true\"))) {\r\n                //Handle LMS gradebook\r\n                fluid.screens.gradebook = dtps.showLMSGradebook;\r\n            } else if (dtpsLMS.genericGradebook || ((dtps.env == \"dev\") && (fluid.get(\"pref-debuggingGenericGradebook\") == \"true\"))) {\r\n                //Generic gradebook script\r\n                fluid.screens.gradebook = dtps.baseURL + \"/scripts/assignments.js\";\r\n            }\r\n\r\n            //Begin fetching class assignments\r\n            var fetchedAnnouncements = [];\r\n            dtps.classes.forEach((course, courseIndex) => {\r\n                dtpsLMS.fetchAssignments(course.userID, course.lmsID).then((rawAssignments) => {\r\n                    return new Promise((resolve, reject) => {\r\n                        if (dtpsLMS.institutionSpecific && dtpsLMS.updateAssignments) {\r\n                            //Using an institution-specific script, make any nessasary changes and return updated assignments\r\n                            dtpsLMS.updateAssignments(rawAssignments).then(updatedAssignments => {\r\n                                resolve(updatedAssignments);\r\n                            }).catch(reject);\r\n                        } else {\r\n                            //No institution-specific script, return assignments as-is\r\n                            resolve(rawAssignments);\r\n                        }\r\n                    });\r\n                }).then(assignments => {\r\n                    //Store assignments in the class\r\n                    course.assignments = assignments;\r\n\r\n                    //Add class props to assignments and add recent assignments to updates array \r\n                    course.assignments.forEach(assignment => {\r\n                        assignment.class = courseIndex;\r\n\r\n                        if (assignment.gradedAt && assignment.grade) {\r\n                            //Add class number and type to object\r\n                            dtps.updates.push({\r\n                                class: course.num,\r\n                                type: \"assignment\",\r\n                                ...assignment\r\n                            })\r\n                        }\r\n                    });\r\n\r\n                    //Sort updates array from newest -> oldest\r\n                    dtps.updates.sort(function (a, b) {\r\n                        //Sort by postedAt (announcements) or gradedAt (assignments)\r\n                        return new Date(b.gradedAt || b.postedAt).getTime() - new Date(a.gradedAt || a.postedAt).getTime()\r\n                    });\r\n\r\n                    //Keep only the 15 most recent updates\r\n                    if (dtps.updates.length > 15) dtps.updates.length = 15;\r\n\r\n                    //Calculate class grade if supported\r\n                    if (dtpsLMS.calculateGrade && dtps.remoteConfig.gradeCalculationEnabled) {\r\n                        let gradeCalcResults = dtpsLMS.calculateGrade(course, assignments);\r\n\r\n                        if (gradeCalcResults) {\r\n                            //This class has a grade\r\n\r\n                            //Set course letter and grade to grade calc results\r\n                            course.letter = gradeCalcResults.letter;\r\n                            course.grade = gradeCalcResults.grade;\r\n\r\n                            //Save raw results object to the course so it can be accessed by the gradebook\r\n                            course.gradeCalculation = gradeCalcResults;\r\n                        } else {\r\n                            //No grade for this class\r\n                            course.letter = null;\r\n                            course.grade = null;\r\n                        }\r\n\r\n                        //Force re-render sidebar to show grades only if the user isn't on pages or discussions\r\n                        if ((dtps.selectedContent !== \"pages\") && (dtps.selectedContent !== \"discuss\")) {\r\n                            dtps.showClasses(true);\r\n                        }\r\n                    }\r\n\r\n                    //Grade history and gradebook\r\n                    if (course.letter && (course.letter !== \"...\")) {\r\n                        //Enable gradebook for this class\r\n                        course.hasGradebook = true;\r\n\r\n                        //Save grade history\r\n                        dtps.logGrades(courseIndex);\r\n\r\n                        //If the class is selected, call dtps.presentClass again to show the grades tab\r\n                        if (courseIndex == dtps.selectedClass) {\r\n                            dtps.presentClass(courseIndex);\r\n\r\n                            //If the gradebook is selected, reload the gradebook\r\n                            if (dtps.selectedContent == \"grades\") {\r\n                                fluid.screen('gradebook', dtps.classes[courseIndex].id);\r\n                            }\r\n                        }\r\n                    } else {\r\n                        //This class doesn't have a gradebook, exit gradebook if selected\r\n                        if ((courseIndex == dtps.selectedClass) && (dtps.selectedContent == \"grades\")) {\r\n                            fluid.screen('stream', dtps.classes[courseIndex].id);\r\n                        }\r\n                    }\r\n\r\n                    //Render grades tab in settings\r\n                    if (dtps.remoteConfig.showGradesInSettings) dtps.renderGradesInSettings();\r\n\r\n                    //Re-render screen if the dashboard or stream is selected\r\n                    if ((dtps.selectedClass == \"dash\") || ((dtps.selectedContent == \"stream\") && (dtps.selectedClass == course.num))) {\r\n                        fluid.screen();\r\n                    }\r\n                });\r\n\r\n                if (!fetchedAnnouncements.includes(course.lmsID)) {\r\n                    //Add lmsID to list of fetched announcements to prevent duplicates\r\n                    fetchedAnnouncements.push(course.lmsID);\r\n\r\n                    dtpsLMS.fetchAnnouncements(course.lmsID).then(announcements => {\r\n                        //Add announcements to updates array\r\n                        announcements.forEach(announcement => {\r\n                            //Add class number and type to object\r\n                            dtps.updates.push({\r\n                                class: course.num,\r\n                                type: \"announcement\",\r\n                                ...announcement\r\n                            });\r\n                        });\r\n\r\n                        //Sort updates array from newest -> oldest\r\n                        dtps.updates.sort(function (a, b) {\r\n                            //Sort by postedAt (announcements) or gradedAt (assignments)\r\n                            return new Date(b.gradedAt || b.postedAt).getTime() - new Date(a.gradedAt || a.postedAt).getTime()\r\n                        });\r\n\r\n                        //Keep only the 15 most recent updates\r\n                        if (dtps.updates.length > 15) dtps.updates.length = 15;\r\n\r\n                        if (dtps.selectedClass == \"dash\") {\r\n                            fluid.screen();\r\n                        }\r\n                    });\r\n                }\r\n            });\r\n\r\n            //Render remaining HTML\r\n            dtps.renderLite();\r\n\r\n            //Render initial screen\r\n            fluid.screen();\r\n\r\n            //Load popup if needed\r\n            if (dtps.popup == \"firstrun\") {\r\n                dtps.firstrun();\r\n            } else if (dtps.popup == \"changelog\") {\r\n                //Changelog will only show if the release notes are on GitHub\r\n                dtps.changelog(true);\r\n            }\r\n\r\n            //Check URL parameter\r\n            if ((urlParams.get(\"prerelease\") == \"canary\") && urlParams.get(\"repo\")) {\r\n                fluid.alert(\"Power+ Canary\", \"<p>Do you want to add this release configuration to Power+?</p>\", \"build_circle\", [\r\n                    {\r\n                        name: \"Add\",\r\n                        icon: \"add\",\r\n                        action: \"window.localStorage.githubCanary = '\" + urlParams.get(\"repo\") + \"'; alert('Please reload the page for changes to take effect');\"\r\n                    },\r\n                    {\r\n                        name: \"Cancel\",\r\n                        icon: \"cancel\"\r\n                    }\r\n                ]);\r\n            }\r\n        });\r\n    }).catch(function (err) {\r\n        //Web request error\r\n        console.error(\"[DTPS] Error fetching user and classes at dtps.init\", err);\r\n\r\n        //Check for login redirect\r\n        if ((err.action == \"login\") && err.redirectURL) {\r\n            //Redirect to login page\r\n            window.location.href = err.redirectURL;\r\n        } else {\r\n            dtps.error(\"Failed to get user and/or course data\", \"Exception in promise @ dtps.init\");\r\n        }\r\n    });\r\n\r\n    //Load dashboard prefrences\r\n    dtps.loadDashboardPrefs();\r\n}\r\n\r\n/**\r\n * Formats a date to a readable date string\r\n * \r\n * @param {Date} date The date to format\r\n * @return {string} Formatted date and time string\r\n */\r\ndtps.formatDate = function (date) {\r\n    if (date) {\r\n        return new Date(date).toLocaleString(\"en\", { weekday: 'short', month: 'short', day: 'numeric', hour: \"numeric\", minute: \"numeric\" });\r\n    } else {\r\n        return \"\";\r\n    }\r\n}\r\n\r\n/**\r\n * Adjusts the height of an iFrame to match its content\r\n * \r\n * @param {string} iframeID The ID of the iFrame element to adjust\r\n */\r\ndtps.iframeLoad = function (iframeID) {\r\n    var iFrame = document.getElementById(iframeID);\r\n    if (iFrame) {\r\n        iFrame.height = \"\";\r\n        iFrame.height = iFrame.contentWindow.document.body.scrollHeight + \"px\";\r\n    }\r\n}\r\n\r\n/**\r\n * Clears all DTPS data\r\n */\r\ndtps.clearData = function () {\r\n    if (window.confirm(\"Clearing Power+ data will clear all local user data stored by Power+. This should be done if it is a new semester / school year or if you are having issues with Power+. Are you sure you want to clear all your Power+ data?\")) {\r\n        window.localStorage.clear()\r\n        window.alert(\"Power+ data cleared\")\r\n    }\r\n}\r\n\r\n/**\r\n * Renders the class list in the sidebar\r\n * \r\n * @param {boolean} [override] True if the sidebar should be forcefully re-rendered\r\n */\r\ndtps.showClasses = function (override) {\r\n    //Array of class HTML for the sidebar\r\n    dtps.classlist = [];\r\n\r\n    var previousClassGroup = null;\r\n    for (var i = 0; i < dtps.classes.length; i++) {\r\n        //Determine letter grade HTML\r\n        var letterGradeHTML = \"\";\r\n        if (dtps.classes[i].letter) letterGradeHTML = dtps.classes[i].letter;\r\n        if (dtps.classes[i].letter == null) letterGradeHTML = \"--\";\r\n        if (dtps.classes[i].letter == \"...\") letterGradeHTML = `<div class=\"shimmer\" style=\"width: 100%;height: 22px;border-radius: 8px;\"></div>`; //Show loading indicator for ...\r\n\r\n        if (dtps.classes[i].group && (dtps.classes[i].group !== previousClassGroup)) {\r\n            if (previousClassGroup) dtps.classlist.push(`</div></div>`);\r\n            dtps.classlist.push(/*html*/`\r\n                <div id=\"dtpsClassListGroup-${dtps.classes[i].group}\" class=\"group open\">\r\n                  <div class=\"name item\">\r\n                    <i class=\"fluid-icon\"></i> <span class=\"label\">${dtps.classes[i].group}</span>\r\n                  </div>\r\n\r\n                  <div class=\"items\">\r\n            `);\r\n        } else if (!dtps.classes[i].group && previousClassGroup) {\r\n            dtps.classlist.push(`</div></div>`);\r\n        }\r\n\r\n        //Add class HTML to array\r\n        dtps.classlist.push(/*html*/`\r\n            <div \r\n                onclick=\"${'dtps.selectedClass = ' + i}\" \r\n                class=\"${'class item ' + i + ' ' + (dtps.selectedClass == i ? \" active\" : \"\")}\"\r\n                style=\"${'--classColor: ' + dtps.classes[i].color}\"\r\n            >\r\n                <i class=\"fluid-icon grade\">${letterGradeHTML}</i>\r\n                <span class=\"label\">${dtps.classes[i].subject}</span>\r\n            </div>\r\n        `);\r\n\r\n        previousClassGroup = dtps.classes[i].group;\r\n    }\r\n\r\n    if (previousClassGroup) dtps.classlist.push(`</div></div>`);\r\n\r\n    //Only render HTML if the sidebar doesn't already have the classes rendered, or if override is true\r\n    if (!jQuery(\".sidebar .class.dash\")[0] || override) {\r\n        jQuery(\".sidebar\").html(/*html*/`\r\n            <div class=\"title\">\r\n                <img src=\"${dtps.baseURL + \"/icon.svg\"}\" />\r\n                <h4>Power+</h4>\r\n            </div>\r\n            \r\n            <div class=\"items\">\r\n                <div onclick=\"dtps.selectedClass = 'dash';\" class=\"class item main dash ${dtps.selectedClass == \"dash\" ? \"active\" : \"\"}\">\r\n                    <i class=\"fluid-icon\">dashboard</i>    \r\n                    <span class=\"label\">Dashboard</span>\r\n                </div>\r\n\r\n                <div class=\"divider\"></div>\r\n\r\n                ${dtps.classlist.join(\"\")}\r\n            </div>\r\n\r\n            <div class=\"collapse\">\r\n                <i class=\"fluid-icon\"></i>\r\n            </div>\r\n        `);\r\n        fluid.init();\r\n\r\n        //Change view to stream if coming from pages or discussions, since those tabs change the sidebar\r\n        if ((dtps.selectedContent == \"pages\") || (dtps.selectedContent == \"discuss\")) {\r\n            //Show stream\r\n            if (dtps.classes[dtps.selectedClass]) fluid.screen('stream', dtps.classes[dtps.selectedClass].id);\r\n        }\r\n\r\n        //Class onclick listener\r\n        $(\".class:not(.overrideClass)\").click(function (event) {\r\n            //Load class content based on what's selected\r\n            if (((dtps.selectedContent == \"stream\") || (dtps.selectedContent == \"moduleStream\")) && dtps.classes[dtps.selectedClass]) {\r\n                if (dtps.classes[dtps.selectedClass].modules && (window.localStorage.getItem(\"courseworkPref-\" + dtps.classes[dtps.selectedClass].id) == \"moduleStream\")) {\r\n                    fluid.screen(\"moduleStream\", dtps.classes[dtps.selectedClass].id);\r\n                } else {\r\n                    fluid.screen(\"stream\", dtps.classes[dtps.selectedClass].id);\r\n                }\r\n            }\r\n\r\n            if ((dtps.selectedContent == \"people\") && dtps.classes[dtps.selectedClass]) {\r\n                fluid.screen(\"people\", dtps.classes[dtps.selectedClass].id);\r\n            }\r\n\r\n            if ((dtps.selectedContent == \"grades\") && dtps.classes[dtps.selectedClass]) {\r\n                if (dtps.classes[dtps.selectedClass].hasGradebook) {\r\n                    fluid.screen(\"gradebook\", dtps.classes[dtps.selectedClass].id);\r\n                } else {\r\n                    fluid.screen(\"stream\", dtps.classes[dtps.selectedClass].id);\r\n                }\r\n            }\r\n\r\n            if (dtps.selectedClass == \"dash\") {\r\n                fluid.screen(\"dashboard\");\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Renders the class header (color, name, tabs, etc.) and sets the class as the selected class\r\n * \r\n * @param {number|string} classNum The class number to load or \"dash\" if loading the dashboard\r\n */\r\ndtps.presentClass = function (classNum) {\r\n    //Set classNum as selected class\r\n    dtps.selectedClass = classNum;\r\n\r\n    //Update document title with class name\r\n    if (dtps.classes[classNum]) {\r\n        document.title = dtps.classes[classNum].subject + \" | Power+\";\r\n    } else {\r\n        document.title = \"Power+\";\r\n    }\r\n\r\n    //Set the class image\r\n    if ((fluid.get(\"pref-showClassImages\") !== \"false\") && dtps.classes[classNum] && dtps.classes[classNum].image) {\r\n        $(\".headerArea\").addClass(\"classImage\");\r\n        $(\".headerArea img\").attr(\"src\", dtps.classes[classNum].image);\r\n        $(\".headerArea img\").show();\r\n    } else {\r\n        $(\".headerArea\").removeClass(\"classImage\");\r\n        $(\".headerArea img\").hide();\r\n    }\r\n\r\n    //Remove active class from other classes in the sidebar, add the active class to the selected class\r\n    $(\".sidebar .class\").removeClass(\"active\");\r\n    $(\".class.\" + classNum).addClass(\"active\");\r\n\r\n    //Update title to show class name\r\n    //If the dashboard is selected, this is just \"Dashboard\". Otherwise, this is Class.subject\r\n    $(\"#headText span\").text(classNum == \"dash\" ? \"Dashboard\" : classNum == \"search\" ? \"Search Results\" : dtps.classes[classNum] && dtps.classes[classNum].subject);\r\n    var icon = classNum == \"dash\" ? \"dashboard\" : classNum == \"search\" ? \"search\" : dtps.classes[classNum] && dtps.classes[classNum].icon\r\n    if (icon) {\r\n        $(\"#headText i\").text(icon);\r\n        $(\"#headText i\").show();\r\n    } else {\r\n        $(\"#headText i\").hide();\r\n    }\r\n    $(\"#headText\").css(\"color\", (classNum == \"dash\") || (classNum == \"search\") ? \"var(--text)\" : dtps.classes[classNum] && dtps.classes[classNum].color);\r\n\r\n    //If the class doesn't exist, hide the tabs\r\n    //Otherwise, show the tabs\r\n    if (!dtps.classes[classNum]) {\r\n        $(\"#dtpsTabBar\").hide();\r\n        $(\"#classInfo p\").hide();\r\n    } else {\r\n        $(\"#dtpsTabBar\").show();\r\n    }\r\n\r\n    //Hide dashboard start date\r\n    if (classNum !== \"search\") $(\".headerArea .contentLabel\").hide();\r\n\r\n    //Clear search box if not on the search tab\r\n    if ((classNum !== \"search\") && !$(\"#dtpsMainSearchBox\").is(\":focus\")) {\r\n        $(\"#dtpsMainSearchBox\").val(\"\");\r\n    }\r\n\r\n    //Set search box content\r\n    dtps.setSearchBox();\r\n\r\n    if (dtps.classes[classNum]) {\r\n        //Show pages tab if the class supports it, otherwise, hide it\r\n        if (dtps.classes[classNum].pages) {\r\n            $(\".btns .btn.pages\").show();\r\n        } else {\r\n            $(\".btns .btn.pages\").hide();\r\n        }\r\n\r\n        //Show people tab if the LMS supports it, otherwise, hide it\r\n        if (dtps.classes[classNum].people) {\r\n            $(\".btns .btn.people\").show();\r\n        } else {\r\n            $(\".btns .btn.people\").hide();\r\n        }\r\n\r\n        //Show pages tab if the class supports it, otherwise, hide it\r\n        if (dtps.classes[classNum].discussions) {\r\n            $(\".btns .btn.discuss\").show();\r\n        } else {\r\n            $(\".btns .btn.discuss\").hide();\r\n        }\r\n\r\n        //Show gradebook if the LMS and the class supports it, otherwise, hide it\r\n        if ((dtpsLMS.genericGradebook || dtpsLMS.gradebook) && dtps.classes[classNum].hasGradebook) {\r\n            $(\".btns .btn.grades\").show();\r\n        } else {\r\n            $(\".btns .btn.grades\").hide();\r\n        }\r\n\r\n        //Hide tabs if only one tab is visible\r\n        if ($(\"#dtpsTabBar .btn:visible\").length < 2) {\r\n            $(\"#dtpsTabBar\").hide();\r\n        }\r\n\r\n        //Show teacher\r\n        if (dtps.classes[classNum].teacher) {\r\n            $(\"#classInfo .teacher .teacherName\").text(dtps.classes[classNum].teacher.name);\r\n            $(\"#classInfo .teacher .teacherImage\").css(\"background-image\", \"url('\" + dtps.classes[classNum].teacher.photoURL + \"')\");\r\n            $(\"#classInfo .teacher\").show();\r\n        } else {\r\n            $(\"#classInfo .teacher\").hide();\r\n        }\r\n\r\n        if (dtps.classes[classNum].homepage) {\r\n            $(\"#classInfo .homepage\").show();\r\n        } else {\r\n            $(\"#classInfo .homepage\").hide();\r\n        }\r\n\r\n        if (dtps.classes[classNum].videoMeetingURL) {\r\n            $(\"#classInfo .videoMeeting\").attr(\"onclick\", \"window.open('\" + dtps.classes[classNum].videoMeetingURL + \"')\");\r\n            $(\"#classInfo .videoMeeting\").removeClass(\"shimmerParent\");\r\n            $(\"#classInfo .videoMeeting\").show();\r\n        } else if ((dtps.classes[classNum].videoMeetingURL !== null) && dtpsLMS.fetchMeetingURL) {\r\n            $(\"#classInfo .videoMeeting\").attr(\"onclick\", \"\");\r\n            $(\"#classInfo .videoMeeting\").addClass(\"shimmerParent\");\r\n            $(\"#classInfo .videoMeeting\").show();\r\n\r\n            dtpsLMS.fetchMeetingURL(dtps.classes[classNum].lmsID).then(url => {\r\n                dtps.classes[classNum].videoMeetingURL = url;\r\n\r\n                if (dtps.selectedClass == classNum) {\r\n                    if (url) {\r\n                        $(\"#classInfo .videoMeeting\").attr(\"onclick\", \"window.open('\" + dtps.classes[classNum].videoMeetingURL + \"')\");\r\n                        $(\"#classInfo .videoMeeting\").removeClass(\"shimmerParent\");\r\n                        $(\"#classInfo .videoMeeting\").show();\r\n                    } else {\r\n                        $(\"#classInfo .videoMeeting\").hide();\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            $(\"#classInfo .videoMeeting\").hide();\r\n        }\r\n    }\r\n\r\n    console.log(dtps.selectedContent);\r\n    if (dtps.selectedContent !== \"grades\") $(\".classContent\").removeClass(\"fixedGradeSummary\");\r\n}\r\n\r\n/**\r\n * Displays the class homepage\r\n * \r\n * @param {number} num Class number to show the homepage for\r\n */\r\ndtps.classHome = function (num) {\r\n    //Render loading screen\r\n    $(\".card.details\").html(/*html*/`\r\n        <i onclick=\"fluid.cards.close('.card.details')\" class=\"fluid-icon close\">close</i>\r\n        <h3 style=\"font-weight: bold;\">${dtps.classes[num].subject} Homepage</h3>\r\n\r\n        <br />\r\n        <p>Loading...</p>\r\n    `);\r\n\r\n    //Fetch homepage from the LMS\r\n    dtpsLMS.fetchHomepage(dtps.classes[num].lmsID).then(homepage => {\r\n        if (homepage) {\r\n            //Get computed background and text color to style the iFrame with\r\n            var computedBackgroundColor = getComputedStyle($(\".card.details\")[0]).getPropertyValue(\"--cards\");\r\n            var computedTextColor = getComputedStyle($(\".card.details\")[0]).getPropertyValue(\"--text\");\r\n\r\n            if ($(\"body\").hasClass(\"dark\")) {\r\n                homepage = dtps.brightenTextForDarkMode(homepage, computedBackgroundColor);\r\n            }\r\n\r\n            if (dtpsLMS.dtech && dtps.remoteConfig.dtechHomepageFluidUITabs && ($('<div></div>').append(homepage).find(\".enhanceable_content.tabs>ul>li\").toArray().length > 1)) {\r\n                //Use special tab optimized homepage\r\n                var fragments = [];\r\n                $('<div></div>').append(homepage).find(\".enhanceable_content.tabs>ul>li\").toArray().forEach((fragment) => {\r\n                    var text = $(fragment).text().toLowerCase();\r\n                    if (!text) return;\r\n\r\n                    var id = $(fragment).find(\"a\").attr(\"href\").replace(\"#\", \"\");\r\n                    if (!id) return;\r\n\r\n                    var html = $(homepage).find(\"#\" + id).html();\r\n                    if (!html) return;\r\n\r\n                    var icon = null;\r\n                    if (text.includes(\"agenda\")) { icon = \"format_list_numbered\"; text = \"Agenda\"; }\r\n                    if (text.includes(\"instructor\")) { icon = \"person\"; text = \"Instructor\"; }\r\n                    if (text.includes(\"course info\")) { icon = \"info\"; text = \"Course Info\"; }\r\n                    if (text.includes(\"resources\")) { icon = \"article\"; text = \"Course Resources\"; }\r\n\r\n                    //Generate a blob with the assignment body and get its data URL\r\n                    var blob = new Blob([`\r\n                        <base target=\"_blank\" /> \r\n                        <link type=\"text/css\" rel=\"stylesheet\" href=\"https://cdn.jottocraft.com/CanvasCSS.css\" media=\"screen,projection\"/>\r\n                        <style>body {background-color: ${computedBackgroundColor}; color: ${computedTextColor};</style>\r\n                        ${html}\r\n                    `], { type: 'text/html' });\r\n                    var frameURL = window.URL.createObjectURL(blob);\r\n\r\n                    fragments.push({ text, id, icon, frameURL });\r\n                });\r\n\r\n                $(\".card.details\").html(/*html*/`\r\n                    <i onclick=\"fluid.cards.close('.card.details')\" class=\"fluid-icon close\">close</i>\r\n\r\n                    <h4 style=\"font-weight: bold;\">${dtps.classes[num].subject} Homepage</h4>\r\n\r\n                    <br />\r\n                    ${dtps.classes[num].videoMeetingURL ? `<button onclick=\"window.open('${dtps.classes[num].videoMeetingURL}')\" class=\"btn small\"><i class=\"fluid-icon\">videocam</i> Zoom</button>` : ``}\r\n                    <div class=\"btns row small\">\r\n                        ${fragments.map((fragment, i) => {\r\n                    return `<button onclick=\"$(this).addClass('active');$(this).siblings().removeClass('active');$('#homepageFragment').attr('src', '${fragment.frameURL}'); dtps.iframeLoad('homepageFragment');\" \r\n                                style=\"text-transform: capitalize;\" class=\"btn ${i == 0 ? \"active\" : \"\"}\">${fragment.icon ? `<i class=\"fluid-icon\">${fragment.icon}</i> ` : \"\"}${fragment.text}</button>`;\r\n                }).join(\"\")}\r\n                    </div>\r\n\r\n                    <br />\r\n                    <div style=\"margin-top: 20px;\" class=\"homepageBody\">\r\n                        <iframe id=\"homepageFragment\" onload=\"dtps.iframeLoad('homepageFragment')\" style=\"margin: 10px 0px; width: 100%; border: none; outline: none;\" src=\"${fragments[0].frameURL}\" />\r\n                    </div>\r\n                `);\r\n            } else {\r\n                //Generate a blob with the assignment body and get its data URL\r\n                var blob = new Blob([`\r\n                    <base target=\"_blank\" /> \r\n                    <link type=\"text/css\" rel=\"stylesheet\" href=\"https://cdn.jottocraft.com/CanvasCSS.css\" media=\"screen,projection\"/>\r\n                    <style>body {background-color: ${computedBackgroundColor}; color: ${computedTextColor};</style>\r\n                    ${homepage}\r\n                `], { type: 'text/html' });\r\n                var homepageURL = window.URL.createObjectURL(blob);\r\n\r\n                $(\".card.details\").html(/*html*/`\r\n                    <i onclick=\"fluid.cards.close('.card.details')\" class=\"fluid-icon close\">close</i>\r\n\r\n                    <h4 style=\"font-weight: bold;\">${dtps.classes[num].subject} Homepage</h4>\r\n\r\n                    <br />\r\n                    <div style=\"margin-top: 20px;\" class=\"homepageBody\">\r\n                        <iframe id=\"homepageIframe\" onload=\"dtps.iframeLoad('homepageIframe')\" style=\"margin: 10px 0px; width: 100%; border: none; outline: none;\" src=\"${homepageURL}\" />\r\n                    </div>\r\n                `);\r\n            }\r\n\r\n            fluid.cards(\".card.details\");\r\n        } else {\r\n            fluid.cards.close('.card.details');\r\n            dtps.error(\"Homepage unavailable\", \"homepage is either empty or undefined @ dtps.classHome\");\r\n        }\r\n    }).catch(e => {\r\n        dtps.error(\"Couldn't load homepage\", \"Caught a promise rejection @ dtps.classHome\", e);\r\n    })\r\n}\r\n\r\n/**\r\n * Shows the gradebook using HTML from dtpsLMS.gradebook\r\n * \r\n * @param {string} classID Class ID\r\n */\r\ndtps.showLMSGradebook = function (classID) {\r\n    //Get class index and set as selected class\r\n    var classNum = dtps.classes.map(course => course.id).indexOf(classID);\r\n    dtps.selectedClass = classNum;\r\n\r\n    //Set stream as the selected content\r\n    dtps.selectedContent = \"grades\";\r\n    $(\"#dtpsTabBar .btn\").removeClass(\"active\");\r\n    $(\"#dtpsTabBar .btn.grades\").addClass(\"active\");\r\n\r\n    //Load class color, name, etc.\r\n    dtps.presentClass(classNum);\r\n\r\n    //Ensure classes are shown in the sidebar\r\n    dtps.showClasses();\r\n\r\n    if (classNum == -1) {\r\n        //Class does not exist\r\n        dtps.error(\"The selected class doesn't exist\", \"classNum check failed @ dtps.showLMSGradebook\");\r\n    }\r\n\r\n    //Show loading indicator\r\n    if ((dtps.selectedContent == \"grades\") && (dtps.selectedClass == classNum)) {\r\n        jQuery(\".classContent\").html(`<div class=\"spinner\"></div>`);\r\n    }\r\n\r\n    //Function to load gradebook HTML\r\n    function renderGradebook() {\r\n        dtpsLMS.gradebook(dtps.classes[classNum]).then(html => {\r\n            if (html && (dtps.selectedClass == classNum) && (dtps.selectedContent == \"grades\")) {\r\n                $(\".classContent\").html(html);\r\n                if (dtpsLMS.gradebookDidRender) dtpsLMS.gradebookDidRender(dtps.classes[classNum]);\r\n            }\r\n        }).catch(function (err) {\r\n            dtps.error(\"Could not load the gradebook\", \"Caught promise rejection @ dtps.showLMSGradebook\", err);\r\n        });\r\n    }\r\n\r\n    if (!fluid.externalScreens.stream) {\r\n        //Load assignment functions first\r\n        jQuery.getScript(dtps.baseURL + \"/scripts/assignments.js\", () => {\r\n            renderGradebook();\r\n        })\r\n    } else {\r\n        renderGradebook();\r\n    }\r\n}\r\n\r\n/**\r\n * Shows a URL in the iFrame card\r\n * \r\n * @param {string} url The URL to load\r\n */\r\ndtps.showIFrameCard = function (url) {\r\n    //Remove any previous URLs\r\n    $('#CardIFrame').attr('src', '');\r\n\r\n    //Show iFrame card\r\n    fluid.cards('.card.iFrameCard');\r\n\r\n    //Load new URL\r\n    $('#CardIFrame').attr('src', url);\r\n}\r\n\r\n/**\r\n * Brightens text in an HTML string for dark mode\r\n * \r\n * @param {string} html The HTML to brighten text for\r\n * @param {string} [bg] The background color that the HTML will be displayed on\r\n * @returns {string} HTML string with brightened colors \r\n */\r\ndtps.brightenTextForDarkMode = function (html, bg) {\r\n    //Use dark mode algorithm\r\n    if (!bg) bg = \"black\";\r\n    var fakeRoot = $('<div></div>').append(html);\r\n    fakeRoot.find(\"span\").filter(function () {\r\n        return $(this).css(\"color\") && !($(this).css(\"background-color\") || $(this).css(\"background\")) && !$(this).parents().filter(function () {\r\n            return $(this).css(\"background-color\") || $(this).css(\"background\");\r\n        }).length;\r\n    }).toArray().forEach(element => {\r\n        //Brighten color\r\n        var brightness = tinycolor($(element).css(\"color\")).getBrightness() / 255 * 100;\r\n        var targetBrightness = (100 - (tinycolor(bg).getBrightness() / 255 * 100)) - brightness;\r\n        var brightnessDiff = targetBrightness - brightness;\r\n\r\n        if (brightnessDiff > 0) {\r\n            $(element).css(\"color\", \"#\" + tinycolor($(element).css(\"color\")).brighten(Math.abs(brightnessDiff)).toHex());\r\n        } else {\r\n            $(element).css(\"color\", \"#\" + tinycolor($(element).css(\"color\")).darken(Math.abs(brightnessDiff)).toHex());\r\n        }\r\n    });\r\n    return fakeRoot.html();\r\n}\r\n\r\n/**\r\n * Stores grade data locally for the previous grade feature\r\n * \r\n * @param classNum Class number to log grade\r\n */\r\ndtps.logGrades = function (classNum) {\r\n    /*\r\n        Grade change vars:\r\n        gradeHistory-ID: current|previous (e.g. \"A|B+\" represents a change of B+ -> A)\r\n        if there is only one grade, it is the current one\r\n    */\r\n    if (window.localStorage.getItem(\"gradeHistory-\" + dtps.classes[classNum].id)) {\r\n        var savedCurrent = window.localStorage.getItem(\"gradeHistory-\" + dtps.classes[classNum].id).split(\"|\")[0];\r\n        var savedPrevious = window.localStorage.getItem(\"gradeHistory-\" + dtps.classes[classNum].id).split(\"|\")[1];\r\n\r\n        if (savedCurrent !== dtps.classes[classNum].letter) {\r\n            //Grade change\r\n            window.localStorage.setItem(\"gradeHistory-\" + dtps.classes[classNum].id, dtps.classes[classNum].letter + \"|\" + savedCurrent);\r\n            dtps.classes[classNum].previousLetter = savedCurrent;\r\n        }\r\n\r\n        if ((savedCurrent == dtps.classes[classNum].letter) && savedPrevious) {\r\n            //Previous grade is already saved\r\n            dtps.classes[classNum].previousLetter = savedPrevious;\r\n        }\r\n    } else {\r\n        //No history yet, store current grade\r\n        window.localStorage.setItem(\"gradeHistory-\" + dtps.classes[classNum].id, dtps.classes[classNum].letter);\r\n    }\r\n}\r\n\r\n/**\r\n * Opens the settings page\r\n * \r\n * @param {boolean} [forceRerenderDashboard] If this is true, the dashboard settings will be re-rendered\r\n */\r\ndtps.settings = function (forceRerenderDashboard) {\r\n    //Render dashboard HTML if not already loaded\r\n    if (forceRerenderDashboard || ($(\"#leftDashboardColumn\").attr(\"loaded\") !== \"true\")) {\r\n        //Returns dashboard item HTML from a dashboard item array\r\n        function dashboardHTML(dashboardArray) {\r\n            return dashboardArray.map(dashboardItem => {\r\n                return /*html*/`\r\n                <div dashboardItem-id=\"${dashboardItem.id}\" style=\"height: ${dashboardItem.size * 1.7 + 50}px\" class=\"dashboardItem\">\r\n                    <h5>\r\n                        <i class=\"fluid-icon\">${dashboardItem.icon}</i>\r\n                        <span>${dashboardItem.name}</span>\r\n                    </h5>\r\n                </div>\r\n            `;\r\n            }).join(\"\");\r\n        }\r\n\r\n        //Render dashboard items\r\n        $(\"#leftDashboardColumn\").html(dashboardHTML(dtps.leftDashboard));\r\n        $(\"#rightDashboardColumn\").html(dashboardHTML(dtps.rightDashboard));\r\n\r\n        //Make dashboard items sortable\r\n        $(\".dashboardColumn\").sortable({\r\n            connectWith: \".dashboardColumn\",\r\n            update: function (e, ui) {\r\n                dtps.saveDashboardPrefs();\r\n            }\r\n        });\r\n\r\n        //Store loaded state to prevent reloading dashboard items\r\n        $(\"#leftDashboardColumn\").attr(\"loaded\", \"true\");\r\n    }\r\n\r\n    //Render grades tab in settings\r\n    if (dtps.remoteConfig.showGradesInSettings) dtps.renderGradesInSettings();\r\n\r\n    fluid.cards('.settingsCard');\r\n}\r\n\r\n/**\r\n * Shows a warning telling the user that they must reload for setting changes to take effect\r\n */\r\ndtps.settingsReloadWarning = function () {\r\n    $(\"#settingsReloadWarning\").show();\r\n}\r\n\r\n/**\r\n * Renders the grades tab in settings\r\n */\r\ndtps.renderGradesInSettings = function () {\r\n    //Render class grade bars\r\n    $(\"#classGradeBars\").html(dtps.classes.map(course => {\r\n        //Percentages below are for visualization purposes only\r\n        var percentage = 0;\r\n        if (course.letter == \"A\") percentage = 100;\r\n        if (course.letter == \"A-\") percentage = 91;\r\n        if (course.letter == \"B+\") percentage = 88;\r\n        if (course.letter == \"B\") percentage = 85;\r\n        if (course.letter == \"B-\") percentage = 81;\r\n        if (course.letter == \"C+\") percentage = 78;\r\n        if (course.letter == \"C\") percentage = 75;\r\n\r\n        return (\r\n            course.letter ? `<div style=\"cursor: auto; background-color: var(--elements);\" class=\"progressBar big\">\r\n        <div style=\"color: white;\" class=\"progressLabel\">${course.subject} (${course.letter})</div>\r\n        <div class=\"progress\" style=\"background-color: ${course.color}; width: calc(${percentage}% - 300px);\"></div></div>` : \"\"\r\n        )\r\n    }));\r\n\r\n    //Calculate GPA\r\n    var sum = 0;\r\n    var values = 0;\r\n\r\n    dtps.classes.forEach(course => {\r\n        if (course.letter == \"...\") {\r\n            sum = null;\r\n        } else if (course.letter && (sum !== null)) {\r\n            var points = 0;\r\n            if (course.letter == \"A\") points = 4;\r\n            if (course.letter == \"A-\") points = 3.7;\r\n            if (course.letter == \"B+\") points = 3.3;\r\n            if (course.letter == \"B\") points = 3;\r\n            if (course.letter == \"B-\") points = 2.7;\r\n            if (course.letter == \"C+\") points = 2.3;\r\n            if (course.letter == \"C\") points = 2.0;\r\n            if (course.letter == \"I\") points = 0;\r\n\r\n            sum += points;\r\n            values++;\r\n        }\r\n    })\r\n\r\n    if (sum == null) {\r\n        $(\"#dtpsGpaText\").text(\"...\");\r\n    } else {\r\n        $(\"#dtpsGpaText\").text((sum / values).toFixed(1));\r\n    }\r\n}\r\n\r\n/**\r\n * Saves dashboard prefrences\r\n */\r\ndtps.saveDashboardPrefs = function () {\r\n    var dashboardPrefs = [];\r\n\r\n    //Add dashboard items\r\n    for (var i = 0; i < $(\".dashboardColumn\").children().length; i++) {\r\n        //Get HTML item\r\n        var child = $($(\".dashboardColumn\").children()[i]);\r\n\r\n        //Add item to dashboardPrefs array\r\n        dashboardPrefs.push({\r\n            id: child.attr(\"dashboardItem-id\"),\r\n            side: child.parent().attr(\"id\").includes(\"left\") ? \"left\" : \"right\"\r\n        });\r\n    }\r\n\r\n    //Save to local storage\r\n    window.localStorage.setItem(\"dtpsDashboardItems\", JSON.stringify(dashboardPrefs));\r\n\r\n    //Reload dashboard items\r\n    dtps.loadDashboardPrefs();\r\n}\r\n\r\n/**\r\n * Resets dashboard prefrences\r\n */\r\ndtps.resetDashboardPrefs = function () {\r\n    //Remove dashboard pref from localStorage\r\n    window.localStorage.removeItem(\"dtpsDashboardItems\");\r\n\r\n    //Reload dashboard items\r\n    dtps.loadDashboardPrefs();\r\n\r\n    //Re-render dashboard\r\n    dtps.settings(true);\r\n}\r\n\r\n/**\r\n * Redirects to DTPS classic edition\r\n */\r\ndtps.classicEntry = function () {\r\n    var classicName = [\"P\", \"r\", \"o\", \"j\", \"e\", \"c\", \"t\", \" \", \"D\", \"T\", \"P\", \"S\"];\r\n    var overwrittenHTML = [\"P\", \"o\", \"w\", \"e\", \"r\", \"+\"];\r\n    if (dtps.classicStep == undefined) dtps.classicStep = -10;\r\n    dtps.classicStep++;\r\n\r\n    if (dtps.classicStep == 12) window.location.href = \"/power+?classicEdition=true\";\r\n\r\n    for (var i = 0; i < dtps.classicStep; i++) {\r\n        overwrittenHTML[i] = classicName[i];\r\n    }\r\n\r\n    $(\"#dtpsAboutName\").html(overwrittenHTML.join(\"\"));\r\n}\r\n\r\n/**\r\n * Loads dashboard prefrences\r\n */\r\ndtps.loadDashboardPrefs = function () {\r\n    //Define left and right dashboard columns\r\n    dtps.leftDashboard = [];\r\n    dtps.rightDashboard = [];\r\n\r\n    //Add items to dashboard columns\r\n    if (window.localStorage.dtpsDashboardItems) {\r\n        //Add from user prefs\r\n\r\n        //Parse JSON\r\n        var dashboardPref = JSON.parse(window.localStorage.dtpsDashboardItems);\r\n\r\n        //Generate arrays of dashboard item IDs\r\n        var dashboardIDs = dtps.dashboardItems.map(item => item.id);\r\n\r\n        //Add items to dashboard according to prefs\r\n        dashboardPref.forEach(dashboardItemPref => {\r\n            if (dashboardIDs.includes(dashboardItemPref.id)) {\r\n                //Get item index based on dashboardIDs array\r\n                var itemIndex = dashboardIDs.indexOf(dashboardItemPref.id);\r\n\r\n                //Get item from dtps.dashboardItems array\r\n                var dashboardItem = dtps.dashboardItems[itemIndex];\r\n\r\n                //Add item to dashboard\r\n                if (dashboardItemPref.side == \"left\") {\r\n                    dtps.leftDashboard.push(dashboardItem);\r\n                } else if (dashboardItemPref.side == \"right\") {\r\n                    dtps.rightDashboard.push(dashboardItem);\r\n                }\r\n            }\r\n        });\r\n    } else {\r\n        //Add from defaults\r\n        dtps.dashboardItems.forEach(dashboardItem => {\r\n            if (dashboardItem.defaultSide == \"left\") {\r\n                dtps.leftDashboard.push(dashboardItem);\r\n            } else if (dashboardItem.defaultSide == \"right\") {\r\n                dtps.rightDashboard.push(dashboardItem);\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\n/**\r\n * Renders initial static DTPS HTML\r\n */\r\ndtps.render = function () {\r\n    //Remove all existing link tags and LMS head content\r\n    $(\"link:not(.dtpsHeadItem)\").remove();\r\n    $(\"head *:not(.dtpsHeadItem)\").remove();\r\n\r\n    //Set default body classes\r\n    $(\"body\").attr(\"class\", \"dark showThemeWindows hasSidebar hasNavbar dashboard\");\r\n\r\n    //Set document title and favicon\r\n    document.title = \"Power+\";\r\n    jQuery(\"<link/>\", {\r\n        rel: \"shortcut icon\",\r\n        type: \"image/png\",\r\n        href: dtps.baseURL + \"/favicon.png\"\r\n    }).appendTo(\"head\");\r\n\r\n    //Remove existing LMS HTML (excluding DTPS loading screen HTML)\r\n    jQuery(\"body *:not(#dtpsNativeOverlay):not(#dtpsNativeOverlay *)\").remove();\r\n\r\n    //Render HTML\r\n    jQuery(\"body\").append(/*html*/`\r\n        <div class=\"sidebar\"></div>        \r\n\r\n        <div class=\"navbar\">\r\n          <div class=\"logo\">\r\n            <img src=\"${dtps.baseURL + \"/icon.svg\"}\" />\r\n            <h4>${dtps.baseURL == \"https://dev.dtps.jottocraft.com\" ? \"Power+ (dev)\" : \"Power+\"}</h4>\r\n          </div>\r\n        \r\n          ${dtps.unstable ? `\r\n            <div id=\"dtpsUnstable\" class=\"navitem\">\r\n              <i style=\"font-size: 16px;\" class=\"fluid-icon\">warning</i>\r\n              <span style=\"font-weight: bold; font-size: 10px;\">THIS IS AN UNSTABLE VERSION OF POWER+. USE AT YOUR OWN RISK.</span>\r\n            </div>\r\n          ` : \"\"}\r\n          \r\n          <div class=\"items\" id=\"dtpsFixedSearch\">\r\n            <i class=\"inputIcon fluid-icon\">search</i>\r\n            <input id=\"dtpsMainSearchBox\" style=\"margin: 0px; width: 500px;\" type=\"search\" class=\"inputIcon filled\" placeholder=\"Search\" />\r\n          </div>\r\n\r\n          <div class=\"profile\">\r\n            <div class=\"profileImage\"></div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"card profileMenu\">\r\n          <div class=\"person\">\r\n            <div class=\"profileImage\"></div>\r\n            <div class=\"info\">\r\n              <h5 class=\"name\">Logged out</h5>\r\n            </div>\r\n          </div>\r\n\r\n          <div class=\"actions\">\r\n            <div class=\"item\">\r\n              <i class=\"fluid-icon\">feedback</i>\r\n              <span class=\"label\">Feedback</span>\r\n            </div>\r\n            ${dtps.remoteConfig.showBugReportButton || dtps.unstable || (dtps.env == \"dev\") ? /*html*/`\r\n                <div class=\"item\">\r\n                    <i class=\"fluid-icon\">bug_report</i>\r\n                    <span class=\"label\">Bug Report</span>\r\n                </div>\r\n            ` : \"\"}\r\n            <div onclick=\"dtps.settings();\" class=\"item\">\r\n              <i class=\"fluid-icon\">settings</i>\r\n              <span class=\"label\">Settings</span>\r\n            </div>\r\n            <div class=\"divider\"></div>\r\n            <a style=\"color: var(--text);\" href=\"/\">\r\n                <div class=\"item\">\r\n                  <i class=\"fluid-icon\">exit_to_app</i>\r\n                  <span class=\"label\">Go to Canvas</span>\r\n                </div>\r\n            </a>\r\n          </div>\r\n        </div>\r\n\r\n        <div id=\"dtpsSearchResults\" class=\"card acrylicMaterial\" style=\"display: none;\">\r\n            <h5 id=\"dtpsSearchStatus\"><i class=\"fluid-icon\">search</i> <span>Search</span></h5>\r\n            <div id=\"dtpsSearchData\" style=\"display: none;\"></div>\r\n            <div id=\"dtpsSearchInfo\">\r\n                <p>By defualt, Power+ will search based on the page you're on. You can use the keywords below for more advanced searches:</p>\r\n                <div class=\"grid samesize\">\r\n                    <div class=\"item\">\r\n                        <p><i class=\"fluid-icon\">library_books</i> type:coursework</p>\r\n                        <p><i class=\"fluid-icon\">view_module</i> type:module</p>\r\n                        <p><i class=\"fluid-icon\">assignment</i> type:assignment</p>\r\n                        <p><i class=\"fluid-icon\">assessment</i> type:grade</p>\r\n                        <p><i class=\"fluid-icon\">announcement</i> type:announcement</p>\r\n                    </div>\r\n                    <div class=\"item\">\r\n                        <p><i class=\"fluid-icon\">home</i> type:homepage</p>\r\n                        <p><i class=\"fluid-icon\">insert_drive_file</i> type:page</p>\r\n                        <p><i class=\"fluid-icon\">forum</i> type:discussion</p>\r\n                        <p><i class=\"fluid-icon\">people</i> type:person</p>\r\n                        <div class=\"divider\"></div>\r\n                        <p><i class=\"fluid-icon\">class</i> class:English</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n\r\n        <div class=\"headerArea classImage\">\r\n          <img style=\"display: none;\" />\r\n          <div class=\"content\">\r\n            <h1 id=\"headText\"><i class=\"fluid-icon\">dashboard</i> <span>Dashboard</span></h1>\r\n            <div id=\"classInfo\" style=\"min-height: 18px;\">\r\n              <p class=\"teacher\" style=\"display: none;\">\r\n                <span class=\"teacherImage\"></span> <span class=\"teacherName\"></span>\r\n              </p>\r\n              <p onclick=\"dtps.classHome(dtps.selectedClass);\" class=\"homepage\" style=\"cursor: pointer; display: none;\">\r\n                <i class=\"fluid-icon\">home</i> <span>Homepage</span>\r\n              </p>\r\n              <p class=\"videoMeeting\" style=\"cursor: pointer; display: none;\">\r\n                <i class=\"fluid-icon\">videocam</i> <span>Meeting</span>\r\n              </p>\r\n              <p class=\"contentLabel\" style=\"display: none;\">\r\n                <i class=\"fluid-icon\"></i> <span></span>\r\n              </p>\r\n            </div>\r\n            <div style=\"display: none;\" id=\"dtpsTabBar\" class=\"btns\">\r\n                <button init=\"true\" onclick=\"if (dtps.classes[dtps.selectedClass].modules && (window.localStorage.getItem('courseworkPref-' + dtps.classes[dtps.selectedClass].id) == 'moduleStream')) { fluid.screen('moduleStream', dtps.classes[dtps.selectedClass].id); } else { fluid.screen('stream', dtps.classes[dtps.selectedClass].id); }\" class=\"btn stream\">\r\n                    <i class=\"fluid-icon\">library_books</i>\r\n                    Coursework\r\n                </button>\r\n                <button init=\"true\" onclick=\"fluid.screen('people', dtps.classes[dtps.selectedClass].id);\" class=\"btn people\">\r\n                    <i class=\"fluid-icon\">people</i>\r\n                    People\r\n                </button>\r\n                <button init=\"true\" onclick=\"fluid.screen('discussions', dtps.classes[dtps.selectedClass].id);\" class=\"btn discuss\">\r\n                    <i class=\"fluid-icon\">forum</i>\r\n                    Discussions\r\n                </button>\r\n                <button init=\"true\" onclick=\"fluid.screen('pages', dtps.classes[dtps.selectedClass].id);\" class=\"btn pages\">\r\n                    <i class=\"fluid-icon\">insert_drive_file</i>\r\n                    Pages\r\n                </button>\r\n                <button init=\"true\" onclick=\"fluid.screen('gradebook', dtps.classes[dtps.selectedClass].id);\" class=\"btn grades\">\r\n                    <i class=\"fluid-icon\">assessment</i>\r\n                    ${dtpsLMS.gradebook ? \"Grades\" : \"Gradebook\"}\r\n                </button>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <!-- Class content area -->\r\n        <div class=\"classContent\">\r\n            <div class=\"spinner\"></div>\r\n        </div>\r\n\r\n        <!-- Settings card (its inner HTML is added later) -->\r\n        <div style=\"height: 100%; overflow: auto !important;\" class=\"card withnav focus close container settingsCard\"></div>\r\n\r\n        <!-- Changelog card -->\r\n        <div style=\"border-radius: 30px;\" class=\"card focus changelog close container\">\r\n            <i onclick=\"fluid.cards.close('.card.changelog')\" class=\"fluid-icon close\">close</i>\r\n            <h3>What's new in Power+</h3>\r\n            <h5>Loading...</h5>\r\n        </div>\r\n\r\n        <!-- General details card for assignments, outcomes, class info, etc. -->\r\n        <div style=\"border-radius: 30px;\" class=\"card focus details close container\">\r\n            <i onclick=\"fluid.cards.close('.card.details')\" class=\"fluid-icon close\">close</i>\r\n            <p>An error occured</p>\r\n        </div>\r\n\r\n        <!-- General iFrame card (with white background) -->\r\n        <div style=\"border-radius: 30px; top: 50px; background-color: white; color: black;\" class=\"card focus close iFrameCard container\">\r\n            <i style=\"color: black !important;\" onclick=\"fluid.cards.close('.card.iFrameCard'); $('#CardIFrame').attr('src', '');\" class=\"fluid-icon close\">close</i>\r\n            <br /><br />\r\n            <iframe style=\"width: 100%; height: calc(100vh - 175px); border: none;\" id=\"CardIFrame\"></iframe>\r\n        </div>\r\n    `);\r\n\r\n    $(\"#dtpsMainSearchBox\").on(\"focus\", function () {\r\n        $(\"#dtpsSearchResults\").show();\r\n    });\r\n\r\n    $(\"#dtpsMainSearchBox\").on(\"blur\", function () {\r\n        $(\"#dtpsSearchResults\").hide();\r\n    });\r\n\r\n    $(\"#dtpsMainSearchBox\").on(\"input\", function () {\r\n        dtps.setSearchBox();\r\n    });\r\n\r\n    $(document).on(\"keydown\", \"#dtpsMainSearchBox\", function (e) {\r\n        if (e.key == \"Enter\") {\r\n            //Validate input and tags\r\n            var term = $(\"#dtpsMainSearchBox\").val().replace(/(type|class):[a-z]*/gi, \"\").trim();\r\n            if ($(\"#dtpsMainSearchBox\").attr(\"data-search-type\") && $(\"#dtpsMainSearchBox\").attr(\"data-dtps-course\")) {\r\n                fluid.screen(\"search\", {\r\n                    term: term,\r\n                    type: $(\"#dtpsMainSearchBox\").attr(\"data-search-type\"),\r\n                    course: $(\"#dtpsMainSearchBox\").attr(\"data-dtps-course\"),\r\n                    ctxType: $(\"#dtpsMainSearchBox\").attr(\"data-ctx-type\"),\r\n                    ctxCourse: $(\"#dtpsMainSearchBox\").attr(\"data-ctx-course\")\r\n                });\r\n                $(\"#dtpsMainSearchBox\").blur();\r\n            }\r\n        }\r\n    });\r\n}\r\n\r\n/**\r\n * Sets the search box text based on the current page or keywords\r\n */\r\ndtps.setSearchBox = function () {\r\n    var value = $(\"#dtpsMainSearchBox\").val() || \"\";\r\n\r\n    var type = null;\r\n    var course = dtps.selectedClass == \"dash\" ? \"dash\" : dtps.classes[dtps.selectedClass];\r\n    var icon = null;\r\n    var error = false;\r\n    var autoType = null;\r\n    var autoCourse = dtps.selectedClass == \"dash\" ? \"dash\" : dtps.classes[dtps.selectedClass];\r\n\r\n    //Get automatic type from selected content\r\n    if (dtps.selectedContent == \"people\") type = \"people\";\r\n    if (dtps.selectedContent == \"discuss\") type = \"discussions\";\r\n    if (dtps.selectedContent == \"pages\") type = \"pages\";\r\n    if (dtps.selectedContent == \"grades\") type = \"grades\";\r\n    if ((dtps.selectedClass == \"dash\") || (dtps.selectedContent == \"stream\") || (dtps.selectedContent == \"moduleStream\")) type = \"coursework\";\r\n    autoType = type;   \r\n    \r\n    //Reuse auto type if on search\r\n    if (dtps.selectedClass == \"search\") {\r\n        type = $(\"#dtpsMainSearchBox\").attr(\"data-ctx-type\");\r\n        course = $(\"#dtpsMainSearchBox\").attr(\"data-ctx-course\");\r\n        if (!isNaN(Number(course))) course = dtps.classes[course];\r\n    }\r\n\r\n    //Check for type override from search box\r\n    if (value.split(\" \").includes(\"type:coursework\")) type = \"coursework\";\r\n    if (value.split(\" \").includes(\"type:homepage\")) type = \"homepages\";\r\n    if (value.split(\" \").includes(\"type:page\")) type = \"pages\";\r\n    if (value.split(\" \").includes(\"type:discussion\")) type = \"discussions\";\r\n    if (value.split(\" \").includes(\"type:grade\")) type = \"grades\";\r\n    if (value.split(\" \").includes(\"type:person\")) type = \"people\";\r\n    if (value.split(\" \").includes(\"type:assignment\")) type = \"assignments\";\r\n    if (value.split(\" \").includes(\"type:module\")) type = \"modules\";\r\n    if (value.split(\" \").includes(\"type:announcement\")) type = \"announcements\";\r\n    if (value.split(\" \").includes(\"type:all\")) type = \"everything\";\r\n\r\n    //Get icon from final type\r\n    if (type == \"coursework\") icon = \"library_books\";\r\n    if (type == \"people\") icon = \"people\";\r\n    if (type == \"discussions\") icon = \"forum\";\r\n    if (type == \"pages\") icon = \"insert_drive_file\";\r\n    if (type == \"grades\") icon = \"assessment\";\r\n    if (type == \"assignments\") icon = \"assignment\";\r\n    if (type == \"modules\") icon = \"view_module\";\r\n    if (type == \"homepages\") icon = \"home\";\r\n    if (type == \"announcements\") icon = \"announcement\";\r\n    if (type == \"everything\") icon = \"warning\";\r\n\r\n    //Check for course override from search box\r\n    if (value.includes(\"class:\")) {\r\n        var partialSubject = value.split(\"class:\")[1].split(\" \")[0].toLowerCase();\r\n        if (partialSubject == \"all\") {\r\n            course = \"all\";\r\n        } else if (partialSubject) {\r\n            dtps.classes.forEach(c => {\r\n                if (c.subject.toLowerCase().includes(partialSubject)) {\r\n                    course = c;\r\n                }\r\n            });\r\n        }\r\n    }\r\n\r\n    //Check if the course supports the type\r\n    if ((course !== \"dash\") && (course !== \"all\")) {\r\n        if ((type == \"pages\") && !course.pages) error = true;\r\n        if ((type == \"discussions\") && !course.discussions) error = true;\r\n        if ((type == \"modules\") && !course.modules) error = true;\r\n        if ((type == \"homepages\") && !course.homepage) error = true;\r\n        if ((type == \"people\") && !course.people) error = true;\r\n    }\r\n\r\n    if ((course == \"dash\") || (course == \"all\")) {\r\n        $(\"#dtpsSearchStatus i\").text(icon);\r\n        $(\"#dtpsSearchStatus span\").text(\"Search \" + (type == \"everything\" ? type : \"all \" + type));\r\n        $(\"#dtpsMainSearchBox\").attr(\"placeholder\", \"Search \" + (type == \"everything\" ? type : \"all \" + type));\r\n        $(\"#dtpsMainSearchBox\").attr(\"data-dtps-course\", \"all\");\r\n        $(\"#dtpsMainSearchBox\").attr(\"data-search-type\", type);\r\n    } else if (error) {\r\n        $(\"#dtpsSearchStatus i\").text(\"error\");\r\n        $(\"#dtpsSearchStatus span\").html(`Cannot search for ${type} in <b style=\"color: ${course.color};\">${course.subject}</b>`);\r\n        $(\"#dtpsMainSearchBox\").attr(\"placeholder\", \"Cannot search for \" + type + \" in \" + course.subject);\r\n        $(\"#dtpsMainSearchBox\").attr(\"data-dtps-course\", \"\");\r\n        $(\"#dtpsMainSearchBox\").attr(\"data-search-type\", \"\");\r\n    } else if (course || true) {\r\n        $(\"#dtpsSearchStatus i\").text(icon);\r\n        $(\"#dtpsSearchStatus span\").html(`Search ${type} in <b style=\"color: ${course.color};\">${course.subject}</b>`);\r\n        $(\"#dtpsMainSearchBox\").attr(\"placeholder\", \"Search \" + type + \" in \" + course.subject);\r\n        $(\"#dtpsMainSearchBox\").attr(\"data-dtps-course\", course.num);\r\n        $(\"#dtpsMainSearchBox\").attr(\"data-search-type\", type);\r\n    }\r\n\r\n    //Set auto type\r\n    if (dtps.selectedClass !== \"search\") {\r\n        $(\"#dtpsMainSearchBox\").attr(\"data-ctx-type\", autoType);\r\n        $(\"#dtpsMainSearchBox\").attr(\"data-ctx-course\", autoCourse == \"dash\" ? \"dash\" : autoCourse.num);\r\n    }\r\n}\r\n\r\n/**\r\n * Renders basic content after the user has been loaded\r\n */\r\ndtps.renderLite = function () {\r\n    //Add hideGrades body class if enabled and preference listener\r\n    if (fluid.get(\"pref-hideGrades\") == \"true\") { jQuery('body').addClass('hidegrades'); }\r\n    document.addEventListener(\"pref-hideGrades\", function (e) {\r\n        if ((e.detail == \"true\") || (e.detail == true)) {\r\n            //hideGrades has been enabled, add class to body to hide grades via CSS\r\n            jQuery('body').addClass('hidegrades');\r\n        } else {\r\n            //hideGrades has been disabled, remove class from body to show grades\r\n            jQuery('body').removeClass('hidegrades');\r\n        }\r\n    });\r\n\r\n    //Render settings card\r\n    var baseHost = new URL(dtps.baseURL).hostname;\r\n    jQuery(\".card.settingsCard\").html(/*html*/`\r\n        <i onclick=\"fluid.cards.close('.card.settingsCard')\" class=\"fluid-icon close\">close</i>\r\n\r\n        <div style=\"position: fixed; height: calc(100% - 100px);\" class=\"sidenav\">\r\n            <div class=\"title\">\r\n\t            <img src=\"${dtps.baseURL + \"/icon.svg\"}\" style=\"width: 50px;vertical-align: middle;padding: 7px; padding-top: 14px;\" />\r\n\t            <div style=\"vertical-align: middle; display: inline-block;\">\r\n                    <h5 style=\"font-weight: bold;display: inline-block;vertical-align: middle;\">Power+</h5>\r\n                    <p>${dtps.readableVer + (dtps.unstable ? ` <span style=\"font-size: 12px; color: red;\">(unstable)</span>` : \"\")}</p>\r\n\t            </div>\r\n            </div>\r\n\r\n            <div onclick=\"$('.abtpage').hide();$('.abtpage.settings').show();\" class=\"item active\">\r\n                <i class=\"fluid-icon\">settings</i> Settings\r\n            </div>\r\n            ${dtps.remoteConfig.useV5ThemeSelectionUI ? /*html*/`\r\n                <div onclick=\"$('.abtpage').hide();$('.abtpage.theme').show();\" class=\"item\">\r\n                    <i class=\"fluid-icon\">format_paint</i> Theme\r\n                </div>\r\n            ` : \"\"}\r\n            ${dtps.remoteConfig.showGradesInSettings ? /*html*/`\r\n                <div onclick=\"$('.abtpage').hide();$('.abtpage.grades').show();\" class=\"item\">\r\n                    <i class=\"fluid-icon\">assessment</i> Grades\r\n                </div>\r\n            ` : ``}\r\n            <div onclick=\"$('.abtpage').hide();$('.abtpage.dashboard').show();\" class=\"item\">\r\n                <i class=\"fluid-icon\">dashboard</i> Dashboard\r\n            </div>\r\n            ${dtps.env == \"dev\" ? /*html*/`\r\n                <div onclick=\"$('.abtpage').hide();$('.abtpage.debugging').show();\" class=\"item\">\r\n                    <i class=\"fluid-icon\">bug_report</i> Debugging\r\n                </div>\r\n                <div onclick=\"$('.abtpage').hide();$('.abtpage.experiments').show();\" class=\"item\">\r\n                    <i class=\"fluid-icon\">science</i> Experiments\r\n                </div>\r\n            ` : ``}\r\n            <div onclick=\"$('.abtpage').hide();$('.abtpage.about').show();\" class=\"item abt\">\r\n                <i class=\"fluid-icon\">info</i> About\r\n            </div>\r\n        </div>\r\n\r\n        <div style=\"min-height: 100%\" class=\"content\">\r\n            <div class=\"abtpage settings\">\r\n                <h5><b>Settings</b></h5>\r\n\r\n                <p style=\"display: none;\" id=\"settingsReloadWarning\">You must reload for the changes you've made to take effect</p>\r\n\r\n                ${!dtps.remoteConfig.useV5ThemeSelectionUI ? /*html*/`\r\n                    <br />\r\n                    <p>Theme</p>\r\n                    <div class=\"btns row themeSelector\"></div>\r\n                    <br />\r\n                ` : \"\"}\r\n                \r\n                <br />\r\n                <p>Sidebar</p>\r\n\r\n                <div onclick=\"fluid.set('pref-hideGrades');\" class=\"switch pref-hideGrades\"><span class=\"head\"></span></div>\r\n                <div class=\"label\"><i class=\"fluid-icon\">visibility_off</i> Hide class grades</div>\r\n\r\n                ${dtpsLMS.dtech && !dtps.user.parent ? /*html*/`\r\n                        <br /><br />\r\n                        <div onclick=\"fluid.set('pref-autoGroupClasses'); dtps.settingsReloadWarning();\" class=\"switch pref-autoGroupClasses active\"><span class=\"head\"></span></div>\r\n                        <div class=\"label\"><i class=\"fluid-icon\">sort</i> Automatically group and sort classes</div>\r\n                    ` : \"\"\r\n                }\r\n\r\n                <br /><br />\r\n                <p>Classes</p>\r\n\r\n                <div onclick=\"fluid.set('pref-fullNames'); dtps.settingsReloadWarning();\" class=\"switch pref-fullNames\"><span class=\"head\"></span></div>\r\n                <div class=\"label\"><i class=\"fluid-icon\">title</i> Show full class names</div>\r\n                    \r\n                <br /><br />\r\n                <div onclick=\"fluid.set('pref-hideClassImages')\" class=\"switch pref-hideClassImages\"><span class=\"head\"></span></div>\r\n                <div class=\"label\"><i class=\"fluid-icon\">image</i> Hide class images</div>\r\n\r\n                ${dtpsLMS.dtech ? /*html*/`\r\n                        <br /><br />\r\n                        <p>Assignments</p>\r\n\r\n                        <div onclick=\"fluid.set('pref-formatAssignmentContent');\" class=\"switch pref-formatAssignmentContent active\"><span class=\"head\"></span></div>\r\n                        <div class=\"label\"><i class=\"fluid-icon\">format_paint</i> Reformat assignment content</div>\r\n                    ` : \"\"\r\n                }\r\n\r\n                <div id=\"dtpsPrereleaseTesting\" style=\"${window.localStorage.prereleaseEnabled || (dtps.env == \"dev\") || window.localStorage.githubRepo || window.localStorage.externalReleaseURL ? \"\" : \"display: none;\"}\">\r\n                    <br /><br />\r\n                    <p>Prerelease testing</p>\r\n\r\n                    <div>\r\n                        <div class=\"btns row small\">\r\n                            <button \r\n                                onclick=\"window.localStorage.setItem('dtpsLoaderPref', 'prod')\" \r\n                                class=\"btn ${![\"dev\", \"github\", \"external\", \"local\"].includes(window.localStorage.dtpsLoaderPref) ? \"active\" : \"\"}\">\r\n                                <i class=\"fluid-icon\">label</i> Production\r\n                            </button>\r\n                            <button \r\n                                onclick=\"window.localStorage.setItem('dtpsLoaderPref', 'dev')\" \r\n                                class=\"btn ${window.localStorage.dtpsLoaderPref == \"dev\" ? \"active\" : \"\"}\">\r\n                                <i class=\"fluid-icon\">feedback</i> Dev\r\n                            </button>\r\n                            ${window.localStorage.githubRepo ? /*html*/`\r\n                                <button \r\n                                    onclick=\"window.localStorage.setItem('dtpsLoaderPref', 'github')\" \r\n                                    class=\"btn ${window.localStorage.dtpsLoaderPref == \"github\" ? \"active\" : \"\"}\">\r\n                                    <i class=\"fluid-icon\">account_tree</i> Branch\r\n                                </button>\r\n                            ` : ``}\r\n                            ${window.localStorage.externalReleaseURL ? /*html*/`\r\n                                <button \r\n                                    onclick=\"window.localStorage.setItem('dtpsLoaderPref', 'external')\" \r\n                                    class=\"btn ${window.localStorage.dtpsLoaderPref == \"external\" ? \"active\" : \"\"}\">\r\n                                    <i class=\"fluid-icon\">public</i> External\r\n                                </button>\r\n                            ` : ``}\r\n                            <button\r\n                                onclick=\"window.localStorage.setItem('dtpsLoaderPref', 'local')\" \r\n                                class=\"btn ${window.localStorage.dtpsLoaderPref == \"local\" ? \"active\" : \"\"}\">\r\n                                <i class=\"fluid-icon\">developer_board</i> Local\r\n                            </button>\r\n                        </div>\r\n                    </div>\r\n                </div>\r\n\r\n            </div>\r\n\r\n            ${dtps.remoteConfig.useV5ThemeSelectionUI ? /*html*/`\r\n                <div style=\"display: none;\" class=\"abtpage theme\">\r\n                    <h5><b>Theme</b></h5>\r\n                    <br />\r\n                    <div class=\"themeSelectionUI flat\"></div>\r\n                </div>\r\n            ` : \"\"}\r\n\r\n            <div style=\"display: none;\" class=\"abtpage grades\">\r\n                <h5><b>Grades</b></h5>\r\n                \r\n                <br />\r\n\r\n                <div>\r\n                <h6>Estimated GPA: <b id=\"dtpsGpaText\">...</b></h6>\r\n                <p style=\"color: var(--secText);\"><i>This GPA calculation is unofficial and does not account for honors credit</i></p>\r\n                </div>\r\n                \r\n                <br />\r\n\r\n                <div id=\"classGradeBars\"></div>\r\n            </div>\r\n\r\n            <div style=\"display: none;\" class=\"abtpage dashboard\">\r\n                <h5><b>Dashboard</b></h5>\r\n                <p>You can rearrange the items shown on the dashboard by dragging them below. You might have to reload Power+ for changes to take effect.</p>\r\n\r\n                <button onclick=\"dtps.resetDashboardPrefs();\" class=\"btn small\"><i class=\"fluid-icon\">refresh</i> Reset dashboard layout</button>\r\n\r\n                <br />\r\n                \r\n                <div id=\"leftDashboardColumn\" class=\"dashboardColumn\"></div>\r\n\r\n                <div id=\"rightDashboardColumn\" class=\"dashboardColumn\"></div>\r\n            </div>\r\n\r\n            ${dtps.env == \"dev\" ? /*html*/`\r\n                <div style=\"display: none;\" class=\"abtpage debugging\">\r\n                   <h5><b>Debugging</b></h5>\r\n                   <p>These settings are for development only and might break Power+. Use at your own risk.</p>\r\n\r\n                   <div>\r\n                    <button onclick=\"dtps.firstrun()\" class=\"btn small\"><i class=\"fluid-icon\">web_asset</i> Show firstrun screen</button>\r\n                   </div>\r\n\r\n                   <br /><br />\r\n\r\n                   <h5>Release configuration</h5>\r\n\r\n                   <button onclick=\"['dtpsLoaderPref', 'prereleaseEnabled', 'githubRepo', 'externalReleaseURL', 'dtpsLMSOverride'].forEach(k => window.localStorage.removeItem(k)); window.location.reload();\" class=\"btn small\"><i class=\"fluid-icon\">cancel</i> Clear release configurations</button>\r\n                   <br /><br />\r\n\r\n                   <div>\r\n                       <input id=\"dtpsGithubRepo\" value=\"${window.localStorage.githubRepo || \"\"}\" placeholder=\"Branch GitHub repo\" />\r\n                       <button class=\"btn small\" onclick=\"window.localStorage.setItem('githubRepo', $('#dtpsGithubRepo').val())\"><i class=\"fluid-icon\">save</i> Save</button>\r\n                   </div>\r\n\r\n                   <div>\r\n                       <input id=\"dtpsExternalReleaseURL\" value=\"${window.localStorage.externalReleaseURL || \"\"}\" placeholder=\"External release URL\" />\r\n                       <button class=\"btn small\" onclick=\"window.localStorage.setItem('externalReleaseURL', $('#dtpsExternalReleaseURL').val())\"><i class=\"fluid-icon\">save</i> Save</button>\r\n                   </div>\r\n\r\n                   <div>\r\n                       <input id=\"dtpsLMSOverride\" value=\"${window.localStorage.dtpsLMSOverride || \"\"}\" placeholder=\"LMS override\" />\r\n                       <button class=\"btn small\" onclick=\"window.localStorage.setItem('dtpsLMSOverride', $('#dtpsLMSOverride').val())\"><i class=\"fluid-icon\">save</i> Save</button>\r\n                   </div>\r\n\r\n                   <br />\r\n\r\n                   <h5>Behavior Overrides</h5>\r\n\r\n                   <br />\r\n                   <div onclick=\"fluid.set('pref-debuggingGenericGradebook')\" class=\"switch pref-debuggingGenericGradebook\"><span class=\"head\"></span></div>\r\n                   <div class=\"label\">Always use the generic gradebook</div>\r\n\r\n                   <br /><br />\r\n                   <div onclick=\"fluid.set('pref-debuggingLocalFluidUI')\" class=\"switch pref-debuggingLocalFluidUI\"><span class=\"head\"></span></div>\r\n                   <div class=\"label\">Use local Fluid UI</div>\r\n\r\n                   <br /><br />\r\n\r\n                   <br /><br />\r\n                   <input type=\"date\" />\r\n                   <br /><br />\r\n                   <input type=\"color\" />\r\n                </div>\r\n                <div style=\"display: none;\" class=\"abtpage experiments\">\r\n                    <h5><b>Experiments</b></h5>\r\n                    <p>These settings control how Power+ behaves. Changing these settings may enable unsupported and/or unfinished features that can break Power+. Use at your own risk.</p>\r\n\r\n                    <button onclick=\"Object.keys(dtps.remoteConfig).forEach(k => window.localStorage.removeItem('dtpsRemoteConfig-' + k));\" class=\"btn small\"><i class=\"fluid-icon\">cancel</i> Clear Overrides</button>\r\n                    <br /><br />\r\n                   ${Object.keys(dtps.remoteConfig).map(k => (`\r\n                        <div>\r\n                            <p>${k} ${window.localStorage.getItem(\"dtpsRemoteConfig-\" + k) ? \" <b>(overridden)</b>\" : \"\"}</p>\r\n                            <input value=\"${dtps.remoteConfig[k]}\" placeholder=\"Value\" />\r\n                            <button class=\"btn small\" onclick=\"window.localStorage.setItem('dtpsRemoteConfig-${k}', $(this).siblings('input').val())\"><i class=\"fluid-icon\">save</i> Save</button>\r\n                        </div>\r\n                    `)).join(\"\")}\r\n                </div>\r\n            ` : ``}\r\n\r\n            <div style=\"display: none;\" class=\"abtpage about\">\r\n                <h5><b>About</b></h5>\r\n\r\n                <div class=\"card\" style=\"padding: 10px 20px; box-shadow: none !important; border: 2px solid var(--elements); margin-top: 20px;\">\r\n                    <img src=\"${dtps.baseURL + \"/icon.svg\"}\" style=\"height: 50px; margin-right: 10px; vertical-align: middle; margin-top: 20px;\" />\r\n                    \r\n                    <div style=\"display: inline-block; vertical-align: middle;\">\r\n                        <h4 id=\"dtpsAboutName\" onclick=\"dtps.classicEntry()\" style=\"font-weight: bold; font-size: 32px; margin-bottom: 0px; user-select: none;\">${dtps.baseURL == \"https://dev.dtps.jottocraft.com\" ? \"Power+ (dev)\" : \"Power+\"}</h4>\r\n                        <div style=\"font-size: 16px; margin-top: 5px;\">\r\n                            ${dtps.readableVer}\r\n                            <div style=\"display: inline-block;margin: 0px 5px;font-size: 12px;\">${baseHost !== \"powerplus.app\" ? `(from ${baseHost})` : \"\"}</div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div style=\"margin-top: 15px; margin-bottom: 7px;\"><a onclick=\"dtps.changelog();\" style=\"color: var(--lightText); margin: 0px 5px;\" href=\"#\"><i class=\"fluid-icon\" style=\"vertical-align: middle\">update</i> Changelog</a>\r\n                        <a onclick=\"if (window.confirm('Are you sure you want to uninstall Power+? The extension will be removed and all of your Power+ data will be erased. If you use the Power+ bookmarklet, you will have to remove that yourself.')) { document.dispatchEvent(new CustomEvent('extensionData', { detail: 'extensionUninstall' })); window.localStorage.clear(); window.alert('Power+ has been uninstalled. Reload the page to go back to ${dtpsLMS.shortName}.') }\" style=\"color: var(--lightText); margin: 0px 5px; cursor: pointer;\"><i class=\"fluid-icon\" style=\"vertical-align: middle\">delete_outline</i> Uninstall</a>\r\n                        <a style=\"color: var(--lightText); margin: 0px 5px;\" href=\"mailto:hello@jottocraft.com\"><i class=\"fluid-icon\" style=\"vertical-align: middle\">email</i> Contact</a>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"card\" style=\"padding: 10px 20px; box-shadow: none !important; border: 2px solid var(--elements); margin-top: 20px;\">\r\n                    <div style=\"margin-top: 12px;\">\r\n                        <img src=\"${dtps.user.photoURL}\" style=\"height: 50px; margin-right: 10px; vertical-align: middle; border-radius: 50%;\" />\r\n\r\n                        <div style=\"display: inline-block; vertical-align: middle;\">\r\n                            <h4 style=\"font-weight: bold; font-size: 32px; margin: 0px;\">${dtps.user.name} <span style=\"font-size: 12px; line-height: 0px;\">${dtps.user.id}</span></h4>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div style=\"margin-top: 15px; margin-bottom: 7px;\">\r\n                        <a style=\"color: var(--lightText); margin: 0px 5px;\" href=\"/logout\"><i class=\"fluid-icon\" style=\"vertical-align: middle\">exit_to_app</i> Logout</a>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"card\" style=\"padding: 10px 20px; box-shadow: none !important; border: 2px solid var(--elements); margin-top: 20px;\">\r\n                    <img src=\"${dtpsLMS.logo}\" style=\"height: 50px; margin-right: 10px; vertical-align: middle; margin-top: 20px; border-radius: 50%; background: #ee5034;\" />\r\n\r\n                    <div style=\"display: inline-block; vertical-align: middle;\">\r\n                        <h4 style=\"font-weight: bold; font-size: 32px; margin-bottom: 0px;\">${dtpsLMS.name}</h4>\r\n                        ${dtpsLMS.description ? `\r\n                            <div style=\"font-size: 16px; margin-top: 5px;\">${dtpsLMS.description}</div>\r\n                        ` : ``}\r\n                    </div>\r\n\r\n                    <div style=\"margin-top: 15px; margin-bottom: 7px;\">\r\n                        <a style=\"color: var(--lightText); margin: 0px 5px;\" href=\"${dtpsLMS.source}\"><i class=\"fluid-icon\" style=\"vertical-align: middle\">code</i> LMS integration source code</a>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"card advancedOptions\" style=\"padding: 8px 16px; box-shadow: none !important; border: 2px solid var(--elements); margin-top: 20px; ${dtps.env == \"dev\" ? `` : `display: none;`}\">\r\n                    <div style=\"display: inline-block; vertical-align: middle;\">\r\n                        <h4 style=\"font-weight: bold; font-size: 28px; margin-bottom: 0px;\">Advanced Options</h4>\r\n                    </div>\r\n\r\n                    <div style=\"margin-top: 15px; margin-bottom: 7px;\">\r\n                        <a style=\"color: var(--lightText); margin: 0px 5px; cursor: pointer;\" onclick=\"dtps.clearData();\"><i class=\"fluid-icon\" style=\"vertical-align: middle\">refresh</i> Reset Power+</a>\r\n                        <a style=\"color: var(--lightText); margin: 0px 5px; cursor: pointer;\" onclick=\"if (confirm('Prerelease versions of Power+ are often untested and can break or display incorrect information. Are you sure you want to continue?')) {window.localStorage.prereleaseEnabled = 'true'; $('#dtpsPrereleaseTesting').show(); alert('Prerelease versions can be enabled by going to Settings -> Prerelease testing');}\"><i class=\"fluid-icon\" style=\"vertical-align: middle\">feedback</i> Test prerelease versions</a>\r\n                    </div>\r\n                </div>\r\n\r\n                <br />\r\n                ${dtps.env == \"dev\" ? `` : `<p style=\"cursor: pointer; color: var(--secText, gray)\" onclick=\"$('.advancedOptions').show(); $(this).hide();\" class=\"advOp\">Show advanced options</p>`}\r\n\r\n                <div style=\"text-align: center; padding: 50px 0px;\">\r\n                    <img style=\"height: 45px; margin-right: 20px; vertical-align: middle;\" src=\"https://cdn.jottocraft.com/images/footerImage.png\" />\r\n                    <h5 style=\"display: inline-block; vertical-align: middle;\">jottocraft</h5>\r\n                    <p>(c) jottocraft 2018-2021. All rights reserved.&nbsp;&nbsp;<a href=\"https://github.com/jottocraft/dtps\">source code</a>&nbsp;&nbsp;<a href=\"https://github.com/jottocraft/dtps/blob/main/LICENSE\">license</a></p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    `);\r\n\r\n    //Set profile image\r\n    jQuery(\".profileImage\").css(\"background-image\", \"url('\" + dtps.user.photoURL + \"')\");\r\n    jQuery(\".profileMenu .name\").text(dtps.user.name);\r\n\r\n    //Load Fluid UI\r\n    fluid.onLoad();\r\n\r\n    //Render sidebar\r\n    dtps.showClasses();\r\n\r\n    //Remove loading screen styles\r\n    jQuery(\"#dtpsNativeOverlay style\").remove();\r\n\r\n    //Fade out loading screen\r\n    jQuery(\"#dtpsNativeOverlay\").css(\"opacity\", \"0\");\r\n\r\n    //Remove loading screen after the animation is complete\r\n    setTimeout(() => jQuery(\"#dtpsNativeOverlay\").remove(), 200);\r\n}\r\n\r\n//Start loading DTPS\r\ndtps.init();\r\n\r\n//LMS Integration documentation           -------------------------------------------------------------------------------------\r\n\r\n/**\r\n * @namespace dtpsLMS\r\n * @description Global DTPS LMS integration object. All LMS-related tasks, such as fetching data, are handled by this object. This is always loaded first.\r\n * @global\r\n * @property {string} name Full LMS name\r\n * @property {string} [shortName] Short LMS name\r\n * @property {string} legalName Legal name (or names) to show in the \"Welcome to Power+\" disclaimer\r\n * @property {string} [description] A short description of the LMS integration provided\r\n * @property {string} logo LMS logo image URL\r\n * @property {string} url URL to the LMS' website\r\n * @property {string} source URL to the LMS integration's source code\r\n * @property {boolean} [dtech] True if this LMS is d.tech\r\n * @property {boolean} [institutionSpecific] True if the LMS is designed for a specific institution instead of a broader LMS\r\n * @property {boolean} [preferRubricGrades] True if DTPS should prefer rubric grades for assignments\r\n * @property {boolean} [genericGradebook] True if DTPS should show the generic gradebook. Ignored if dtpsLMS.gradebook defined.\r\n */\r\n\r\n/**\r\n * @name dtpsLMS.fetchUser\r\n * @description [REQUIRED] Fetches data for the current user from the LMS. If the user is not signed in, reject with an object that looks like {action: \"login\", redirectURL: \"...\"} to login the user.\r\n * @kind function\r\n * @return {Promise<User>} A promise which resolves to a User object\r\n */\r\n\r\n/**\r\n* @name dtpsLMS.fetchClasses\r\n* @description [REQUIRED] Fetches class data from the LMS\r\n* @kind function\r\n* @param {string} userID The user ID to fetch classes for\r\n* @return {Promise<Class[]>} A promise which resolves to an array of Class objects\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.fetchAssignments\r\n* @description [REQUIRED] Fetches assignment data for a course from the LMS\r\n* @kind function\r\n* @param {string} userID The user ID to fetch assignments for\r\n* @param {string} classID The class ID to fetch assignments for\r\n* @return {Promise<Assignment[]>} A promise which resolves to an array of Assignment objects\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.fetchModules\r\n* @description [OPTIONAL] Fetches module data for a course from the LMS\r\n* @kind function\r\n* @param {string} userID The user ID to fetch modules for\r\n* @param {string} classID The class ID to fetch modules for\r\n* @return {Promise<Module[]>} A promise which resolves to an array of Module objects\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.collapseModule\r\n* @description [OPTIONAL] Collapses a module in the LMS\r\n* @kind function\r\n* @param {string} classID The ID of the class\r\n* @param {string} moduleID The ID of the module to collapse\r\n* @param {boolean} collapsed True if the module is collapsed, false otherwise\r\n* @return {Promise} A promise which resolves when the operation is completed\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.collapseAllModules\r\n* @description [OPTIONAL] Collapses all modules in the LMS\r\n* @kind function\r\n* @param {string} classID The ID of the class\r\n* @param {boolean} collapsed True if all modules should be collapsed, false otherwise\r\n* @return {Promise} A promise which resolves when the operation is completed\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.fetchAnnouncements\r\n* @description [OPTIONAL] Fetches recent announcements for a course from the LMS\r\n* @kind function\r\n* @param {string} classID The class ID to fetch announcements for\r\n* @return {Promise<Announcement[]>} A promise which resolves to an array of Announcement objects\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.fetchMeetingURL\r\n* @description [OPTIONAL] Fetches the videoMeetingURL for a class\r\n* @kind function\r\n* @param {string} classID The class ID to get the videoMeetingURL for\r\n* @return {Promise<string>} A promise which resolves to the videoMeetingURL for the class, or null if the class does not have a videoMeetingURL\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.fetchHomepage\r\n* @description [OPTIONAL] Fetches homepage HTML for a course from the LMS\r\n* @kind function\r\n* @param {string} classID The class ID to get the homepage for\r\n* @return {Promise<string>} A promise which resolves to the HTML for the class homepage\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.fetchUsers\r\n* @description [OPTIONAL] Fetches the users for a course from the LMS\r\n* @kind function\r\n* @param {string} classID The class ID to fetch users for\r\n* @return {Promise<ClassSection[]>} A promise which resolves to an array of sections in this class\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.fetchDiscussionThreads\r\n* @description [OPTIONAL] Fetches discussion threads for a course from the LMS\r\n* @kind function\r\n* @param {string} classID The class ID to fetch discussion threads for\r\n* @return {Promise<PartialDiscussionThread[]>} A promise which resolves to an array of partial Discussion Thread objects\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.fetchDiscussionPosts\r\n* @description [REQUIRED IF dtpsLMS.fetchDiscussionThreads IS IMPLEMENTED] Fetches discussion posts in a thread from the LMS\r\n* @kind function\r\n* @param {string} classID The class ID to fetch discussion posts for\r\n* @param {string} threadID The discussion thread ID to fetch discussion posts for\r\n* @return {Promise<DiscussionThread>} A promise which resolves to a full discussion thread object\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.fetchPages\r\n* @description [OPTIONAL] Fetches pages for a course from the LMS\r\n* @kind function\r\n* @param {string} classID The class ID to fetch pages for\r\n* @return {Promise<PartialPage[]>} A promise which resolves to an array of partial page objects\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.fetchPageContent\r\n* @description [REQUIRED IF dtpsLMS.fetchPages IS IMPLEMENTED] Fetches content for a page from the LMS\r\n* @kind function\r\n* @param {string} classID The class ID to fetch page content for\r\n* @param {string} pageID The page ID to fetch page content for\r\n* @return {Promise<Page>} A promise which resolves to a full DTPS page object\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.gradebook\r\n* @description [OPTIONAL] Renders custom gradebook HTML for unique grading systems or for a more tailored experience. The gradebook only shows for classes with a grade and with at least 1 assignment.\r\n* @kind function\r\n* @param {Class} course Class to render the gradebook for. If custom grade calculation is enabled (dtpsLMS.calculateGrade), those results can be accessed at course.gradeCalculation.\r\n* @return {Promise<string>} A promise which resolves to HTML to render for the class gradebook\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.gradebookDidRender\r\n* @description [OPTIONAL] Called after the HTML returned by dtpsLMS.gradebook has rendered. Runs any initialization needed for the gradebook, such as enabling interactive elements or what-if grades.\r\n* @kind function\r\n* @param {Class} course Class the gradebook was rendered for\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.calculateGrade\r\n* @description [OPTIONAL] Calculates class grades with a custom grade calculation formula. Used for unique grading systems.\r\n* @kind function\r\n* @param {Class} course Class to calculate grades for [DO NOT USE COURSE.ASSIGNMENTS to access assignments for grade calculation. Use the assignments parameter instead.]\r\n* @param {Assignment[]} assignments Assignments used for grade calculation. Use this instead of course.assignments for hypothetical/what-if grade calculation.\r\n* @return {undefined|object} The letter grade should be returned in the \"letter\" property as a string and the percentage in the \"grade\" property as a number. Other custom properties can be set if they need to be accessed by dtpsLMS.gradebook. Return undefined if there is no grade for the class.\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.isUsualDueDate\r\n* @description [OPTIONAL, INSTITUTION ONLY] This function returns true if the due date provided is usual/expected and false if the due date is unusual/expected. If the due date is unusual, it is shown in bold in the UI. For institutions where there is a pattern/standard for due dates between classes.\r\n* @kind function\r\n* @param {Date} date The due date to check\r\n* @return {boolean} True if the due date is usual, false if the due date is unusual/unexpected.\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.updateAssignments\r\n* @description [OPTIONAL, INSTITUTION ONLY] This function can be implemented by institution-specific scripts to loop through and override assignment data returned by the LMS.\r\n* @kind function\r\n* @param {Assignment[]} assignments Original assignments array\r\n* @return {Promise<Assignment[]>} A promise that resolves to the updated assignments array\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.updateClasses\r\n* @description [OPTIONAL, INSTITUTION ONLY] This function can be implemented by institution-specific scripts to loop through and override class data returned by the LMS.\r\n* @kind function\r\n* @param {Class[]} classes Original classes array\r\n* @return {Promise<Class[]>} A promise that resolves to the updated classes array\r\n*/\r\n\r\n//Type definitions                        -------------------------------------------------------------------------------------\r\n\r\n/**\r\n * @typedef {string|Date} Date\r\n * @description A date string recognized by {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/parse|Date.parse} or an actual {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date|Date} object\r\n */\r\n\r\n/**\r\n * @typedef {Object} User\r\n * @description Defines user objects in DTPS\r\n * @property {string} name User name\r\n * @property {string} id User ID\r\n * @property {string} photoURL User photo URL\r\n * @property {string} url [ONLY FOR DTPSLMS.FETCHUSERS] The URL to this user's profile. Only used when displaying users in the people tab.\r\n * @property {User[]} [children] [ONLY FOR DTPS.USER] Array of child users. If this is defined, the user is treated as a parent account. Sub-children are not allowed.\r\n * @property {boolean} parent [ONLY FOR DTPS.USER] Automatically managed by DTPS. True if the user is a parent account.\r\n */\r\n\r\n/**\r\n* @typedef {Object} Class\r\n* @description Defines class objects in DTPS\r\n* @property {string} name Name of the class\r\n* @property {string} id Class ID used by Power+\r\n* @property {string} lmsID Class ID used for LMS API calls\r\n* @property {string} userID The ID of the user this class is associated with (from the parameter of dtpsLMS.fetchClasses)\r\n* @property {number} num Index of the class in the dtps.classes array\r\n* @property {string} subject Class subject\r\n* @property {ClassSection[]|boolean} [people] Users in this class. True if the class supports the \"People\" tab, but not yet loaded. If this is true dtpsLMS.fetchUsers must be implemented.\r\n* @property {string} [icon] The icon to show with this class\r\n* @property {string} [group] The name of the group that this class is in\r\n* @property {number|string} [period] The period or section the user has this class at\r\n* @property {Date} [endDate] The end date for this course\r\n* @property {Assignment[]} assignments Class assignments. Assume assignments are still loading if this is undefined. The class has no assignments if this is an empty array. Loaded in dtps.init.\r\n* @property {Module[]|boolean} [modules] Class modules. Assume this class supports the modules feature, but is not yet loaded, if this is true and that the class has no modules if this is an empty array. For LMSs that do not support modules, either keep it undefined or set it to false.\r\n* @property {DiscussionThread[]|boolean} [discussions] Class discussion threads. Assume this class supports discussions, but not yet loaded, if this is true and that the class has no threads if this is an empty array. For LMSs that do not support discussions, either keep it undefined or set it to false.\r\n* @property {Page[]|boolean} [pages] Class pages. Assume this class supports the pages feature, but not yet loaded, if true and that the class has no pages if this is an empty array. For LMSs that do not support pages, either keep it undefined or set it to false.\r\n* @property {string} [newDiscussionThreadURL] A URL the user can visit to create a new discussion thread in this class\r\n* @property {boolean} [homepage] True if the class has a homepage. If a class has a homepage, dtpsLMS.fetchHomepage must be implemented.\r\n* @property {string} [term] Class term\r\n* @property {string} [color] Class color\r\n* @property {number} [grade] Current percentage grade in the class\r\n* @property {string} [letter] Current letter grade in the class\r\n* @property {string} [previousLetter] Automatically managed by DTPS. The previous letter grade in this class, based on local grade history.\r\n* @property {string} [image] URL to the class background image\r\n* @property {User} [teacher] Class teacher. If the class has multiple teachers, this is the primary teacher.\r\n* @property {boolean} [hasGradebook] Automatically managed by DTPS. True if the class should show the gradebook tab.\r\n* @property {object} [gradeCalculation] Automatically managed by DTPS. If custom grade calculation is implemented, this will be the results from custom grade calculation returned by dtpsLMS.calculateGrade.\r\n* @property {string} [videoMeetingURL] The URL used to join this class' online meeting. If dtpsLMS.fetchMeetingURL is implemented, DTPS will use it to get the meeting URL if this property is undefined. If this property is null, DTPS will not call dtpsLMS.fetchMeeting URL for the class.\r\n*/\r\n"]}