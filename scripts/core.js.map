{"version":3,"sources":["scripts/core.js"],"names":["dtps","ver","readableVer","env","window","localStorage","dtpsLoaderPref","jottocraftSatEnv","classes","baseURL","document","currentScript","src","split","unstable","String","includes","gradebookExpanded","updates","dashboardItems","name","id","icon","size","defaultSide","remoteConfig","showFeedbackButton","gradeCalculationEnabled","showDonateButton","allowWhatIfGrades","showVideoMeetingButton","jQuery","getScript","addEventListener","data","oldTheme","detail","next","getComputedStyle","getElementsByClassName","getPropertyValue","selectedClass","color","$","removeClass","css","chroma","class","isToday","date","today","Date","d1","getFullYear","getMonth","getDate","changelog","onlyIfNewVersion","markdown","showdown","Converter","getJSON","changelogHTML","makeHtml","body","html","Number","tag_name","replace","setItem","fluid","cards","close","log","msg","console","error","devNotes","err","formattedDevNotes","alert","firstrun","dtpsLMS","gradebook","isDemoLMS","shortName","legalName","renderLoadingScreen","dtpsPreLoader","user","append","JS","cb","CSS","rel","type","href","appendTo","init","popup","dtpsInstalled","urlParams","URLSearchParams","location","search","Array","from","length","history","replaceState","pathname","fluidThemes","fluidAutoLoad","selectedContent","render","Promise","r","Object","keys","forEach","k","val","getItem","fail","then","fetchUser","lmsID","children","parent","fetchClasses","rawClasses","resolve","institutionSpecific","updateClasses","updatedClasses","catch","e","reject","classData","course","index","num","nearestCourseColor","nearestColor","red","brown","orange","pumpkin","yellow","yellowGreen","green","oceanGreen","keppel","skyBlue","blue","purple","magenta","pink","gray","gold","darkRed","darkBlue","darkPurple","darkGreen","lightOrange","lightRed","lightBlue","lightPurple","lightGreen","lightBrown","value","calculateGrade","letter","grade","undefined","defaultScreen","screens","dashboard","stream","moduleStream","pages","discussions","showLMSGradebook","genericGradebook","courseIndex","fetchAssignments","rawAssignments","updateAssignments","updatedAssignments","assignments","assignment","gradedAt","push","sort","a","b","postedAt","getTime","gradeCalcResults","gradeCalculation","showClasses","hasGradebook","logGrades","presentClass","screen","fetchAnnouncements","announcements","announcement","renderLite","get","action","status","loadDashboardPrefs","ampm","hours","getHours","minutes","getMinutes","formatDate","toDateString","slice","obsSwitch","ele","iframeLoad","iframeID","iFrame","getElementById","height","contentWindow","scrollHeight","clearData","confirm","clear","on","classVar","hasClass","lighting","JSON","parse","effect","tinycolor","saturate","toHexString","static","override","classlist","i","letterGradeHTML","subject","join","click","event","classNum","title","addClass","imageURL","image","clearTimeout","bgTimeout","setTimeout","dispatchEvent","CustomEvent","siblings","show","hide","classID","map","indexOf","renderGradebook","gradebookDidRender","externalScreens","showIFrameCard","url","attr","savedCurrent","savedPrevious","previousLetter","settings","dashboardHTML","dashboardArray","dashboardItem","leftDashboard","rightDashboard","sortable","connectWith","update","ui","saveDashboardPrefs","modal","dashboardPrefs","child","side","stringify","dtpsDashboardItems","dashboardPref","dashboardIDs","item","dashboardItemPref","itemIndex","remove","githubCanary","dtpsDebuggingPort","dtpsLMSOverride","photoURL","logo","description","source","chromaProfile","author","domain","supported","res","disable","onLoad"],"mappings":"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","sourceRoot":"/","sourcesContent":["/**\r\n * @file DTPS Core functions and module loader\r\n * @author jottocraft\r\n * @version v3.0.4\r\n * \r\n * @copyright Copyright (c) 2018-2020 jottocraft. All rights reserved.\r\n * @license GPL-2.0-only\r\n */\r\n\r\n//Make sure DTPS isn't already loading\r\nif (typeof dtps !== \"undefined\") throw \"Error: DTPS is already loading\";\r\n\r\n/**\r\n * Global DTPS object\r\n * All global DTPS functions and variables are stored in this object\r\n * \r\n * @global\r\n * @namespace dtps\r\n * @property {number} ver Comparable version number\r\n * @property {string} env DTPS enviornment (\"prod\" or \"dev\")\r\n * @property {string} readableVer Formatted semantic version number\r\n * @property {Class[]} classes Array of classes the current user is in\r\n * @property {string} baseURL The base URL that DTPS is being loaded from\r\n * @property {boolean} unstable This is true if loading an unstable version of DTPS\r\n * @property {boolean} gradebookExpanded True if gradebook details (Show more...) is open. Used in the generic gradebook and may be used in custom gradebook implementations.\r\n * @property {string|undefined} popup Popup to show when loaded. Either undefined (no popup), \"firstrun\", or \"changelog\". \r\n * @property {User} user Current user, fetched with dtps.init\r\n * @property {number|string} selectedClass The selected class number, or \"dash\" if the dashboard is selected. Set when the first screen is loaded in dtps.init.\r\n * @property {string} selectedContent The selected class content/tab. Set when the first class content is loaded. Defaults to \"stream\".\r\n * @property {number|undefined} bgTimeout Background transition timeout when switching between classes\r\n * @property {Array<Assignment|Announcement>} updates Array of up to 10 recently graded assignments or announcements. \r\n * @property {DashboardItem[]} dashboardItems Array of items that can be shown on the dashboard\r\n * @property {DashboardItem[]} leftDashboard Items on the left side of the dashboard based on dtps.dashboardItems and user prefrences. Set in dtps.loadDashboardPrefs.\r\n * @property {DashboardItem[]} rightDashboard Items on the right side of the dashboard based on dtps.dashboardItems and user prefrences. Set in dtps.loadDashboardPrefs.\r\n * @property {object} remoteConfig Configuration variables that can be remotely changed\r\n */\r\nvar dtps = {\r\n    ver: 304,\r\n    readableVer: \"v3.0.4\",\r\n    env: window.localStorage.dtpsLoaderPref == \"debugging\" ? \"dev\" : window.jottocraftSatEnv || \"prod\",\r\n    classes: [],\r\n    baseURL: document.currentScript.src ? document.currentScript.src.split(\"/scripts/core.js\")[0] : \"https://powerplus.app\",\r\n    unstable: window.localStorage.dtpsLoaderPref == \"canary\" || window.localStorage.dtpsLoaderPref == \"debugging\" || String(document.currentScript.src).includes(\"http://localhost\"),\r\n    gradebookExpanded: false,\r\n    updates: [],\r\n    dashboardItems: [\r\n        {\r\n            name: \"Calendar\",\r\n            id: \"dtps.calendar\",\r\n            icon: \"event\",\r\n            size: 100,\r\n            defaultSide: \"left\"\r\n        }, {\r\n            name: \"Updates\",\r\n            id: \"dtps.updates\",\r\n            icon: \"calendar_view_day\",\r\n            size: 170,\r\n            defaultSide: \"left\"\r\n        }, {\r\n            name: \"Due Today\",\r\n            id: \"dtps.dueToday\",\r\n            icon: \"check_circle_outline\",\r\n            size: 20,\r\n            defaultSide: \"right\"\r\n        }, {\r\n            name: \"Upcoming Assignments\",\r\n            id: \"dtps.upcoming\",\r\n            icon: \"view_stream\",\r\n            size: 250,\r\n            defaultSide: \"right\"\r\n        }\r\n    ],\r\n    remoteConfig: {\r\n        showFeedbackButton: false,\r\n        gradeCalculationEnabled: true,\r\n        showDonateButton: true,\r\n        allowWhatIfGrades: true,\r\n        showVideoMeetingButton: true\r\n    }\r\n};\r\n\r\n//Load jQuery ASAP\r\njQuery.getScript(\"https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js\");\r\n\r\n//Fluid UI theme listener (for changing background color)\r\ndocument.addEventListener(\"fluidTheme\", function (data) {\r\n    if (dtps.oldTheme !== data.detail) {\r\n        //Theme has changed\r\n        dtps.oldTheme = data.detail;\r\n\r\n        //Update background gradient\r\n        var next = window.getComputedStyle(document.getElementsByClassName(\"background\")[0]).getPropertyValue(\"--grad\")\r\n        if (dtps.selectedClass !== \"dash\") next = \"linear-gradient(to bottom right, \" + (dtps.classes[dtps.selectedClass] && dtps.classes[dtps.selectedClass].color) + \", var(--background))\"\r\n        if (dtps.selectedClass !== \"dash\") $('body').removeClass('dashboard');\r\n        $(\".background\").css(\"background\", next);\r\n\r\n        //Re-run chroma\r\n        dtps.chroma();\r\n    }\r\n});\r\n\r\n/**\r\n * Debugging shortcut for getting the selected class. This should only be used in the web inspector and not in actual code.\r\n * \r\n * @return {object|undefined} The selected class \r\n */\r\ndtps.class = function () {\r\n    return dtps.classes[dtps.selectedClass]\r\n}\r\n\r\n/**\r\n * Checks if a Date is today\r\n * \r\n * @param {Date} date Date string to check \r\n */\r\ndtps.isToday = function (date) {\r\n    var today = new Date();\r\n    var d1 = new Date(date);\r\n\r\n    return d1.getFullYear() === today.getFullYear() &&\r\n        d1.getMonth() === today.getMonth() &&\r\n        d1.getDate() === today.getDate();\r\n}\r\n\r\n/**\r\n * Fetches and displays the DTPS changelog modal\r\n * \r\n * @param onlyIfNewVersion True if the changelog should only show if this is a new version\r\n */\r\ndtps.changelog = function (onlyIfNewVersion) {\r\n    //Fetch latest changelog from GitHub releases\r\n    jQuery.getScript(\"https://cdnjs.cloudflare.com/ajax/libs/showdown/1.8.6/showdown.min.js\", function () {\r\n        markdown = new showdown.Converter();\r\n        jQuery.getJSON(\"https://api.github.com/repos/jottocraft/dtps/releases/latest\", function (data) {\r\n            //Convert changelog to HTML and render in the changelog card\r\n            var changelogHTML = markdown.makeHtml(data.body);\r\n            jQuery(\".card.changelog\").html(`<i onclick=\"fluid.cards.close('.card.changelog')\" class=\"material-icons close\">close</i>` + changelogHTML);\r\n\r\n            if (!onlyIfNewVersion) {\r\n                //Show changelog\r\n                fluid.cards.close(\".card.focus\");\r\n                fluid.cards(\".card.changelog\");\r\n            } else if (Number(data.tag_name.replace(/[^0-9]/g, '')) > Number(window.localStorage.dtps)) {\r\n                //Show changelog if this is a new(er) version\r\n                localStorage.setItem('dtps', data.tag_name.replace(/[^0-9]/g, ''));\r\n\r\n                if (!data.tag_name.includes(\"s\")) {\r\n                    //s in tag_name means a silent release\r\n                    fluid.cards.close(\".card.focus\");\r\n                    fluid.cards(\".card.changelog\");\r\n                }\r\n            }\r\n        });\r\n    });\r\n};\r\n\r\n/**\r\n * Logs debugging messages\r\n * \r\n * @param {string} msg The debugging message to log\r\n */\r\ndtps.log = function (msg) {\r\n    if (dtps.env == \"dev\") console.log(\"[DTPS]\", msg);\r\n}\r\n\r\n\r\n/**\r\n * Shows an error message alert and logs to console\r\n * \r\n * @param {string} msg The error to display\r\n * @param {string} [devNotes] Technical error details displayed in a smaller font\r\n * @param {Error} [err] An error object to log to the console. If this is null, DTPS will assume the error has been handled elsewhere.\r\n */\r\ndtps.error = function (msg, devNotes, err) {\r\n    if (err !== null) {\r\n        var formattedDevNotes = \"\";\r\n        if (devNotes) {\r\n            formattedDevNotes = '<div style=\"font-size: 12px; color: var(--secText, gray); margin-top: 10px;\">' + devNotes + '</div>';\r\n        }\r\n        console.error(\"[DTPS !!ERROR!!]\", devNotes + \": \", err);\r\n        fluid.alert(\"Error\", msg + formattedDevNotes, \"error\");\r\n    }\r\n}\r\n\r\n/**\r\n * Renders \"Welcome to Project DTPS\" screen on the first run\r\n */\r\ndtps.firstrun = function () {\r\n    //Set latest changelog version to current version\r\n    window.localStorage.setItem('dtps', dtps.ver);\r\n\r\n    //Welcome to DTPS screen HTML\r\n    jQuery(\".card.changelog\").html(/*html*/`\r\n        <h3 style=\"margin-bottom: 0px;\">Welcome to Power+</h3>\r\n        <h5 style=\"color: var(--secText); font-weight: bold; font-size: 22px;\">${dtps.readableVer}</h5>\r\n\r\n        <div class=\"welcomeSection\">\r\n            <i class=\"material-icons\">dashboard</i>\r\n            <h5>${dtpsLMS.gradebook ? \"Manage your coursework and grades\" : \"Manage your coursework\"}</h5>\r\n            <p>Power+ organizes all of your coursework so you can easily see what you need to do next. The dashboard shows upcoming assignments, recent grades, and announcements.\r\n            ${dtpsLMS.gradebook ? `Power+ includes a gradebook designed for ${dtpsLMS.name} to help you understand your grades.` : ``}</p>\r\n        </div>\r\n\r\n        ${dtpsLMS.isDemoLMS ? /*html*/`\r\n            <div class=\"welcomeSection\">\r\n                <i class=\"material-icons\">priority_high</i>\r\n                <h5>This is a demo</h5>\r\n                <p>Assignment information, grades, and other content displayed is not real and is for demonstration purposes only. This demo does not retrieve or collect any data.</p>\r\n            </div>\r\n        ` : /*html*/`\r\n            <div class=\"welcomeSection\">\r\n                <i class=\"material-icons\">security</i>\r\n                <h5>Privacy</h5>\r\n                <p>Power+ does not collect any information. All of the data used in Power+ is fetched directly from ${dtpsLMS.shortName} and is never sent anywhere else. \r\n                 User preferences, grade history, and other Power+ data is stored locally on your computer and is not associated with your ${dtpsLMS.shortName} account.</p>\r\n            </div>\r\n            <div class=\"welcomeSection\">\r\n                <i class=\"material-icons\">priority_high</i>\r\n                <h5>Power+ is not official</h5>\r\n                <p>Assignment information, grades, and other content displayed in Power+ are not official. Power+ is neither created nor endorsed by ${dtpsLMS.legalName}.\r\n                 Power+ may have bugs that could cause it to display inaccurate information. Use Power+ at your own risk.</p>\r\n            </div>\r\n        `}\r\n        \r\n        <br />\r\n        <div onclick=\"window.localStorage.setItem('dtpsInstalled', 'true'); fluid.cards.close('.card.changelog');\" class=\"btn\">\r\n            <i class=\"material-icons\">arrow_forward</i> Continue\r\n        </div>\r\n    `);\r\n\r\n    //Show Welcome to DTPS card\r\n    fluid.cards.close(\".card.focus\");\r\n    fluid.cards(\".card.changelog\", \"stayOpen\");\r\n};\r\n\r\n/**\r\n * Renders the DTPS loading screen\r\n */\r\ndtps.renderLoadingScreen = function () {\r\n    if (!window.dtpsPreLoader || dtps.user) {\r\n        //Only show the loader if the extension hasn't already shown it\r\n        jQuery(\"body\").append(/*html*/`\r\n            <div id=\"dtpsNativeOverlay\" style=\"position: fixed; top: 0px; left: 0px; width: 100vw; height: 100vh; z-index: 999; background: #191919; text-align: center; z-index: 999; transition: opacity 0.2s;\">\r\n                &nbsp;\r\n                <img style=\"height: 100px; margin-top: 132px;\" src=\"https://i.imgur.com/eiTE2sW.png\" />\r\n                <div class=\"spinner\" style=\"margin-top: 300px;\"></div>\r\n                <style>body { overflow: hidden !important; } .spinner { width: 40px; height: 40px; margin: 40px auto; background-color: gray; border-radius: 100%; -webkit-animation: sk-scaleout 1.0s infinite ease-in-out; animation: sk-scaleout 1.0s infinite ease-in-out; } @-webkit-keyframes sk-scaleout { 0% { -webkit-transform: scale(0) } 100% { -webkit-transform: scale(1.0); opacity: 0; } } @keyframes sk-scaleout { 0% { -webkit-transform: scale(0); transform: scale(0); } 100% { -webkit-transform: scale(1.0); transform: scale(1.0); opacity: 0; } }</style>\r\n            </div>\r\n        `);\r\n    }\r\n}\r\n\r\n/**\r\n * Load all external JavaScript libraries\r\n * \r\n * @param {function} cb Callback function\r\n */\r\ndtps.JS = function (cb) {\r\n    //Moment & Fullcalendar are used for the calendar on the dashboard\r\n    jQuery.getScript(\"https://cdnjs.cloudflare.com/ajax/libs/moment.js/2.22.2/moment.min.js\", function () {\r\n        jQuery.getScript(\"https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.9.0/fullcalendar.min.js\")\r\n    });\r\n\r\n    //Fuse.js is used for search\r\n    jQuery.getScript('https://cdnjs.cloudflare.com/ajax/libs/fuse.js/3.3.0/fuse.min.js');\r\n\r\n    //jQuery UI for dashboard settings page\r\n    jQuery.getScript('https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js');\r\n\r\n    //Tinycolor used for Fluid UI acrylic & color manipulation\r\n    jQuery.getScript(\"https://cdn.jottocraft.com/tinycolor.js\", () => {\r\n        //dtao/nearest-color is used for finding the nearest class color\r\n        jQuery.getScript(\"https://cdn.jottocraft.com/nearest-color.dtao.js\", () => {\r\n            //Fluid UI for core UI elements\r\n            jQuery.getScript('https://cdn.jottocraft.com/fluid/v4.min.js', cb);\r\n        })\r\n    });\r\n}\r\n\r\n/**\r\n * Load all DTPS CSS files\r\n */\r\ndtps.CSS = function () {\r\n    jQuery(\"<link/>\", {\r\n        rel: \"stylesheet\",\r\n        type: \"text/css\",\r\n        href: \"https://cdn.jottocraft.com/fluid/v4.min.css\",\r\n        class: \"dtpsHeadItem\"\r\n    }).appendTo(\"head\");\r\n\r\n    jQuery(\"<link/>\", {\r\n        rel: \"stylesheet\",\r\n        type: \"text/css\",\r\n        href: dtps.baseURL + \"/dtps.css\",\r\n        class: \"dtpsHeadItem\"\r\n    }).appendTo(\"head\");\r\n\r\n    jQuery(\"<link/>\", {\r\n        rel: \"stylesheet\",\r\n        type: \"text/css\",\r\n        href: \"https://fonts.googleapis.com/css?family=Material+Icons+Outlined\",\r\n        class: \"dtpsHeadItem\"\r\n    }).appendTo(\"head\");\r\n\r\n    jQuery(\"<link/>\", {\r\n        rel: \"stylesheet\",\r\n        type: \"text/css\",\r\n        href: \"https://cdnjs.cloudflare.com/ajax/libs/fullcalendar/3.9.0/fullcalendar.min.css\",\r\n        class: \"dtpsHeadItem\"\r\n    }).appendTo(\"head\");\r\n\r\n    jQuery(\"<link/>\", {\r\n        rel: \"stylesheet\",\r\n        type: \"text/css\",\r\n        href: \"https://fonts.googleapis.com/icon?family=Material+Icons+Extended\",\r\n        class: \"dtpsHeadItem\"\r\n    }).appendTo(\"head\");\r\n\r\n    jQuery(\"<link/>\", {\r\n        rel: \"stylesheet\",\r\n        type: \"text/css\",\r\n        href: \"https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/themes/smoothness/jquery-ui.css\",\r\n        class: \"dtpsHeadItem\"\r\n    }).appendTo(\"head\");\r\n}\r\n\r\n/**\r\n * Starts DTPS (entrypoint function)\r\n */\r\ndtps.init = function () {\r\n    //Initial log\r\n    dtps.log(\"Starting DTPS \" + dtps.readableVer + \"...\");\r\n\r\n    //Check for LMS config\r\n    if (!window.dtpsLMS) {\r\n        throw \"Error: No DTPS LMS configuration found\";\r\n    }\r\n\r\n    //Determine if changelog should be shown\r\n    if (Number(window.localStorage.dtps) < dtps.ver) {\r\n        dtps.log(\"New release\");\r\n        dtps.popup = \"changelog\";\r\n    }\r\n\r\n    //Determine if this is the first time loading DTPS\r\n    if (window.localStorage.dtpsInstalled !== \"true\") {\r\n        dtps.popup = \"firstrun\";\r\n    }\r\n\r\n    //Render loading screen\r\n    dtps.renderLoadingScreen();\r\n\r\n    //Get URL parameters\r\n    var urlParams = new URLSearchParams(window.location.search);\r\n    if (Array.from(urlParams).length) window.history.replaceState(null, null, window.location.pathname);\r\n\r\n    //Fluid UI settings\r\n    fluidThemes = [[\"midnight\", \"tome\"], [\"rainbow\"]];\r\n    fluidAutoLoad = false;\r\n\r\n    //Set env discovery\r\n    window.localStorage.setItem(\"jottocraftEnv\", true);\r\n\r\n    //Default selected content\r\n    dtps.selectedContent = \"stream\";\r\n\r\n    //Begin loading CSS\r\n    dtps.CSS();\r\n\r\n    //Begin loading static DTPS HTML\r\n    dtps.render();\r\n\r\n    //Fetch remote config\r\n    new Promise((r) => {\r\n        jQuery.getJSON('https://project-dtps.firebaseio.com/config.json', (remoteConfig) => {\r\n            if (remoteConfig) {\r\n                Object.keys(remoteConfig).forEach(k => {\r\n                    var val = remoteConfig[k];\r\n\r\n                    if ((dtps.env == \"dev\") && window.localStorage.getItem(\"dtpsRemoteConfig-\" + k)) {\r\n                        val = window.localStorage.getItem(\"dtpsRemoteConfig-\" + k);\r\n\r\n                        if (val == \"true\") val = true;\r\n                        if (val == \"false\") val = false;\r\n                    }\r\n\r\n                    dtps.remoteConfig[k] = val;\r\n                });\r\n            }\r\n            r();\r\n        }).fail(r);\r\n    }).then(() => {\r\n        //Fetch user and class data\r\n        return dtpsLMS.fetchUser();\r\n    }).then(data => {\r\n        //Prevent resetting the user if the user is already set (for parent accounts)\r\n        if (!dtps.user) {\r\n            dtps.user = data;\r\n\r\n            //Set lmsID as current user ID by default\r\n            dtps.user.lmsID = dtps.user.id;\r\n\r\n            //If this is a parent account, show the parent UI\r\n            if (dtps.user.children && dtps.user.children.length) {\r\n                dtps.user.lmsID = dtps.user.children[0].id;\r\n                dtps.user.parent = true;\r\n            }\r\n        }\r\n\r\n        return dtpsLMS.fetchClasses();\r\n    }).then((rawClasses) => {\r\n        return new Promise(resolve => {\r\n            if (dtpsLMS.institutionSpecific && dtpsLMS.updateClasses) {\r\n                //Using an institution-specific script, make any nessasary changes and return updated classes\r\n                dtpsLMS.updateClasses(rawClasses).then((updatedClasses) => {\r\n                    resolve(updatedClasses);\r\n                }).catch((e) => {\r\n                    reject(e);\r\n                });\r\n            } else {\r\n                //No institution-specific script, return classes as-is\r\n                resolve(rawClasses);\r\n            }\r\n        });\r\n    }).then(classData => {\r\n        //Store classData to dtps.classes\r\n        dtps.classes = classData;\r\n\r\n        //Add course num props\r\n        dtps.classes.forEach((course, index) => course.num = index);\r\n\r\n        //Fetch JavaScript modules\r\n        dtps.JS(() => {\r\n            //Define DTPS class color pallete\r\n            var nearestCourseColor = nearestColor.from({\r\n                //Primary color shades\r\n                red: \"#cc4747\",\r\n                brown: \"#9a4429\",\r\n                orange: \"#ce734e\",\r\n                pumpkin: \"#c58535\",\r\n                yellow: \"#b58f38\",\r\n                yellowGreen: \"#7c9630\",\r\n                green: \"#439a47\",\r\n                oceanGreen: \"#339a70\",\r\n                keppel: \"#40b5c3\",\r\n                skyBlue: \"#40a4d6\",\r\n                blue: \"#2d72a0\",\r\n                purple: \"#985cab\",\r\n                magenta: \"#bd3e69\",\r\n                pink: \"#ec7ca5\",\r\n                gray: \"#888888\",\r\n                //Dark color shades\r\n                gold: \"#94652a\",\r\n                darkRed: \"#943f3f\",\r\n                darkBlue: \"#485182\",\r\n                darkPurple: \"#6f4882\",\r\n                darkGreen: \"#3d7358\",\r\n                //Light color shades\r\n                lightOrange: \"#ea7a44\",\r\n                lightRed: \"#e07f7f\",\r\n                lightBlue: \"#76c1e6\",\r\n                lightPurple: \"#978fd6\",\r\n                lightGreen: \"#7ebb95\",\r\n                lightBrown: \"#928871\"\r\n            });\r\n\r\n            //Loop over each class to update the color and check for grade calculation\r\n            dtps.classes.forEach(course => {\r\n                course.color = course.color ? nearestCourseColor(course.color).value : \"gray\";\r\n\r\n                if (dtpsLMS.calculateGrade) {\r\n                    //This LMS/Institution supports grade calculation, show loading indicator for grade\r\n                    //Grade will be calculated once assignments are fetched\r\n\r\n                    course.letter = \"...\"; //Setting this to ... shows the loading indicator\r\n                    course.grade = undefined;\r\n                }\r\n            });\r\n\r\n            //Fluid UI screens\r\n            fluid.defaultScreen = \"dashboard\";\r\n            fluid.screens.dashboard = dtps.baseURL + \"/scripts/assignments.js\";\r\n            fluid.screens.stream = dtps.baseURL + \"/scripts/assignments.js\";\r\n            fluid.screens.moduleStream = dtps.baseURL + \"/scripts/assignments.js\";\r\n            fluid.screens.pages = dtps.baseURL + \"/scripts/pages-discussions.js\";\r\n            fluid.screens.discussions = dtps.baseURL + \"/scripts/pages-discussions.js\";\r\n\r\n            if (dtpsLMS.gradebook) {\r\n                //Handle LMS gradebook\r\n                fluid.screens.gradebook = dtps.showLMSGradebook;\r\n            } else if (dtpsLMS.genericGradebook) {\r\n                //Generic gradebook script\r\n                fluid.screens.gradebook = dtps.baseURL + \"/scripts/assignments.js\";\r\n            }\r\n\r\n            //Begin fetching class assignments\r\n            dtps.classes.forEach((course, courseIndex) => {\r\n                dtpsLMS.fetchAssignments(course.id).then((rawAssignments) => {\r\n                    return new Promise(resolve => {\r\n                        if (dtpsLMS.institutionSpecific && dtpsLMS.updateAssignments) {\r\n                            //Using an institution-specific script, make any nessasary changes and return updated assignments\r\n                            dtpsLMS.updateAssignments(rawAssignments).then(updatedAssignments => {\r\n                                resolve(updatedAssignments);\r\n                            }).catch(e => {\r\n                                reject(e);\r\n                            });\r\n                        } else {\r\n                            //No institution-specific script, return assignments as-is\r\n                            resolve(rawAssignments);\r\n                        }\r\n                    });\r\n                }).then(assignments => {\r\n                    //Store assignments in the class\r\n                    course.assignments = assignments;\r\n\r\n                    //Add class props to assignments and add recent assignments to updates array \r\n                    course.assignments.forEach(assignment => {\r\n                        assignment.class = courseIndex;\r\n\r\n                        if (assignment.gradedAt && assignment.grade) {\r\n                            //Add class number and type to object\r\n                            dtps.updates.push({\r\n                                class: course.num,\r\n                                type: \"assignment\",\r\n                                ...assignment\r\n                            })\r\n                        }\r\n                    });\r\n\r\n                    //Sort updates array from newest -> oldest\r\n                    dtps.updates.sort(function (a, b) {\r\n                        //Sort by postedAt (announcements) or gradedAt (assignments)\r\n                        return new Date(b.gradedAt || b.postedAt).getTime() - new Date(a.gradedAt || a.postedAt).getTime()\r\n                    });\r\n\r\n                    //Keep only the 15 most recent updates\r\n                    if (dtps.updates.length > 15) dtps.updates.length = 15;\r\n\r\n                    //Calculate class grade if supported\r\n                    if (dtpsLMS.calculateGrade) {\r\n                        let gradeCalcResults = dtpsLMS.calculateGrade(course, assignments);\r\n\r\n                        if (gradeCalcResults) {\r\n                            //This class has a grade\r\n\r\n                            //Set course letter and grade to grade calc results\r\n                            course.letter = gradeCalcResults.letter;\r\n                            course.grade = gradeCalcResults.grade;\r\n\r\n                            //Save raw results object to the course so it can be accessed by the gradebook\r\n                            course.gradeCalculation = gradeCalcResults;\r\n                        } else {\r\n                            //No grade for this class\r\n                            course.letter = null;\r\n                            course.grade = null;\r\n                        }\r\n\r\n                        //Force re-render sidebar to show grades only if the user isn't on pages or discussions\r\n                        if ((dtps.selectedContent !== \"pages\") && (dtps.selectedContent !== \"discuss\")) {\r\n                            dtps.showClasses(true);\r\n                        }\r\n                    }\r\n\r\n                    //Grade history and gradebook\r\n                    if (course.letter && (course.letter !== \"...\")) {\r\n                        //Enable gradebook for this class\r\n                        course.hasGradebook = true;\r\n\r\n                        //Save grade history\r\n                        dtps.logGrades(courseIndex);\r\n\r\n                        //If the class is selected, call dtps.presentClass again to show the grades tab\r\n                        if (courseIndex == dtps.selectedClass) {\r\n                            dtps.presentClass(courseIndex);\r\n\r\n                            //If the gradebook is selected, reload the gradebook\r\n                            if (dtps.selectedContent == \"grades\") {\r\n                                fluid.screen('gradebook', dtps.classes[courseIndex].id);\r\n                            }\r\n                        }\r\n                    } else {\r\n                        //This class doesn't have a gradebook, exit gradebook if selected\r\n                        if ((courseIndex == dtps.selectedClass) && (dtps.selectedContent == \"grades\")) {\r\n                            fluid.screen('stream', dtps.classes[courseIndex].id);\r\n                        }\r\n                    }\r\n\r\n                    //Re-render screen if the dashboard or stream is selected\r\n                    if ((dtps.selectedClass == \"dash\") || (dtps.selectedContent == \"stream\")) {\r\n                        fluid.screen();\r\n                    }\r\n                });\r\n\r\n                dtpsLMS.fetchAnnouncements(course.id).then(announcements => {\r\n                    //Add announcements to updates array\r\n                    announcements.forEach(announcement => {\r\n                        //Add class number and type to object\r\n                        dtps.updates.push({\r\n                            class: course.num,\r\n                            type: \"announcement\",\r\n                            ...announcement\r\n                        })\r\n                    });\r\n\r\n                    //Sort updates array from newest -> oldest\r\n                    dtps.updates.sort(function (a, b) {\r\n                        //Sort by postedAt (announcements) or gradedAt (assignments)\r\n                        return new Date(b.gradedAt || b.postedAt).getTime() - new Date(a.gradedAt || a.postedAt).getTime()\r\n                    });\r\n\r\n                    //Keep only the 15 most recent updates\r\n                    if (dtps.updates.length > 15) dtps.updates.length = 15;\r\n\r\n                    if (dtps.selectedClass == \"dash\") {\r\n                        fluid.screen();\r\n                    }\r\n\r\n                });\r\n            });\r\n\r\n            //Render remaining HTML\r\n            dtps.renderLite();\r\n\r\n            //Render initial screen\r\n            fluid.screen();\r\n\r\n            //Load popup if needed\r\n            if (dtps.popup == \"firstrun\") {\r\n                dtps.firstrun();\r\n            } else if (dtps.popup == \"changelog\") {\r\n                //Changelog will only show if the release notes are on GitHub\r\n                dtps.changelog(true);\r\n            }\r\n\r\n            //Check URL parameter\r\n            if ((urlParams.get(\"prerelease\") == \"canary\") && urlParams.get(\"repo\")) {\r\n                fluid.alert(\"Power+ Canary\", \"<p>Do you want to add this release configuration to Power+?</p>\", \"build_circle\", [\r\n                    {\r\n                        name: \"Add\",\r\n                        icon: \"add\",\r\n                        action: \"window.localStorage.githubCanary = '\" + urlParams.get(\"repo\") + \"'; alert('Please reload the page for changes to take effect');\"\r\n                    },\r\n                    {\r\n                        name: \"Cancel\",\r\n                        icon: \"cancel\"\r\n                    }\r\n                ]);\r\n            }\r\n        });\r\n    }).catch(function (err) {\r\n        //Web request error\r\n        console.error(\"[DTPS] Error fetching user and classes at dtps.init\", err);\r\n\r\n        //404 Error means the user isn't logged in\r\n        if (err.status == 404) {\r\n            //Redirect to login page\r\n            window.location.href = \"/?dtpsLogin=true\";\r\n        } else {\r\n            dtps.error(\"Failed to get user and/or course data\", \"Exception in promise @ dtps.init\");\r\n        }\r\n    });\r\n\r\n    //Load dashboard prefrences\r\n    dtps.loadDashboardPrefs();\r\n}\r\n\r\n/**\r\n * 12 hour time formatter\r\n * \r\n * @param {Date} date The date to format\r\n * @return {string} Formatted time string in 12hr format\r\n */\r\ndtps.ampm = function (date) {\r\n    var hours = date.getHours();\r\n    var minutes = date.getMinutes();\r\n    var ampm = hours >= 12 ? 'pm' : 'am';\r\n    hours = hours % 12;\r\n    hours = hours ? hours : 12; // the hour '0' should be '12'\r\n    minutes = minutes < 10 ? '0' + minutes : minutes;\r\n    var strTime = hours + ':' + minutes + ' ' + ampm;\r\n    return strTime;\r\n}\r\n\r\n/**\r\n * Formats a date to a readable date string\r\n * \r\n * @param {Date} date The date to format\r\n * @return {string} Formatted date string in DAY MONTH DATE, HH:MM AMPM format\r\n */\r\ndtps.formatDate = function (date) {\r\n    if (date) {\r\n        return new Date(date).toDateString().slice(0, -5) + \", \" + dtps.ampm(new Date(date));\r\n    } else {\r\n        return \"\";\r\n    }\r\n}\r\n\r\n/**\r\n * Switches the current child account being observed\r\n * \r\n * @param {Element} ele The dropdown element used to switch accounts\r\n */\r\ndtps.obsSwitch = function (ele) {\r\n    //Reset URL state\r\n    history.replaceState(null, null, ' ');\r\n\r\n    //Change user LMS id based on dropdown value\r\n    dtps.user.lmsID = $(ele).val();\r\n\r\n    //Clear data\r\n    dtps.classes = [];\r\n    dtps.updates = [];\r\n\r\n    //Reload Power+\r\n    dtps.init();\r\n}\r\n\r\n/**\r\n * Adjusts the height of an iFrame to match its content\r\n * \r\n * @param {string} iframeID The ID of the iFrame element to adjust\r\n */\r\ndtps.iframeLoad = function (iframeID) {\r\n    var iFrame = document.getElementById(iframeID);\r\n    if (iFrame) {\r\n        iFrame.height = \"\";\r\n        iFrame.height = iFrame.contentWindow.document.body.scrollHeight + \"px\";\r\n    }\r\n}\r\n\r\n/**\r\n * Clears all DTPS data\r\n */\r\ndtps.clearData = function () {\r\n    if (window.confirm(\"Clearing Power+ data will clear all local user data stored by Power+. This should be done if it is a new semester / school year or if you are having issues with Power+. Are you sure you want to clear all your Power+ data?\")) {\r\n        window.localStorage.clear()\r\n        window.alert(\"Power+ data cleared\")\r\n    }\r\n}\r\n\r\n/**\r\n * Runs Razer Chroma RGB effects for the selected content\r\n * \r\n * @todo Pending v3 rewrite\r\n */\r\ndtps.chroma = function () {\r\n    if (fluid.chroma) {\r\n        if (fluid.chroma.on) {\r\n            var classVar = \"--light\"\r\n            if ($(\"body\").hasClass(\"dark\")) classVar = \"--norm\"\r\n            if ($(\"body\").hasClass(\"midnight\")) classVar = \"--dark\"\r\n            if (dtps.selectedClass !== \"dash\") {\r\n                var dark = \"white\";\r\n                var lighting = JSON.parse(`[\r\n        [null,null,null,` + (dtps.selectedContent == \"stream\" ? '\"white\",\"white\",\"white\",\"white\"' : \"null,null,null,null\") + `,` + (dtps.selectedContent == \"pages\" ? '\"white\",\"white\",\"white\",\"white\"' : \"null,null,null,null\") + `,` + (dtps.selectedContent == \"grades\" ? '\"white\",\"white\",\"white\",\"white\"' : \"null,null,null,null\") + `,null,null,null,null,null,null,null],\r\n        [null,null,` + (dtps.classes[dtps.selectedClass].grade >= 10 ? `\"` + dark + `\"` : 0) + `,` + (dtps.classes[dtps.selectedClass].grade >= 20 ? `\"` + dark + `\"` : 0) + `,` + (dtps.classes[dtps.selectedClass].grade >= 30 ? `\"` + dark + `\"` : 0) + `,` + (dtps.classes[dtps.selectedClass].grade >= 40 ? `\"` + dark + `\"` : 0) + `,` + (dtps.classes[dtps.selectedClass].grade >= 50 ? `\"` + dark + `\"` : 0) + `,\r\n        ` + (dtps.classes[dtps.selectedClass].grade >= 60 ? `\"` + dark + `\"` : 0) + `,` + (dtps.classes[dtps.selectedClass].grade >= 70 ? `\"` + dark + `\"` : 0) + `,` + (dtps.classes[dtps.selectedClass].grade >= 80 ? `\"` + dark + `\"` : 0) + `,` + (dtps.classes[dtps.selectedClass].grade >= 90 ? `\"` + dark + `\"` : 0) + `,` + (dtps.classes[dtps.selectedClass].grade >= 100 ? `\"` + dark + `\"` : 0) + `,null,null,null,null,null,null,null,null,null,null],\r\n        [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\r\n        [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\r\n        [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null],\r\n        [null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null,null]]`)\r\n                var ele = $(\".background\")[0];\r\n                if ($(\".class.\" + dtps.selectedClass)[0] !== undefined) ele = $(\".class.\" + dtps.selectedClass)[0];\r\n                fluid.chroma.effect(tinycolor(getComputedStyle(ele).getPropertyValue(classVar)).saturate(70).toHexString(), lighting);\r\n            } else {\r\n                var ele = $(\".background\")[0];\r\n                if ($(\".class.dash\")[0] !== undefined) ele = $(\".class.dash\")[0];\r\n                fluid.chroma.static(getComputedStyle(ele).getPropertyValue(classVar));\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Renders the class list in the sidebar\r\n * \r\n * @param {boolean} [override] True if the sidebar should be forcefully re-rendered\r\n */\r\ndtps.showClasses = function (override) {\r\n    //Array of class HTML for the sidebar\r\n    dtps.classlist = [];\r\n\r\n    for (var i = 0; i < dtps.classes.length; i++) {\r\n        //Determine letter grade HTML\r\n        var letterGradeHTML = \"\";\r\n        if (dtps.classes[i].letter) letterGradeHTML = dtps.classes[i].letter;\r\n        if (dtps.classes[i].letter == null) letterGradeHTML = \"--\";\r\n        if (dtps.classes[i].letter == \"...\") letterGradeHTML = `<div class=\"spinner\" style=\"background-color: var(--norm); margin: -8px -10px;\"></div>`; //Show loading indicator for ...\r\n\r\n        //Add class HTML to array\r\n        dtps.classlist.push(/*html*/`\r\n            <div \r\n                onclick=\"${'dtps.selectedClass = ' + i}\" \r\n                class=\"${'class item ' + i + ' ' + (dtps.selectedClass == i ? \" active\" : \"\")}\"\r\n                style=\"${'--classColor: ' + dtps.classes[i].color}\"\r\n            >\r\n                <span class=\"label name\">${dtps.classes[i].subject}</span>\r\n                <div ${dtps.classes[i].letter == null ? `style=\"letter-spacing:2px;\"` : \"\"} class=\"icon grade val\">\r\n                    ${letterGradeHTML}\r\n                </div>\r\n            </div>\r\n        `);\r\n    }\r\n\r\n    //Only render HTML if the sidebar doesn't already have the classes rendered, or if override is true\r\n    if (!jQuery(\".sidebar .class.dash\")[0] || override) {\r\n        jQuery(\".sidebar\").html(/*html*/`\r\n            <div class=\"bigLogo\" style=\"text-align: center; margin: 10px 0 20px; white-space: nowrap; overflow: hidden;\">\r\n                <img style=\"width: 28px; margin-right: 7px; vertical-align: middle;\" src=\"https://powerplus.app/icon.svg\" />\r\n                <h4 style=\"color: var(--text); display: inline-block; font-size: 28px; vertical-align: middle; margin: 0px;\">Power+</h4>\r\n            </div>\r\n            \r\n            <img class=\"logo\" src=\"https://powerplus.app/favicon.png\" />\r\n\r\n            <div class=\"items\">\r\n\r\n                <div onclick=\"dtps.selectedClass = 'dash';\" class=\"class item main dash ${dtps.selectedClass == \"dash\" ? \"active\" : \"\"}\">\r\n                    <span class=\"label name\">Dashboard</span>\r\n                    <div class=\"icon\"><i class=\"material-icons\">dashboard</i></div>\r\n                </div>\r\n\r\n                <div class=\"divider\"></div>\r\n\r\n                ${dtps.classlist.join(\"\")}\r\n            </div>\r\n\r\n            <div onclick=\"$('body').toggleClass('collapsedSidebar'); if ($('body').hasClass('collapsedSidebar')) { $(this).children('i').html('keyboard_arrow_right'); } else {$(this).children('i').html('keyboard_arrow_left');}\" init=\"true\" class=\"collapse\">\r\n                <i class=\"material-icons\">keyboard_arrow_left</i>\r\n            </div>\r\n        `);\r\n\r\n        //Change view to stream if coming from pages or discussions, since those tabs change the sidebar\r\n        if ((dtps.selectedContent == \"pages\") || (dtps.selectedContent == \"discuss\")) {\r\n            //Show stream\r\n            fluid.screen('stream', dtps.classes[dtps.selectedClass].id);\r\n        }\r\n\r\n        //Class onclick listener\r\n        $(\".class:not(.overrideClass)\").click(function (event) {\r\n            dtps.presentClass(dtps.selectedClass);\r\n\r\n            //Load class content based on what's selected\r\n            if ((dtps.selectedContent == \"stream\") && dtps.classes[dtps.selectedClass]) {\r\n                fluid.screen(\"stream\", dtps.classes[dtps.selectedClass].id);\r\n            }\r\n\r\n            if ((dtps.selectedContent == \"moduleStream\") && dtps.classes[dtps.selectedClass]) {\r\n                fluid.screen(\"moduleStream\", dtps.classes[dtps.selectedClass].id);\r\n            }\r\n\r\n            if ((dtps.selectedContent == \"grades\") && dtps.classes[dtps.selectedClass]) {\r\n                if (dtps.classes[dtps.selectedClass].hasGradebook) {\r\n                    fluid.screen(\"gradebook\", dtps.classes[dtps.selectedClass].id);\r\n                } else {\r\n                    fluid.screen(\"stream\", dtps.classes[dtps.selectedClass].id);\r\n                }\r\n            }\r\n\r\n            if (dtps.selectedClass == \"dash\") {\r\n                fluid.screen(\"dashboard\");\r\n            }\r\n        });\r\n    }\r\n}\r\n\r\n/**\r\n * Renders the class header (color, name, tabs, etc.) and sets the class as the selected class\r\n * \r\n * @param {number|string} classNum The class number to load or \"dash\" if loading the dashboard\r\n */\r\ndtps.presentClass = function (classNum) {\r\n    //Set classNum as selected class\r\n    dtps.selectedClass = classNum;\r\n\r\n    //Update document title with class name\r\n    if (dtps.classes[classNum]) {\r\n        document.title = dtps.classes[classNum].subject + \" | Power+\";\r\n    } else {\r\n        document.title = \"Power+\";\r\n    }\r\n\r\n    //Set dashboard body class for CSS styles\r\n    if (classNum == \"dash\") {\r\n        $('body').addClass('dashboard');\r\n    } else {\r\n        $('body').removeClass('dashboard');\r\n    }\r\n\r\n    //Update RGB keyboard lighting effects\r\n    dtps.chroma();\r\n\r\n    //Set the default imageURL to an empty PNG to make the CSS transition work\r\n    var imageURL = \"https://i.imgur.com/SpqHCNo.png\";\r\n\r\n    if (fluid.get(\"pref-hideClassImages\") !== \"true\") {\r\n        //Class images are not disabled\r\n        if (dtps.classes[classNum] && dtps.classes[classNum].image) {\r\n            //Class has image\r\n            imageURL = dtps.classes[classNum].image;\r\n        }\r\n    }\r\n\r\n    //Run CSS animation for class transition\r\n    $(\".background\").addClass(\"trans\");\r\n    $(\".cover.image\").css(\"background-image\", 'url(\"' + imageURL + '\")');\r\n    $(\".background\").css(\"opacity\", '0.90');\r\n    $(\".background\").css(\"filter\", 'none');\r\n\r\n    //Clear any existing background animation timeout\r\n    clearTimeout(dtps.bgTimeout);\r\n\r\n    //Set 500ms transition\r\n    dtps.bgTimeout = setTimeout(function () {\r\n        //Set theme to something random to force the theme change listener to update\r\n        dtps.oldTheme = \"nklfsdlflsdajflks\";\r\n        document.dispatchEvent(new CustomEvent('fluidTheme'));\r\n\r\n        //Remove transition\r\n        $(\".background\").removeClass(\"trans\");\r\n    }, 500);\r\n\r\n    //Set background color\r\n    if (dtps.classes[classNum]) {\r\n        $(\".background\").css(\"--classColor\", dtps.classes[classNum].color);\r\n    }\r\n\r\n    //Remove active class from other classes in the sidebar, add the active class to the selected class\r\n    $(\".class.\" + classNum).siblings().removeClass(\"active\");\r\n    $(\".class.\" + classNum).addClass(\"active\");\r\n\r\n    //Update title to show class name\r\n    //If the dashboard is selected, this is just \"Dashboard\". Otherwise, this is Class.subject\r\n    $(\"#headText\").html(classNum == \"dash\" ? \"Dashboard\" : dtps.classes[classNum] && dtps.classes[classNum].subject);\r\n\r\n    //If the class doesn't exist, hide the tabs\r\n    //Otherwise, show the tabs\r\n    if (!dtps.classes[classNum]) {\r\n        $(\".header .btns\").hide();\r\n    } else {\r\n        $(\".header .btns\").show();\r\n    }\r\n\r\n    if (dtps.classes[classNum]) {\r\n        //Show pages tab if the class supports it, otherwise, hide it\r\n        if (dtps.classes[classNum].pages) {\r\n            $(\".btns .btn.pages\").show();\r\n        } else {\r\n            $(\".btns .btn.pages\").hide();\r\n        }\r\n\r\n        //Show pages tab if the class supports it, otherwise, hide it\r\n        if (dtps.classes[classNum].discussions) {\r\n            $(\".btns .btn.discuss\").show();\r\n        } else {\r\n            $(\".btns .btn.discuss\").hide();\r\n        }\r\n\r\n        //Show gradebook if the LMS and the class supports it, otherwise, hide it\r\n        if ((dtpsLMS.genericGradebook || dtpsLMS.gradebook) && dtps.classes[classNum].hasGradebook) {\r\n            $(\".btns .btn.grades\").show();\r\n        } else {\r\n            $(\".btns .btn.grades\").hide();\r\n        }\r\n\r\n        //Hide tabs if only one tab is visible\r\n        if ($(\"#dtpsTabBar .btn:visible\").length < 2) {\r\n            $(\"#dtpsTabBar\").hide();\r\n        }\r\n    }\r\n}\r\n\r\n/**\r\n * Shows the gradebook using HTML from dtpsLMS.gradebook\r\n * \r\n * @param {string} classID Class ID\r\n */\r\ndtps.showLMSGradebook = function (classID) {\r\n    //Get class index and set as selected class\r\n    var classNum = dtps.classes.map(course => course.id).indexOf(classID);\r\n    dtps.selectedClass = classNum;\r\n\r\n    //Set stream as the selected content\r\n    dtps.selectedContent = \"grades\";\r\n    $(\"#dtpsTabBar .btn\").removeClass(\"active\");\r\n    $(\"#dtpsTabBar .btn.grades\").addClass(\"active\");\r\n\r\n    //Load class color, name, etc.\r\n    dtps.presentClass(classNum);\r\n\r\n    //Ensure classes are shown in the sidebar\r\n    dtps.showClasses();\r\n\r\n    if (classNum == -1) {\r\n        //Class does not exist\r\n        dtps.error(\"The selected class doesn't exist\", \"classNum check failed @ dtps.showLMSGradebook\");\r\n    }\r\n\r\n    //Show loading indicator\r\n    if ((dtps.selectedContent == \"grades\") && (dtps.selectedClass == classNum)) {\r\n        jQuery(\".classContent\").html(`<div class=\"spinner\"></div>`);\r\n    }\r\n\r\n    //Function to load gradebook HTML\r\n    function renderGradebook() {\r\n        dtpsLMS.gradebook(dtps.classes[classNum]).then(html => {\r\n            if (html && (dtps.selectedClass == classNum) && (dtps.selectedContent == \"grades\")) {\r\n                $(\".classContent\").html(html);\r\n                if (dtpsLMS.gradebookDidRender) dtpsLMS.gradebookDidRender(dtps.classes[classNum]);\r\n            }\r\n        }).catch(function (err) {\r\n            dtps.error(\"Could not load the gradebook\", \"Caught promise rejection @ dtps.showLMSGradebook\", err);\r\n        });\r\n    }\r\n\r\n    if (!fluid.externalScreens.stream) {\r\n        //Load assignment functions first\r\n        jQuery.getScript(dtps.baseURL + \"/scripts/assignments.js\", () => {\r\n            renderGradebook();\r\n        })\r\n    } else {\r\n        renderGradebook();\r\n    }\r\n}\r\n\r\n/**\r\n * Shows a URL in the iFrame card\r\n * \r\n * @param {string} url The URL to load\r\n */\r\ndtps.showIFrameCard = function (url) {\r\n    //Remove any previous URLs\r\n    $('#CardIFrame').attr('src', '');\r\n\r\n    //Show iFrame card\r\n    fluid.cards('.card.iFrameCard');\r\n\r\n    //Load new URL\r\n    $('#CardIFrame').attr('src', url);\r\n}\r\n\r\n/**\r\n * Stores grade data locally for the previous grade feature\r\n * \r\n * @param classNum Class number to log grade\r\n */\r\ndtps.logGrades = function (classNum) {\r\n    /*\r\n        Grade change vars:\r\n        gradeHistory-ID: current|previous (e.g. \"A|B+\" represents a change of B+ -> A)\r\n        if there is only one grade, it is the current one\r\n    */\r\n    if (window.localStorage.getItem(\"gradeHistory-\" + dtps.classes[classNum].id)) {\r\n        var savedCurrent = window.localStorage.getItem(\"gradeHistory-\" + dtps.classes[classNum].id).split(\"|\")[0];\r\n        var savedPrevious = window.localStorage.getItem(\"gradeHistory-\" + dtps.classes[classNum].id).split(\"|\")[1];\r\n\r\n        if (savedCurrent !== dtps.classes[classNum].letter) {\r\n            //Grade change\r\n            window.localStorage.setItem(\"gradeHistory-\" + dtps.classes[classNum].id, dtps.classes[classNum].letter + \"|\" + savedCurrent);\r\n            dtps.classes[classNum].previousLetter = savedCurrent;\r\n        }\r\n\r\n        if ((savedCurrent == dtps.classes[classNum].letter) && savedPrevious) {\r\n            //Previous grade is already saved\r\n            dtps.classes[classNum].previousLetter = savedPrevious;\r\n        }\r\n    } else {\r\n        //No history yet, store current grade\r\n        window.localStorage.setItem(\"gradeHistory-\" + dtps.classes[classNum].id, dtps.classes[classNum].letter);\r\n    }\r\n}\r\n\r\n/**\r\n * Opens the settings page\r\n */\r\ndtps.settings = function () {\r\n    //Render dashboard HTML if not already loaded\r\n    if ($(\"#leftDashboardColumn\").attr(\"loaded\") !== \"true\") {\r\n        //Returns dashboard item HTML from a dashboard item array\r\n        function dashboardHTML(dashboardArray) {\r\n            return dashboardArray.map(dashboardItem => {\r\n                return /*html*/`\r\n                <div dashboardItem-id=\"${dashboardItem.id}\" style=\"height: ${dashboardItem.size * 1.7 + 50}px\" class=\"dashboardItem\">\r\n                    <h5>\r\n                        <i class=\"material-icons\">${dashboardItem.icon}</i>\r\n                        <span>${dashboardItem.name}</span>\r\n                    </h5>\r\n                </div>\r\n            `;\r\n            }).join(\"\");\r\n        }\r\n\r\n        //Render dashboard items\r\n        $(\"#leftDashboardColumn\").html(dashboardHTML(dtps.leftDashboard));\r\n        $(\"#rightDashboardColumn\").html(dashboardHTML(dtps.rightDashboard));\r\n\r\n        //Make dashboard items sortable\r\n        $(\".dashboardColumn\").sortable({\r\n            connectWith: \".dashboardColumn\",\r\n            update: function (e, ui) {\r\n                dtps.saveDashboardPrefs();\r\n            }\r\n        });\r\n\r\n        //Store loaded state to prevent reloading dashboard items\r\n        $(\"#leftDashboardColumn\").attr(\"loaded\", \"true\");\r\n    }\r\n\r\n    fluid.modal('.settingsCard');\r\n}\r\n\r\n/**\r\n * Saves dashboard prefrences\r\n */\r\ndtps.saveDashboardPrefs = function () {\r\n    var dashboardPrefs = [];\r\n\r\n    //Add dashboard items\r\n    for (var i = 0; i < $(\".dashboardColumn\").children().length; i++) {\r\n        //Get HTML item\r\n        var child = $($(\".dashboardColumn\").children()[i]);\r\n\r\n        //Add item to dashboardPrefs array\r\n        dashboardPrefs.push({\r\n            id: child.attr(\"dashboardItem-id\"),\r\n            side: child.parent().attr(\"id\").includes(\"left\") ? \"left\" : \"right\"\r\n        });\r\n    }\r\n\r\n    //Save to local storage\r\n    window.localStorage.setItem(\"dtpsDashboardItems\", JSON.stringify(dashboardPrefs));\r\n\r\n    //Reload dashboard items\r\n    dtps.loadDashboardPrefs();\r\n}\r\n\r\n/**\r\n * Loads dashboard prefrences\r\n */\r\ndtps.loadDashboardPrefs = function () {\r\n    //Define left and right dashboard columns\r\n    dtps.leftDashboard = [];\r\n    dtps.rightDashboard = [];\r\n\r\n    //Add items to dashboard columns\r\n    if (window.localStorage.dtpsDashboardItems) {\r\n        //Add from user prefs\r\n\r\n        //Parse JSON\r\n        var dashboardPref = JSON.parse(window.localStorage.dtpsDashboardItems);\r\n\r\n        //Generate arrays of dashboard item IDs\r\n        var dashboardIDs = dtps.dashboardItems.map(item => item.id);\r\n\r\n        //Add items to dashboard according to prefs\r\n        dashboardPref.forEach(dashboardItemPref => {\r\n            if (dashboardIDs.includes(dashboardItemPref.id)) {\r\n                //Get item index based on dashboardIDs array\r\n                var itemIndex = dashboardIDs.indexOf(dashboardItemPref.id);\r\n\r\n                //Get item from dtps.dashboardItems array\r\n                var dashboardItem = dtps.dashboardItems[itemIndex];\r\n\r\n                //Add item to dashboard\r\n                if (dashboardItemPref.side == \"left\") {\r\n                    dtps.leftDashboard.push(dashboardItem);\r\n                } else if (dashboardItemPref.side == \"right\") {\r\n                    dtps.rightDashboard.push(dashboardItem);\r\n                }\r\n            }\r\n        });\r\n    } else {\r\n        //Add from defaults\r\n        dtps.dashboardItems.forEach(dashboardItem => {\r\n            if (dashboardItem.defaultSide == \"left\") {\r\n                dtps.leftDashboard.push(dashboardItem);\r\n            } else if (dashboardItem.defaultSide == \"right\") {\r\n                dtps.rightDashboard.push(dashboardItem);\r\n            }\r\n        })\r\n    }\r\n}\r\n\r\n/**\r\n * Renders initial static DTPS HTML\r\n */\r\ndtps.render = function () {\r\n    //Remove all existing link tags and LMS head content\r\n    $(\"link:not(.dtpsHeadItem)\").remove();\r\n    $(\"head *:not(.dtpsHeadItem)\").remove();\r\n\r\n    //Set default body classes\r\n    $(\"body\").attr(\"class\", \"dark showThemeWindows hasSidebar dashboard\");\r\n\r\n    //Set document title and favicon\r\n    document.title = \"Power+\";\r\n    jQuery(\"<link/>\", {\r\n        rel: \"shortcut icon\",\r\n        type: \"image/png\",\r\n        href: \"https://powerplus.app/favicon.png\"\r\n    }).appendTo(\"head\");\r\n\r\n    //Remove existing LMS HTML (excluding DTPS loading screen HTML)\r\n    jQuery(\"body *:not(#dtpsNativeOverlay):not(#dtpsNativeOverlay *)\").remove();\r\n\r\n    //Render HTML\r\n    jQuery(\"body\").append(/*html*/`\r\n        <div style=\"line-height: 0;\" class=\"sidebar acrylicMaterial\"></div>\r\n\r\n        <!-- Header background elements -->\r\n        <div class=\"cover image\"></div>\r\n        <div class=\"background\"></div>\r\n\r\n        <!-- Header with class name and tabs -->\r\n        <div class=\"header\">\r\n            <p id=\"timeRemaining\" style=\"position: absolute;top:${dtps.unstable ? \"2px\" : \"14px\"};margin-left: 20px;\"></p>\r\n            ${dtps.unstable ? `<p style=\"position: absolute;top: 45px;margin-left: 20px; color: red;font-weight: bold;background-color: black; font-size: 12px;\">THIS IS AN UNSTABLE VERSION OF POWER+. USE AT YOUR OWN RISK.</p>` : \"\"}\r\n        \r\n            <h2 id=\"headText\">Dashboard</h2>\r\n        \r\n            <!-- Class tabs. Each button has init=true to prevent Fluid UI from automatically managing their states -->\r\n            <div style=\"display: none;\" id=\"dtpsTabBar\" class=\"btns row tabs\">\r\n                <button init=\"true\" onclick=\"fluid.screen('stream', dtps.classes[dtps.selectedClass].id);\" class=\"btn stream\">\r\n                    <i class=\"material-icons\">library_books</i>\r\n                    Coursework\r\n                </button>\r\n                <button init=\"true\" onclick=\"fluid.screen('discussions', dtps.classes[dtps.selectedClass].id);\" class=\"btn discuss\">\r\n                    <i class=\"material-icons\">forum</i>\r\n                    Discussions\r\n                </button>\r\n                <button init=\"true\" onclick=\"fluid.screen('pages', dtps.classes[dtps.selectedClass].id);\" class=\"btn pages\">\r\n                    <i class=\"material-icons\">insert_drive_file</i>\r\n                    Pages\r\n                </button>\r\n                <button init=\"true\" onclick=\"fluid.screen('gradebook', dtps.classes[dtps.selectedClass].id);\" class=\"btn grades\">\r\n                    <i class=\"material-icons\">assessment</i>\r\n                    ${dtpsLMS.gradebook ? \"Grades\" : \"Gradebook\"}\r\n                </button>\r\n            </div>\r\n        </div>\r\n\r\n        <!-- Class content area -->\r\n        <div class=\"classContent\">\r\n            <div class=\"spinner\"></div>\r\n        </div>\r\n\r\n        <!-- Settings card (its inner HTML is added later) -->\r\n        <div style=\"height: calc(100vh - 50px); overflow: auto !important;\" class=\"card withnav focus close container settingsCard\"></div>\r\n\r\n        <!-- Toolbar (the thing at the top-right with your name, profile picture, and buttons. its inner HTML is also added later) -->\r\n        <div class=\"toolbar items\"></div>\r\n\r\n        <!-- Changelog card -->\r\n        <div style=\"border-radius: 30px;\" class=\"card focus changelog close container\">\r\n            <i onclick=\"fluid.cards.close('.card.changelog')\" class=\"material-icons close\">close</i>\r\n            <h3>What's new in Power+</h3>\r\n            <h5>Loading...</h5>\r\n        </div>\r\n\r\n        <!-- General details card for assignments, outcomes, class info, etc. -->\r\n        <div style=\"border-radius: 30px;\" class=\"card focus details close container\">\r\n            <i onclick=\"fluid.cards.close('.card.details')\" class=\"material-icons close\">close</i>\r\n            <p>An error occured</p>\r\n        </div>\r\n\r\n        <!-- General iFrame card (with white background) -->\r\n        <div style=\"border-radius: 30px; top: 50px; background-color: white; color: black;\" class=\"card focus close iFrameCard container\">\r\n            <i style=\"color: black !important;\" onclick=\"fluid.cards.close('.card.iFrameCard'); $('#CardIFrame').attr('src', '');\" class=\"material-icons close\">close</i>\r\n            <br /><br />\r\n            <iframe style=\"width: 100%; height: calc(100vh - 175px); border: none;\" id=\"CardIFrame\"></iframe>\r\n        </div>\r\n    `);\r\n}\r\n\r\n/**\r\n * Renders basic content after the user has been loaded\r\n */\r\ndtps.renderLite = function () {\r\n    //Add hideGrades body class if enabled and preference listener\r\n    if (fluid.get(\"pref-hideGrades\") == \"true\") { jQuery('body').addClass('hidegrades'); }\r\n    document.addEventListener(\"pref-hideGrades\", function (e) {\r\n        if ((e.detail == \"true\") || (e.detail == true)) {\r\n            //hideGrades has been enabled, add class to body to hide grades via CSS\r\n            jQuery('body').addClass('hidegrades');\r\n        } else {\r\n            //hideGrades has been disabled, remove class from body to show grades\r\n            jQuery('body').removeClass('hidegrades');\r\n        }\r\n    });\r\n\r\n    //Render settings card\r\n    jQuery(\".card.settingsCard\").html(/*html*/`\r\n        <i onclick=\"fluid.cards.close('.card.settingsCard')\" class=\"material-icons close\">close</i>\r\n\r\n        <div class=\"sidenav\" style=\"position: fixed; height: calc(100% - 50px); border-radius: 20px 0px 0px 20px;\">\r\n            <div class=\"title\">\r\n\t            <img src=\"https://powerplus.app/icon.svg\" style=\"width: 50px;vertical-align: middle;padding: 7px; padding-top: 14px;\" />\r\n\t            <div style=\"vertical-align: middle; display: inline-block;\">\r\n                    <h5 style=\"font-weight: bold;display: inline-block;vertical-align: middle;\">Power+</h5>\r\n                    <p>${dtps.readableVer + (window.localStorage.dtpsLoaderPref ? ` <span style=\"font-size: 12px;\">(${window.localStorage.dtpsLoaderPref})</span>` : \"\")}</p>\r\n\t            </div>\r\n            </div>\r\n\r\n            <div onclick=\"$('.abtpage').hide();$('.abtpage.settings').show();\" class=\"item active\">\r\n                <i class=\"material-icons\">settings</i> Settings\r\n            </div>\r\n            <div onclick=\"$('.abtpage').hide();$('.abtpage.dashboard').show();\" class=\"item\">\r\n                <i class=\"material-icons\">dashboard</i> Dashboard\r\n            </div>\r\n            ${dtps.env == \"dev\" ? /*html*/`\r\n                <div onclick=\"$('.abtpage').hide();$('.abtpage.debugging').show();\" class=\"item\">\r\n                    <i class=\"material-icons\">bug_report</i> Debugging\r\n                </div>\r\n            ` : ``}\r\n            <div onclick=\"$('.abtpage').hide();$('.abtpage.about').show(); if ($('body').hasClass('sudo')) { $('.advancedOptions').show(); $('.advOp').hide(); } else { $('.advancedOptions').hide(); $('.advOp').show(); }\" class=\"item abt\">\r\n                <i class=\"material-icons\">info</i> About\r\n            </div>\r\n        </div>\r\n\r\n        <div style=\"min-height: 100%\" class=\"content\">\r\n            <div class=\"abtpage settings\">\r\n                <h5><b>Settings</b></h5>\r\n                \r\n                <br />\r\n                <p>Theme</p>\r\n\r\n                <div>\r\n                    <div class=\"btns row themeSelector\"></div>\r\n                    \r\n                    <br /><br />\r\n                    <p>Grades</p>\r\n\r\n                    <div onclick=\"fluid.set('pref-hideGrades')\" class=\"switch pref-hideGrades\"><span class=\"head\"></span></div>\r\n                    <div class=\"label\"><i class=\"material-icons\">visibility_off</i> Hide class grades</div>\r\n                </div>\r\n\r\n                <br /><br />\r\n                <p>Classes</p>\r\n\r\n                <div>\r\n                    <div onclick=\"fluid.set('pref-fullNames')\" class=\"switch pref-fullNames\"><span class=\"head\"></span></div>\r\n                    <div class=\"label\"><i class=\"material-icons\">title</i> Show full class names (requires reload)</div>\r\n                    \r\n                    <br /><br />\r\n                    <div onclick=\"fluid.set('pref-hideClassImages')\" class=\"switch pref-hideClassImages\"><span class=\"head\"></span></div>\r\n                    <div class=\"label\"><i class=\"material-icons\">image</i> Hide class images</div>\r\n\r\n                    <div class=\"razerChroma\" style=\"display: none;\">\r\n                        <br /><br />\r\n                        <div onclick=\"fluid.set('pref-chromaEffects')\" class=\"switch pref-chromaEffects\"><span class=\"head\"></span></div>\r\n                        <div class=\"label\"><img style=\"width: 26px;vertical-align: middle;margin-right: 2px;\" src=\"https://i.imgur.com/FLwviAM.png\" class=\"material-icons\" /> Razer Chroma Effects (beta)</div>\r\n                    </div>\r\n                </div>\r\n\r\n                ${window.localStorage.githubCanary || window.localStorage.dtpsDebuggingPort ? /*html*/`\r\n                    <br /><br />\r\n                    <p>Prerelease testing</p>\r\n\r\n                    <div>\r\n                        <div class=\"btns row small\">\r\n                            <button \r\n                                onclick=\"window.localStorage.setItem('dtpsLoaderPref', 'prod')\" \r\n                                class=\"btn ${window.localStorage.dtpsLoaderPref != \"canary\" && window.localStorage.dtpsLoaderPref != \"debugging\" ? \"active\" : \"\"}\">\r\n                                <i class=\"material-icons\">label</i> Production\r\n                            </button>\r\n                            ${window.localStorage.githubCanary ? /*html*/`\r\n                                <button \r\n                                    onclick=\"window.localStorage.setItem('dtpsLoaderPref', 'canary')\" \r\n                                    class=\"btn ${window.localStorage.dtpsLoaderPref == \"canary\" ? \"active\" : \"\"}\">\r\n                                    <i class=\"material-icons\">build_circle</i> Canary\r\n                                </button>\r\n                            ` : ``}\r\n                            ${window.localStorage.dtpsDebuggingPort ? /*html*/`\r\n                                <button \r\n                                    onclick=\"window.localStorage.setItem('dtpsLoaderPref', 'debugging')\" \r\n                                    class=\"btn ${window.localStorage.dtpsLoaderPref == \"debugging\" ? \"active\" : \"\"}\">\r\n                                    <i class=\"material-icons\">bug_report</i> Debugging\r\n                                </button>\r\n                            ` : ``}\r\n                        </div>\r\n                    </div>\r\n                ` : ``}\r\n\r\n            </div>\r\n\r\n            <div style=\"display: none;\" class=\"abtpage dashboard\">\r\n                <h5><b>Dashboard</b></h5>\r\n                <p>You can rearrange the items shown on the dashboard by dragging them below. You might have to reload Power+ for changes to take effect.</p>\r\n\r\n                <br />\r\n                \r\n                <div id=\"leftDashboardColumn\" class=\"dashboardColumn\"></div>\r\n\r\n                <div id=\"rightDashboardColumn\" class=\"dashboardColumn\"></div>\r\n\r\n            </div>\r\n\r\n            ${dtps.env == \"dev\" ? /*html*/`\r\n                <div style=\"display: none;\" class=\"abtpage debugging\">\r\n                   <h5><b>Debugging</b></h5>\r\n                   <p>These settings are for development only and might break Power+. Use at your own risk.</p>\r\n\r\n                   <br />\r\n\r\n                   <div>\r\n                       <input id=\"dtpsDebuggingPort\" value=\"${window.localStorage.dtpsDebuggingPort || \"\"}\" placeholder=\"Debugging Port\" />\r\n                       <button class=\"btn small\" onclick=\"window.localStorage.setItem('dtpsDebuggingPort', $('#dtpsDebuggingPort').val())\"><i class=\"material-icons\">save</i> Save</button>\r\n                   </div>\r\n\r\n                   <div>\r\n                       <input id=\"dtpsLMSOverride\" value=\"${window.localStorage.dtpsLMSOverride || \"\"}\" placeholder=\"LMS override\" />\r\n                       <button class=\"btn small\" onclick=\"window.localStorage.setItem('dtpsLMSOverride', $('#dtpsLMSOverride').val())\"><i class=\"material-icons\">save</i> Save</button>\r\n                   </div>\r\n\r\n                   <br />\r\n\r\n                   <h5>Remote config overrides</h5>\r\n                   <button onclick=\"Object.keys(dtps.remoteConfig).forEach(k => window.localStorage.removeItem('dtpsRemoteConfig-' + k));\" class=\"btn small\"><i class=\"material-icons\">cancel</i> Clear</button>\r\n                   <br /><br />\r\n                   ${Object.keys(dtps.remoteConfig).map(k => (`\r\n                        <div>\r\n                            <p>${k} ${window.localStorage.getItem(\"dtpsRemoteConfig-\" + k) ? \" <b>(overridden)</b>\" : \"\"}</p>\r\n                            <input value=\"${dtps.remoteConfig[k]}\" placeholder=\"Value\" />\r\n                            <button class=\"btn small\" onclick=\"window.localStorage.setItem('dtpsRemoteConfig-${k}', $(this).siblings('input').val())\"><i class=\"material-icons\">save</i> Save</button>\r\n                        </div>\r\n                    `)).join(\"\")}\r\n                </div>\r\n            ` : ``}\r\n\r\n            <div style=\"display: none;\" class=\"abtpage about\">\r\n                <h5><b>About</b></h5>\r\n\r\n                <div class=\"card\" style=\"padding: 10px 20px; box-shadow: none !important; border: 2px solid var(--elements); margin-top: 20px;\">\r\n                    <img src=\"https://powerplus.app/icon.svg\" style=\"height: 50px; margin-right: 10px; vertical-align: middle; margin-top: 20px;\" />\r\n                    \r\n                    <div style=\"display: inline-block; vertical-align: middle;\">\r\n                        <h4 style=\"font-weight: bold; font-size: 32px; margin-bottom: 0px;\">Power+</h4>\r\n                        <div style=\"font-size: 16px; margin-top: 5px;\">\r\n                            ${dtps.readableVer}\r\n                            <div class=\"buildInfo\" style=\"display: inline-block;margin: 0px 5px;font-size: 12px;cursor: pointer;\"></div>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div style=\"margin-top: 15px; margin-bottom: 7px;\"><a onclick=\"dtps.changelog();\" style=\"color: var(--lightText); margin: 0px 5px;\" href=\"#\"><i class=\"material-icons\" style=\"vertical-align: middle\">update</i> Changelog</a>\r\n                        <a onclick=\"if (window.confirm('Are you sure you want to uninstall Power+? The extension will be removed and all of your Power+ data will be erased. If you use the Power+ bookmarklet, you will have to remove that yourself.')) { document.dispatchEvent(new CustomEvent('extensionData', { detail: 'extensionUninstall' })); window.localStorage.clear(); window.alert('Power+ has been uninstalled. Reload the page to go back to ${dtpsLMS.shortName}.') }\" style=\"color: var(--lightText); margin: 0px 5px; cursor: pointer;\"><i class=\"material-icons\" style=\"vertical-align: middle\">delete_outline</i> Uninstall</a>\r\n                        ${dtps.remoteConfig.showDonateButton ? `<a style=\"color: var(--lightText); margin: 0px 5px;\" href=\"https://www.paypal.com/cgi-bin/webscr?cmd=_donations&business=***REMOVED***&item_name=Donate+to+Power%2B&currency_code=USD&source=url\"><i class=\"material-icons\" style=\"vertical-align: middle\">attach_money</i> Donate</a>` : \"\"}\r\n                        <a style=\"color: var(--lightText); margin: 0px 5px;\" href=\"mailto:hello@jottocraft.com\"><i class=\"material-icons\" style=\"vertical-align: middle\">email</i> Contact</a>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"card\" style=\"padding: 10px 20px; box-shadow: none !important; border: 2px solid var(--elements); margin-top: 20px;\">\r\n                    <div style=\"margin-top: 12px;\">\r\n                        <img src=\"${dtps.user.photoURL}\" style=\"height: 50px; margin-right: 10px; vertical-align: middle; border-radius: 50%;\" />\r\n\r\n                        <div style=\"display: inline-block; vertical-align: middle;\">\r\n                            <h4 style=\"font-weight: bold; font-size: 32px; margin: 0px;\">${dtps.user.name} <span style=\"font-size: 12px; line-height: 0px;\">${dtps.user.id}</span></h4>\r\n                        </div>\r\n                    </div>\r\n\r\n                    <div style=\"margin-top: 15px; margin-bottom: 7px;\">\r\n                        <a style=\"color: var(--lightText); margin: 0px 5px;\" href=\"/logout\"><i class=\"material-icons\" style=\"vertical-align: middle\">exit_to_app</i> Logout</a>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"card\" style=\"padding: 10px 20px; box-shadow: none !important; border: 2px solid var(--elements); margin-top: 20px;\">\r\n                    <img src=\"${dtpsLMS.logo}\" style=\"height: 50px; margin-right: 10px; vertical-align: middle; margin-top: 20px; border-radius: 50%; background: #ee5034;\" />\r\n\r\n                    <div style=\"display: inline-block; vertical-align: middle;\">\r\n                        <h4 style=\"font-weight: bold; font-size: 32px; margin-bottom: 0px;\">${dtpsLMS.name}</h4>\r\n                        ${dtpsLMS.description ? `\r\n                            <div style=\"font-size: 16px; margin-top: 5px;\">${dtpsLMS.description}</div>\r\n                        ` : ``}\r\n                    </div>\r\n\r\n                    <div style=\"margin-top: 15px; margin-bottom: 7px;\">\r\n                        <a style=\"color: var(--lightText); margin: 0px 5px;\" href=\"${dtpsLMS.source}\"><i class=\"material-icons\" style=\"vertical-align: middle\">code</i> LMS integration source code</a>\r\n                    </div>\r\n                </div>\r\n\r\n                <div class=\"card advancedOptions\" style=\"padding: 8px 16px; box-shadow: none !important; border: 2px solid var(--elements); margin-top: 20px; display: none;\">\r\n                    <div style=\"display: inline-block; vertical-align: middle;\">\r\n                        <h4 style=\"font-weight: bold; font-size: 28px; margin-bottom: 0px;\">Advanced Options</h4>\r\n                    </div>\r\n\r\n                    <div style=\"margin-top: 15px; margin-bottom: 7px;\">\r\n                        <a style=\"color: var(--lightText); margin: 0px 5px; cursor: pointer;\" onclick=\"dtps.clearData();\"><i class=\"material-icons\" style=\"vertical-align: middle\">refresh</i> Reset Power+</a>\r\n                        <a style=\"color: var(--lightText); margin: 0px 5px; cursor: pointer;\" onclick=\"window.localStorage.dtpsDebuggingPort = window.prompt('Please enter the port the server is running on'); alert('Reload the page for changes to take effect');\"><i class=\"material-icons\" style=\"vertical-align: middle\">bug_report</i> Debug mode</a>\r\n                    </div>\r\n                </div>\r\n\r\n                <br />\r\n                <p style=\"cursor: pointer; color: var(--secText, gray)\" onclick=\"$('.advancedOptions').show(); $(this).hide();\" class=\"advOp\">Show advanced options</p>\r\n\r\n                <div style=\"text-align: center; padding: 50px 0px;\">\r\n                    <img style=\"height: 45px; margin-right: 20px; vertical-align: middle;\" src=\"https://cdn.jottocraft.com/images/footerImage.png\" />\r\n                    <h5 style=\"display: inline-block; vertical-align: middle;\">jottocraft</h5>\r\n                    <p>(c) jottocraft 2018-2020. All rights reserved.&nbsp;&nbsp;<a href=\"https://github.com/jottocraft/dtps\">source code</a>&nbsp;&nbsp;<a href=\"https://github.com/jottocraft/dtps/blob/master/LICENSE\">license</a></p>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    `);\r\n\r\n    //Render toolbar (the thing with the name and settings button at the top-right)\r\n    jQuery(\".toolbar.items\").html(/*html*/`\r\n        <div style=\"text-align: right;\">\r\n            ${dtps.user.parent ? /*html*/`\r\n                <select onchange=\"dtps.obsSwitch(this)\">\r\n                    ${dtps.user.children.map(child => {\r\n        return `<option ${dtps.user.lmsID == child.id ? \"selected\" : \"\"} value = \"${child.id}\">${child.name}</option>`;\r\n    }).join(\"\")}\r\n                </select>\r\n            ` : /*html*/`\r\n                <h4 style=\"font-size: 22px;\">${dtps.user.name}</h4>\r\n            `}\r\n            <img src=\"${dtps.user.photoURL}\" style=\"height: 34px; margin: 0px; margin-right: 10px; border-radius: 50%; vertical-align: middle;\" />\r\n        </div>\r\n\r\n        <div style=\"margin-top: 5px; display: inline-block; text-align: right; float: right;\">\r\n            <a href=\"/\" class=\"itemButton\"><i class=\"material-icons\">exit_to_app</i> ${dtpsLMS.isDemoLMS ? \"Exit demo\" : \"Go to \" + (dtpsLMS.shortName || dtpsLMS.name)}</a>\r\n            ${dtps.remoteConfig.showFeedbackButton || dtps.unstable ? `<div onclick=\"window.open('https://github.com/jottocraft/dtps/issues/new/choose')\" class=\"itemButton\"><i class=\"material-icons\">feedback</i> Feedback</div>` : \"\"}\r\n            <div onclick=\"dtps.settings();\" class=\"itemButton\"><i class=\"material-icons\">settings</i> Settings</div>\r\n        </div>\r\n    `);\r\n\r\n    //Begin loading chroma effects\r\n    if (fluid.chroma) {\r\n        dtps.chromaProfile = {\r\n            title: \"Power+\",\r\n            description: \"Razer Chroma effects for Power+ (beta)\",\r\n            author: \"jottocraft\",\r\n            domain: \"powerplus.app\"\r\n        }\r\n        fluid.chroma.supported(function (res) {\r\n            if (res) {\r\n                //Razer Synapse installed\r\n                $(\".razerChroma\").show();\r\n\r\n                //Razer Chroma pref\r\n                if (fluid.get(\"pref-chromaEffects\") == \"true\") { if (!fluid.chroma.on) { fluid.chroma.init(dtps.chromaProfile, () => fluid.chroma.static(getComputedStyle($(\".background\")[0]).getPropertyValue(\"--dark\"))); } }\r\n                document.addEventListener(\"pref-chromaEffects\", function (e) {\r\n                    if (String(e.detail) == \"true\") { if (!fluid.chroma.on) { fluid.chroma.init(dtps.chromaProfile, () => fluid.chroma.static(getComputedStyle($(\".background\")[0]).getPropertyValue(\"--dark\"))); } } else { fluid.chroma.disable(); }\r\n                })\r\n            }\r\n        })\r\n    }\r\n\r\n    //Load Fluid UI\r\n    fluid.onLoad();\r\n\r\n    //Render sidebar\r\n    dtps.showClasses();\r\n\r\n    //Load header background gradient\r\n    document.dispatchEvent(new CustomEvent('fluidTheme'));\r\n\r\n    //Remove loading screen styles\r\n    jQuery(\"#dtpsNativeOverlay style\").remove();\r\n\r\n    //Fade out loading screen\r\n    jQuery(\"#dtpsNativeOverlay\").css(\"opacity\", \"0\");\r\n\r\n    //Remove loading screen after the animation is complete\r\n    setTimeout(() => jQuery(\"#dtpsNativeOverlay\").remove(), 200);\r\n}\r\n\r\n//Start loading DTPS\r\ndtps.init();\r\n\r\n//LMS Integration documentation           -------------------------------------------------------------------------------------\r\n\r\n/**\r\n * @namespace dtpsLMS\r\n * @description Global DTPS LMS integration object. All LMS-related tasks, such as fetching data, are handled by this object. This is always loaded first.\r\n * @global\r\n * @property {string} name Full LMS name\r\n * @property {string} [shortName] Short LMS name\r\n * @property {string} legalName Legal name (or names) to show in the \"Welcome to Power+\" disclaimer\r\n * @property {string} [description] A short description of the LMS integration provided\r\n * @property {string} logo LMS logo image URL\r\n * @property {string} url URL to the LMS' website\r\n * @property {string} source URL to the LMS integration's source code\r\n * @property {boolean} [institutionSpecific] True if the LMS is designed for a specific institution instead of a broader LMS\r\n * @property {boolean} [preferRubricGrades] True if DTPS should prefer rubric grades for assignments\r\n * @property {boolean} [genericGradebook] True if DTPS should show the generic gradebook. Ignored if dtpsLMS.gradebook defined.\r\n */\r\n\r\n/**\r\n * @name dtpsLMS.fetchUser\r\n * @description [REQUIRED] Fetches user data from the LMS\r\n * @kind function\r\n * @return {Promise<User>} A promise which resolves to a User object\r\n */\r\n\r\n/**\r\n* @name dtpsLMS.fetchClasses\r\n* @description [REQUIRED] Fetches class data from the LMS\r\n* @kind function\r\n* @return {Promise<Class[]>} A promise which resolves to an array of Class objects\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.fetchAssignments\r\n* @description [REQUIRED] Fetches assignment data for a course from the LMS\r\n* @kind function\r\n* @param {string} classID The class ID to fetch assignments for\r\n* @return {Promise<Assignment[]>} A promise which resolves to an array of Assignment objects\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.fetchModules\r\n* @description [OPTIONAL] Fetches module data for a course from the LMS\r\n* @kind function\r\n* @param {string} classID The class ID to fetch modules for\r\n* @return {Promise<Module[]>} A promise which resolves to an array of Module objects\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.collapseModule\r\n* @description [OPTIONAL] Collapses a module in the LMS\r\n* @kind function\r\n* @param {string} classID The ID of the class\r\n* @param {string} moduleID The ID of the module to collapse\r\n* @param {boolean} collapsed True if the module is collapsed, false otherwise\r\n* @return {Promise} A promise which resolves when the operation is completed\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.fetchAnnouncements\r\n* @description [OPTIONAL] Fetches recent announcements for a course from the LMS\r\n* @kind function\r\n* @param {string} classID The class ID to fetch announcements for\r\n* @return {Promise<Announcement[]>} A promise which resolves to an array of Announcement objects\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.fetchHomepage\r\n* @description [OPTIONAL] Fetches homepage HTML for a course from the LMS\r\n* @kind function\r\n* @param {string} classID The class ID to get the homepage for\r\n* @return {Promise<string>} A promise which resolves to the HTML for the class homepage\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.fetchDiscussionThreads\r\n* @description [OPTIONAL] Fetches discussion threads for a course from the LMS\r\n* @kind function\r\n* @param {string} classID The class ID to fetch discussion threads for\r\n* @return {Promise<DiscussionThread[]>} A promise which resolves to an array of Discussion Thread objects\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.fetchDiscussionPosts\r\n* @description [REQUIRED IF dtpsLMS.fetchDiscussionThreads IS IMPLEMENTED] Fetches discussion posts in a thread from the LMS\r\n* @kind function\r\n* @param {string} classID The class ID to fetch discussion posts for\r\n* @param {string} threadID The discussion thread ID to fetch discussion posts for\r\n* @return {Promise<DiscussionPost[]>} A promise which resolves to an array of Discussion Post objects\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.fetchPages\r\n* @description [OPTIONAL] Fetches pages for a course from the LMS\r\n* @kind function\r\n* @param {string} classID The class ID to fetch pages for\r\n* @return {Promise<Page[]>} A promise which resolves to an array of Page objects\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.fetchPageContent\r\n* @description [REQUIRED IF dtpsLMS.fetchPages IS IMPLEMENTED] Fetches content for a page from the LMS\r\n* @kind function\r\n* @param {string} classID The class ID to fetch page content for\r\n* @param {string} pageID The page ID to fetch page content for\r\n* @return {Promise<string>} A promise which resolves to the page's content as HTML\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.gradebook\r\n* @description [OPTIONAL] Renders custom gradebook HTML for unique grading systems or for a more tailored experience. The gradebook only shows for classes with a grade and with at least 1 assignment.\r\n* @kind function\r\n* @param {Class} course Class to render the gradebook for. If custom grade calculation is enabled (dtpsLMS.calculateGrade), those results can be accessed at course.gradeCalculation.\r\n* @return {Promise<string>} A promise which resolves to HTML to render for the class gradebook\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.gradebookDidRender\r\n* @description [OPTIONAL] Called after the HTML returned by dtpsLMS.gradebook has rendered. Runs any initialization needed for the gradebook, such as enabling interactive elements or what-if grades.\r\n* @kind function\r\n* @param {Class} course Class the gradebook was rendered for\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.calculateGrade\r\n* @description [OPTIONAL] Calculates class grades with a custom grade calculation formula. Used for unique grading systems.\r\n* @kind function\r\n* @param {Class} course Class to calculate grades for [DO NOT USE COURSE.ASSIGNMENTS to access assignments for grade calculation. Use the assignments parameter instead.]\r\n* @param {Assignment[]} assignments Assignments used for grade calculation. Use this instead of course.assignments for hypothetical/what-if grade calculation.\r\n* @return {undefined|object} The letter grade should be returned in the \"letter\" property as a string and the percentage in the \"grade\" property as a number. Other custom properties can be set if they need to be accessed by dtpsLMS.gradebook. Return undefined if there is no grade for the class.\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.updateAssignments\r\n* @description [OPTIONAL, INSTITUTION ONLY] This function can be implemented by institution-specific scripts to loop through and override assignment data returned by the LMS.\r\n* @kind function\r\n* @param {Assignment[]} assignments Original assignments array\r\n* @return {Promise<Assignment[]>} A promise that resolves to the updated assignments array\r\n*/\r\n\r\n/**\r\n* @name dtpsLMS.updateClasses\r\n* @description [OPTIONAL, INSTITUTION ONLY] This function can be implemented by institution-specific scripts to loop through and override class data returned by the LMS.\r\n* @kind function\r\n* @param {Class[]} classes Original classes array\r\n* @return {Promise<Class[]>} A promise that resolves to the updated classes array\r\n*/\r\n\r\n//Type definitions                        -------------------------------------------------------------------------------------\r\n\r\n/**\r\n * @typedef {string} Date\r\n * @description A date string recognized by {@link https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Global_Objects/Date/parse|Date.parse}\r\n */\r\n\r\n/**\r\n * @typedef {Object} User\r\n * @description Defines user objects in DTPS\r\n * @property {string} name User name\r\n * @property {string} id User ID\r\n * @property {string} photoURL User photo URL\r\n * @property {User[]} [children] [ONLY FOR DTPS.USER] Array of child users. If this is defined, the user is treated as a parent account. Sub-children are not allowed.\r\n * @property {boolean} parent [ONLY FOR DTPS.USER] Automatically managed by DTPS. True if the user is a parent account.\r\n * @property {string} lmsID [ONLY FOR DTPS.USER] Automatically managed by DTPS. This is the user ID that all LMS web requests should use. Can change when a parent account changes the selected child.\r\n */\r\n\r\n/**\r\n* @typedef {Object} Class\r\n* @description Defines class objects in DTPS\r\n* @property {string} name Name of the class\r\n* @property {string} id Class ID\r\n* @property {number} num Index of the class in the dtps.classes array\r\n* @property {string} subject Class subject\r\n* @property {Assignment[]} assignments Class assignments. Assume assignments are still loading if this is undefined. The class has no assignments if this is an empty array. Loaded in dtps.init.\r\n* @property {Module[]|boolean} [modules] Class modules. Assume this class supports the modules feature, but is not yet loaded, if this is true and that the class has no modules if this is an empty array. For LMSs that do not support modules, either keep it undefined or set it to false.\r\n* @property {DiscussionThread[]|boolean} [discussions] Class discussion threads. Assume this class supports discussions, but not yet loaded, if this is true and that the class has no threads if this is an empty array. For LMSs that do not support discussions, either keep it undefined or set it to false.\r\n* @property {Page[]|boolean} [pages] Class pages. Assume this class supports the pages feature, but not yet loaded, if true and that the class has no pages if this is an empty array. For LMSs that do not support pages, either keep it undefined or set it to false.\r\n* @property {string} [newDiscussionThreadURL] A URL the user can visit to create a new discussion thread in this class\r\n* @property {string} [syllabus] Class syllabus HTML\r\n* @property {boolean} [homepage] True if the class has a homepage. If a class has a homepage, dtpsLMS.fetchHomepage must be implemented.\r\n* @property {string} [description] Class description HTML\r\n* @property {number} [numStudents] Number of students in the class\r\n* @property {string} [term] Class term\r\n* @property {string} [color] Class color\r\n* @property {number} [grade] Current percentage grade in the class\r\n* @property {string} [letter] Current letter grade in the class\r\n* @property {string} [previousLetter] Automatically managed by DTPS. The previous letter grade in this class, based on local grade history.\r\n* @property {string} [image] URL to the class background image\r\n* @property {User} [teacher] Class teacher\r\n* @property {boolean} [hasGradebook] Automatically managed by DTPS. True if the class should show the gradebook tab.\r\n* @property {object} [gradeCalculation] Automatically managed by DTPS. If custom grade calculation is implemented, this will be the results from custom grade calculation returned by dtpsLMS.calculateGrade.\r\n* @property {string} [videoMeetingURL] The URL used to join this class' online meeting\r\n*/"]}